<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Simple-Model.example.examplecounter</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Simple-Model.example.examplecounter.html" class="Module">Simple-Model.example.examplecounter</a> <a id="44" class="Keyword">where</a>

<a id="51" class="Keyword">open</a> <a id="56" class="Keyword">import</a> <a id="63" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="72" class="Keyword">open</a> <a id="77" class="Keyword">import</a> <a id="84" href="Data.List.html" class="Module">Data.List</a>
<a id="94" class="Keyword">open</a> <a id="99" class="Keyword">import</a> <a id="106" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="116" class="Keyword">open</a> <a id="121" class="Keyword">import</a> <a id="128" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>
<a id="143" class="Keyword">open</a> <a id="148" class="Keyword">import</a> <a id="155" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="169" class="Keyword">open</a> <a id="174" class="Keyword">import</a> <a id="181" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="192" class="Keyword">hiding</a> <a id="199" class="Symbol">(</a><a id="200" href="Data.Maybe.Base.html#2256" class="Function Operator">_&gt;&gt;=_</a><a id="205" class="Symbol">)</a>
<a id="207" class="Keyword">open</a> <a id="212" class="Keyword">import</a> <a id="219" href="Data.String.html" class="Module">Data.String</a> <a id="231" class="Keyword">hiding</a> <a id="238" class="Symbol">(</a><a id="239" href="Data.String.Base.html#2468" class="Function">length</a><a id="245" class="Symbol">)</a>


<a id="249" class="Comment">--simple model</a>
<a id="264" class="Keyword">open</a> <a id="269" class="Keyword">import</a> <a id="276" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html" class="Module">Simple-Model.ledgerversion.Ledger-Simple-Model</a>

<a id="324" class="Comment">--library</a>
<a id="334" class="Keyword">open</a> <a id="339" class="Keyword">import</a> <a id="346" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html" class="Module">Simple-Model.library-simple-model.basicDataStructureWithSimpleModel</a>



<a id="417" class="Comment">--Example of a simple counter</a>
<a id="const"></a><a id="447" href="Simple-Model.example.examplecounter.html#447" class="Function">const</a> <a id="453" class="Symbol">:</a> <a id="455" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="457" class="Symbol">→</a> <a id="459" class="Symbol">(</a><a id="460" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a> <a id="464" class="Symbol">→</a> <a id="466" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1274" class="Datatype">SmartContract</a> <a id="480" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a><a id="483" class="Symbol">)</a>
<a id="485" href="Simple-Model.example.examplecounter.html#447" class="Function">const</a> <a id="491" href="Simple-Model.example.examplecounter.html#491" class="Bound">n</a> <a id="493" href="Simple-Model.example.examplecounter.html#493" class="Bound">msg</a> <a id="497" class="Symbol">=</a> <a id="499" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1314" class="InductiveConstructor">return</a> <a id="506" class="Symbol">(</a><a id="507" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#420" class="InductiveConstructor">nat</a> <a id="511" href="Simple-Model.example.examplecounter.html#491" class="Bound">n</a><a id="512" class="Symbol">)</a>


<a id="516" class="Comment">-- test our ledger with our example</a>
<a id="testLedger"></a><a id="552" href="Simple-Model.example.examplecounter.html#552" class="Function">testLedger</a> <a id="563" class="Symbol">:</a> <a id="565" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2019" class="Function">Ledger</a>

<a id="573" class="Comment">-- the example below we used in our paper</a>
<a id="615" href="Simple-Model.example.examplecounter.html#552" class="Function">testLedger</a> <a id="626" class="Number">0</a> <a id="628" class="Symbol">.</a><a id="629" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1911" class="Field">amount</a>  <a id="637" class="Symbol">=</a> <a id="639" class="Number">20</a>
<a id="642" href="Simple-Model.example.examplecounter.html#552" class="Function">testLedger</a> <a id="653" class="Number">1</a> <a id="655" class="Symbol">.</a><a id="656" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1911" class="Field">amount</a>             <a id="675" class="Symbol">=</a> <a id="677" class="Number">40</a>
<a id="680" href="Simple-Model.example.examplecounter.html#552" class="Function">testLedger</a> <a id="691" class="Number">1</a> <a id="693" class="Symbol">.</a><a id="694" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1933" class="Field">fun</a> <a id="698" class="String">&quot;counter&quot;</a> <a id="708" href="Simple-Model.example.examplecounter.html#708" class="Bound">m</a>   <a id="712" class="Symbol">=</a> <a id="714" href="Simple-Model.example.examplecounter.html#447" class="Function">const</a> <a id="720" class="Number">0</a> <a id="722" class="Symbol">(</a><a id="723" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#420" class="InductiveConstructor">nat</a> <a id="727" class="Number">0</a><a id="728" class="Symbol">)</a>
<a id="730" href="Simple-Model.example.examplecounter.html#552" class="Function">testLedger</a> <a id="741" class="Number">1</a> <a id="743" class="Symbol">.</a><a id="744" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1933" class="Field">fun</a> <a id="748" class="String">&quot;increment&quot;</a> <a id="760" href="Simple-Model.example.examplecounter.html#760" class="Bound">m</a>  <a id="763" class="Symbol">=</a> <a id="765" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1391" class="InductiveConstructor">exec</a> <a id="770" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#730" class="InductiveConstructor">currentAddrLookupc</a>  <a id="790" class="Symbol">λ</a> <a id="792" href="Simple-Model.example.examplecounter.html#792" class="Bound">addr</a> <a id="797" class="Symbol">→</a>
                                   <a id="834" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1391" class="InductiveConstructor">exec</a> <a id="839" class="Symbol">(</a><a id="840" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#600" class="InductiveConstructor">callc</a> <a id="846" href="Simple-Model.example.examplecounter.html#792" class="Bound">addr</a> <a id="851" class="String">&quot;counter&quot;</a> <a id="861" class="Symbol">(</a><a id="862" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#420" class="InductiveConstructor">nat</a> <a id="866" class="Number">0</a><a id="867" class="Symbol">))</a>
                                   <a id="905" class="Symbol">λ{(</a><a id="908" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#420" class="InductiveConstructor">nat</a> <a id="912" href="Simple-Model.example.examplecounter.html#912" class="Bound">n</a><a id="913" class="Symbol">)</a> <a id="915" class="Symbol">→</a> <a id="917" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1391" class="InductiveConstructor">exec</a> <a id="922" class="Symbol">(</a><a id="923" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#659" class="InductiveConstructor">updatec</a> <a id="931" class="String">&quot;counter&quot;</a> <a id="941" class="Symbol">(</a><a id="942" href="Simple-Model.example.examplecounter.html#447" class="Function">const</a> <a id="948" class="Symbol">(</a><a id="949" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="953" href="Simple-Model.example.examplecounter.html#912" class="Bound">n</a><a id="954" class="Symbol">)))</a>
                                             <a id="1003" class="Symbol">λ</a> <a id="1005" href="Simple-Model.example.examplecounter.html#1005" class="Bound">_</a> <a id="1007" class="Symbol">→</a> <a id="1009" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1314" class="InductiveConstructor">return</a> <a id="1016" class="Symbol">(</a><a id="1017" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#420" class="InductiveConstructor">nat</a> <a id="1021" class="Symbol">(</a><a id="1022" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="1026" href="Simple-Model.example.examplecounter.html#912" class="Bound">n</a><a id="1027" class="Symbol">));</a>
                                  <a id="1065" class="CatchallClause Symbol">_</a>        <a id="1074" class="Symbol">→</a> <a id="1076" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1349" class="InductiveConstructor">error</a> <a id="1082" class="Symbol">(</a><a id="1083" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#595" class="InductiveConstructor">strErr</a> <a id="1090" class="String">&quot;counter returns not a number&quot;</a><a id="1120" class="Symbol">)}</a>
<a id="1123" href="Simple-Model.example.examplecounter.html#552" class="Function">testLedger</a> <a id="1134" class="Number">1</a> <a id="1136" class="Symbol">.</a><a id="1137" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1933" class="Field">fun</a> <a id="1141" class="String">&quot;transfer&quot;</a> <a id="1152" href="Simple-Model.example.examplecounter.html#1152" class="Bound">m</a>  <a id="1155" class="Symbol">=</a> <a id="1157" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1391" class="InductiveConstructor">exec</a> <a id="1162" class="Symbol">(</a><a id="1163" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#553" class="InductiveConstructor">transferc</a> <a id="1173" class="Number">10</a>  <a id="1177" class="Number">0</a><a id="1178" class="Symbol">)</a> <a id="1180" class="Symbol">λ</a> <a id="1182" href="Simple-Model.example.examplecounter.html#1182" class="Bound">_</a> <a id="1184" class="Symbol">→</a> <a id="1186" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1314" class="InductiveConstructor">return</a> <a id="1193" href="Simple-Model.example.examplecounter.html#1152" class="Bound">m</a>

<a id="1196" href="Simple-Model.example.examplecounter.html#552" class="CatchallClause Function">testLedger</a><a id="1206" class="CatchallClause"> </a><a id="1207" href="Simple-Model.example.examplecounter.html#1207" class="CatchallClause Bound">ow</a><a id="1209" class="CatchallClause"> </a><a id="1210" class="CatchallClause Symbol">.</a><a id="1211" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1911" class="CatchallClause Field">amount</a>           <a id="1228" class="Symbol">=</a> <a id="1230" class="Number">0</a>
<a id="1232" href="Simple-Model.example.examplecounter.html#552" class="CatchallClause Function">testLedger</a><a id="1242" class="CatchallClause"> </a><a id="1243" href="Simple-Model.example.examplecounter.html#1243" class="CatchallClause Bound">ow</a><a id="1245" class="CatchallClause"> </a><a id="1246" class="CatchallClause Symbol">.</a><a id="1247" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1933" class="CatchallClause Field">fun</a><a id="1250" class="CatchallClause"> </a><a id="1251" href="Simple-Model.example.examplecounter.html#1251" class="CatchallClause Bound">ow&#39;</a><a id="1254" class="CatchallClause"> </a><a id="1255" href="Simple-Model.example.examplecounter.html#1255" class="CatchallClause Bound">ow&#39;&#39;</a>     <a id="1264" class="Symbol">=</a> <a id="1266" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1349" class="InductiveConstructor">error</a> <a id="1272" class="Symbol">(</a><a id="1273" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#595" class="InductiveConstructor">strErr</a> <a id="1280" class="String">&quot;Undefined&quot;</a><a id="1291" class="Symbol">)</a>

</pre></body></html>