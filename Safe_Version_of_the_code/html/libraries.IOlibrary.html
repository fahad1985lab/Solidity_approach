<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>libraries.IOlibrary</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="constantparameters.html" class="Module">constantparameters</a>

<a id="33" class="Keyword">module</a> <a id="40" href="libraries.IOlibrary.html" class="Module">libraries.IOlibrary</a> <a id="60" class="Keyword">where</a>

<a id="67" class="Keyword">open</a> <a id="72" class="Keyword">import</a> <a id="79" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="88" class="Keyword">open</a> <a id="93" class="Keyword">import</a> <a id="100" href="Data.List.html" class="Module">Data.List</a> <a id="110" class="Keyword">hiding</a> <a id="117" class="Symbol">(</a><a id="118" href="Data.List.Base.html#1954" class="Function Operator">_++_</a><a id="122" class="Symbol">)</a>
<a id="124" class="Keyword">open</a> <a id="129" class="Keyword">import</a> <a id="136" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a> <a id="153" class="Keyword">using</a> <a id="159" class="Symbol">(</a><a id="160" href="Agda.Builtin.Nat.html#426" class="Primitive Operator">_-_</a><a id="163" class="Symbol">;</a> <a id="165" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">_*_</a><a id="168" class="Symbol">)</a>
<a id="170" class="Keyword">open</a> <a id="175" class="Keyword">import</a> <a id="182" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="192" class="Keyword">open</a> <a id="197" class="Keyword">import</a> <a id="204" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="214" class="Keyword">open</a> <a id="219" class="Keyword">import</a> <a id="226" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>
<a id="241" class="Keyword">open</a> <a id="246" class="Keyword">import</a> <a id="253" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="267" class="Keyword">open</a> <a id="272" class="Keyword">import</a> <a id="279" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="290" class="Keyword">hiding</a> <a id="297" class="Symbol">(</a><a id="298" href="Data.Maybe.Base.html#2256" class="Function Operator">_&gt;&gt;=_</a><a id="303" class="Symbol">)</a>
<a id="305" class="Keyword">open</a> <a id="310" class="Keyword">import</a> <a id="317" href="Data.String.html" class="Module">Data.String</a> <a id="329" class="Keyword">hiding</a> <a id="336" class="Symbol">(</a><a id="337" href="Data.String.Base.html#2468" class="Function">length</a><a id="343" class="Symbol">;</a><a id="344" href="Data.String.Base.html#1605" class="Primitive">show</a><a id="348" class="Symbol">)</a>
<a id="350" class="Keyword">open</a> <a id="355" class="Keyword">import</a> <a id="362" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a>
<a id="376" class="Keyword">open</a> <a id="381" class="Keyword">import</a> <a id="388" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a> <a id="404" class="Symbol">as</a> <a id="407" class="Module">Maybe</a> <a id="413" class="Keyword">using</a> <a id="419" class="Symbol">(</a><a id="420" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a><a id="425" class="Symbol">;</a> <a id="427" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="434" class="Symbol">;</a> <a id="436" href="Data.Maybe.Base.html#2379" class="Function Operator">_&lt;∣&gt;_</a><a id="441" class="Symbol">;</a> <a id="443" href="Data.Maybe.Base.html#2494" class="Function">when</a><a id="447" class="Symbol">)</a>
<a id="449" class="Keyword">import</a> <a id="456" href="Data.Maybe.Effectful.html" class="Module">Data.Maybe.Effectful</a>
<a id="477" class="Keyword">open</a> <a id="482" class="Keyword">import</a> <a id="489" href="Data.Product.html" class="Module">Data.Product</a> <a id="502" class="Keyword">renaming</a> <a id="511" class="Symbol">(</a><a id="512" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a> <a id="516" class="Symbol">to</a> <a id="519" class="InductiveConstructor Operator">_,,_</a> <a id="524" class="Symbol">)</a>
<a id="526" class="Keyword">open</a> <a id="531" class="Keyword">import</a> <a id="538" href="Agda.Builtin.String.html" class="Module">Agda.Builtin.String</a>

<a id="559" class="Comment">--our work</a>
<a id="570" class="Keyword">open</a> <a id="575" class="Keyword">import</a> <a id="582" href="libraries.natCompare.html" class="Module">libraries.natCompare</a>
<a id="603" class="Keyword">open</a> <a id="608" class="Keyword">import</a> <a id="615" href="libraries.Mainlibrary.html" class="Module">libraries.Mainlibrary</a>
<a id="637" class="Keyword">open</a> <a id="642" class="Keyword">import</a> <a id="649" href="Complex-Model.ccomand.ccommands-cresponse.html" class="Module">Complex-Model.ccomand.ccommands-cresponse</a>
<a id="691" class="Keyword">open</a> <a id="696" class="Keyword">import</a> <a id="703" href="basicDataStructure.html" class="Module">basicDataStructure</a>



<a id="string2FunctionName"></a><a id="725" href="libraries.IOlibrary.html#725" class="Function">string2FunctionName</a> <a id="745" class="Symbol">:</a> <a id="747" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="754" class="Symbol">→</a> <a id="756" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="762" href="basicDataStructure.html#190" class="Function">FunctionName</a>
<a id="775" href="libraries.IOlibrary.html#725" class="Function">string2FunctionName</a> <a id="795" href="libraries.IOlibrary.html#795" class="Bound">str</a> <a id="799" class="Symbol">=</a> <a id="801" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="806" href="libraries.IOlibrary.html#795" class="Bound">str</a>




<a id="funname2string"></a><a id="814" href="libraries.IOlibrary.html#814" class="Function">funname2string</a> <a id="829" class="Symbol">:</a> <a id="831" href="basicDataStructure.html#190" class="Function">FunctionName</a> <a id="844" class="Symbol">→</a> <a id="846" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="853" href="libraries.IOlibrary.html#814" class="Function">funname2string</a> <a id="868" href="libraries.IOlibrary.html#868" class="Bound">x</a> <a id="870" class="Symbol">=</a> <a id="872" href="libraries.IOlibrary.html#868" class="Bound">x</a>



<a id="877" class="Keyword">mutual</a>
  <a id="msgList2String"></a><a id="886" href="libraries.IOlibrary.html#886" class="Function">msgList2String</a> <a id="901" class="Symbol">:</a> <a id="903" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="908" href="basicDataStructure.html#523" class="Datatype">Msg</a> <a id="912" class="Symbol">→</a> <a id="914" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="923" href="libraries.IOlibrary.html#886" class="Function">msgList2String</a> <a id="938" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="941" class="Symbol">=</a> <a id="943" class="String">&quot;&quot;</a>
  <a id="948" href="libraries.IOlibrary.html#886" class="Function">msgList2String</a> <a id="963" class="Symbol">(</a><a id="964" href="libraries.IOlibrary.html#964" class="Bound">msg</a> <a id="968" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="970" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="972" class="Symbol">)</a> <a id="974" class="Symbol">=</a> <a id="976" href="libraries.IOlibrary.html#1075" class="Function">msg2string</a> <a id="987" href="libraries.IOlibrary.html#964" class="Bound">msg</a>
  <a id="993" href="libraries.IOlibrary.html#886" class="CatchallClause Function">msgList2String</a><a id="1007" class="CatchallClause"> </a><a id="1008" class="CatchallClause Symbol">(</a><a id="1009" href="libraries.IOlibrary.html#1009" class="CatchallClause Bound">msg</a><a id="1012" class="CatchallClause"> </a><a id="1013" href="Agda.Builtin.List.html#199" class="CatchallClause InductiveConstructor Operator">∷</a><a id="1014" class="CatchallClause"> </a><a id="1015" href="libraries.IOlibrary.html#1015" class="CatchallClause Bound">rest</a><a id="1019" class="CatchallClause Symbol">)</a> <a id="1021" class="Symbol">=</a> <a id="1023" href="libraries.IOlibrary.html#1075" class="Function">msg2string</a> <a id="1034" href="libraries.IOlibrary.html#1009" class="Bound">msg</a>  <a id="1039" href="Data.String.Base.html#2404" class="Function Operator">++</a> <a id="1042" class="String">&quot; , &quot;</a> <a id="1048" href="Data.String.Base.html#2404" class="Function Operator">++</a> <a id="1051" href="libraries.IOlibrary.html#886" class="Function">msgList2String</a> <a id="1066" href="libraries.IOlibrary.html#1015" class="Bound">rest</a>


  <a id="msg2string"></a><a id="1075" href="libraries.IOlibrary.html#1075" class="Function">msg2string</a> <a id="1086" class="Symbol">:</a> <a id="1088" href="basicDataStructure.html#523" class="Datatype">Msg</a> <a id="1092" class="Symbol">→</a> <a id="1094" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="1103" href="libraries.IOlibrary.html#1075" class="Function">msg2string</a> <a id="1114" class="Symbol">(</a><a id="1115" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="1119" href="libraries.IOlibrary.html#1119" class="Bound">n</a><a id="1120" class="Symbol">)</a>         <a id="1130" class="Symbol">=</a> <a id="1132" class="String">&quot;(nat &quot;</a> <a id="1140" href="Data.String.Base.html#2404" class="Function Operator">++</a> <a id="1143" href="Data.Nat.Show.html#1962" class="Function">show</a> <a id="1148" href="libraries.IOlibrary.html#1119" class="Bound">n</a> <a id="1150" href="Data.String.Base.html#2404" class="Function Operator">++</a> <a id="1153" class="String">&quot;)&quot;</a>
  <a id="1159" href="libraries.IOlibrary.html#1075" class="Function">msg2string</a> <a id="1170" class="Symbol">(</a><a id="1171" href="libraries.IOlibrary.html#1171" class="Bound">msg</a> <a id="1175" href="basicDataStructure.html#578" class="InductiveConstructor Operator">+msg</a> <a id="1180" href="libraries.IOlibrary.html#1180" class="Bound">msg₁</a><a id="1184" class="Symbol">)</a> <a id="1186" class="Symbol">=</a>  <a id="1189" class="String">&quot;(&quot;</a> <a id="1193" href="Data.String.Base.html#2404" class="Function Operator">++</a> <a id="1196" href="libraries.IOlibrary.html#1075" class="Function">msg2string</a> <a id="1207" href="libraries.IOlibrary.html#1171" class="Bound">msg</a> <a id="1211" href="Data.String.Base.html#2404" class="Function Operator">++</a> <a id="1214" class="String">&quot; , &quot;</a> <a id="1220" href="Data.String.Base.html#2404" class="Function Operator">++</a> <a id="1223" href="libraries.IOlibrary.html#1075" class="Function">msg2string</a> <a id="1234" href="libraries.IOlibrary.html#1180" class="Bound">msg₁</a> <a id="1239" href="Data.String.Base.html#2404" class="Function Operator">++</a> <a id="1242" class="String">&quot;)&quot;</a>
  <a id="1248" href="libraries.IOlibrary.html#1075" class="Function">msg2string</a> <a id="1259" class="Symbol">(</a><a id="1260" href="basicDataStructure.html#615" class="InductiveConstructor">list</a> <a id="1265" href="libraries.IOlibrary.html#1265" class="Bound">l</a><a id="1266" class="Symbol">)</a>        <a id="1275" class="Symbol">=</a> <a id="1277" class="String">&quot;[&quot;</a> <a id="1281" href="Data.String.Base.html#2404" class="Function Operator">++</a> <a id="1284" href="libraries.IOlibrary.html#886" class="Function">msgList2String</a> <a id="1299" href="libraries.IOlibrary.html#1265" class="Bound">l</a> <a id="1301" href="Data.String.Base.html#2404" class="Function Operator">++</a> <a id="1304" class="String">&quot;]&quot;</a>


<a id="1310" class="Comment">-- Test cases</a>
<a id="1324" class="Comment">-- msg2string (nat 5)</a>
<a id="1346" class="Comment">--    &quot;(nat 5)&quot;&quot;(nat 5)&quot;</a>
<a id="1371" class="Comment">-- msg2string (list ((nat 3)  ∷ (nat 7) ∷ []))</a>
<a id="1418" class="Comment">--    &quot;[(nat 3) , (nat 7) ]&quot;</a>
<a id="1447" class="Comment">-- msg2string (list ((nat 3)  ∷ ((nat 7) +msg (nat 8) ) ∷ []))</a>
<a id="1510" class="Comment">--    &quot;[(nat 3) , ((nat 7) , (nat 8))]&quot;</a>

<a id="1551" class="Comment">--Error to String</a>
<a id="error2Str"></a><a id="1569" href="libraries.IOlibrary.html#1569" class="Function">error2Str</a> <a id="1579" class="Symbol">:</a> <a id="1581" href="basicDataStructure.html#671" class="Datatype">ErrorMsg</a> <a id="1590" class="Symbol">→</a> <a id="1592" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="1599" href="libraries.IOlibrary.html#1569" class="Function">error2Str</a> <a id="1609" class="Symbol">(</a><a id="1610" href="basicDataStructure.html#694" class="InductiveConstructor">strErr</a> <a id="1617" href="libraries.IOlibrary.html#1617" class="Bound">s</a><a id="1618" class="Symbol">)</a>  <a id="1621" class="Symbol">=</a> <a id="1623" href="libraries.IOlibrary.html#1617" class="Bound">s</a>
<a id="1625" href="libraries.IOlibrary.html#1569" class="Function">error2Str</a> <a id="1635" class="Symbol">(</a><a id="1636" href="basicDataStructure.html#726" class="InductiveConstructor">numErr</a> <a id="1643" href="libraries.IOlibrary.html#1643" class="Bound">n</a><a id="1644" class="Symbol">)</a>  <a id="1647" class="Symbol">=</a> <a id="1649" class="String">&quot;Number error (&quot;</a> <a id="1666" href="Data.String.Base.html#2404" class="Function Operator">++</a> <a id="1669" href="Data.Nat.Show.html#1962" class="Function">show</a> <a id="1674" href="libraries.IOlibrary.html#1643" class="Bound">n</a>  <a id="1677" href="Data.String.Base.html#2404" class="Function Operator">++</a> <a id="1680" class="String">&quot;)&quot;</a> 
<a id="1685" href="libraries.IOlibrary.html#1569" class="Function">error2Str</a> <a id="1695" href="basicDataStructure.html#753" class="InductiveConstructor">undefined</a> <a id="1705" class="Symbol">=</a> <a id="1707" class="String">&quot;Error undefined&quot;</a>
<a id="1725" href="libraries.IOlibrary.html#1569" class="Function">error2Str</a> <a id="1735" href="basicDataStructure.html#776" class="InductiveConstructor">outOfGasError</a> <a id="1749" class="Symbol">=</a> <a id="1751" class="String">&quot;Out of gas error&quot;</a>

<a id="1771" class="Comment">--ErrorMsg to String</a>
<a id="errorMsg2Str"></a><a id="1792" href="libraries.IOlibrary.html#1792" class="Function">errorMsg2Str</a> <a id="1805" class="Symbol">:</a> <a id="1807" href="basicDataStructure.html#1074" class="Datatype">NatOrError</a> <a id="1818" class="Symbol">→</a> <a id="1820" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="1827" href="libraries.IOlibrary.html#1792" class="Function">errorMsg2Str</a> <a id="1840" class="Symbol">(</a><a id="1841" href="basicDataStructure.html#1098" class="InductiveConstructor">nat</a> <a id="1845" href="libraries.IOlibrary.html#1845" class="Bound">n</a><a id="1846" class="Symbol">)</a> <a id="1848" class="Symbol">=</a> <a id="1850" href="Data.Nat.Show.html#1962" class="Function">show</a> <a id="1855" href="libraries.IOlibrary.html#1845" class="Bound">n</a>
<a id="1857" href="libraries.IOlibrary.html#1792" class="Function">errorMsg2Str</a> <a id="1870" class="Symbol">(</a><a id="1871" href="basicDataStructure.html#1120" class="InductiveConstructor">err</a> <a id="1875" href="libraries.IOlibrary.html#1875" class="Bound">e</a> <a id="1877" href="basicDataStructure.html#881" class="InductiveConstructor Operator">⟨</a> <a id="1879" href="libraries.IOlibrary.html#1879" class="Bound">lastcalladdr</a> <a id="1892" href="basicDataStructure.html#881" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="1895" href="libraries.IOlibrary.html#1895" class="Bound">curraddr</a> <a id="1904" href="basicDataStructure.html#881" class="InductiveConstructor Operator">∙</a> <a id="1906" href="libraries.IOlibrary.html#1906" class="Bound">lastfunname</a> <a id="1918" href="basicDataStructure.html#881" class="InductiveConstructor Operator">[</a> <a id="1920" href="libraries.IOlibrary.html#1920" class="Bound">lastmsg</a> <a id="1928" href="basicDataStructure.html#881" class="InductiveConstructor Operator">]⟩</a><a id="1930" class="Symbol">)</a> <a id="1932" class="Symbol">=</a> <a id="1934" href="libraries.IOlibrary.html#1569" class="Function">error2Str</a> <a id="1944" href="libraries.IOlibrary.html#1875" class="Bound">e</a>
<a id="1946" href="libraries.IOlibrary.html#1792" class="Function">errorMsg2Str</a> <a id="1959" href="basicDataStructure.html#1161" class="InductiveConstructor">invalidtransaction</a> <a id="1978" class="Symbol">=</a> <a id="1980" class="String">&quot;invalidtransaction&quot;</a>


<a id="checkamount"></a><a id="2003" href="libraries.IOlibrary.html#2003" class="Function">checkamount</a> <a id="2015" class="Symbol">:</a> <a id="2017" href="libraries.Mainlibrary.html#1036" class="Function">Ledger</a> <a id="2024" class="Symbol">→</a> <a id="2026" href="basicDataStructure.html#405" class="Function">Address</a> <a id="2034" class="Symbol">→</a> <a id="2036" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="2038" href="libraries.IOlibrary.html#2003" class="Function">checkamount</a> <a id="2050" href="libraries.IOlibrary.html#2050" class="Bound">ledger</a> <a id="2057" href="libraries.IOlibrary.html#2057" class="Bound">addr</a> <a id="2062" class="Symbol">=</a> <a id="2064" href="libraries.IOlibrary.html#2050" class="Bound">ledger</a> <a id="2071" href="libraries.IOlibrary.html#2057" class="Bound">addr</a> <a id="2076" class="Symbol">.</a><a id="2077" href="libraries.Mainlibrary.html#800" class="Field">amount</a>




<a id="2088" class="Comment">-- define state for IO</a>
<a id="2111" class="Keyword">record</a> <a id="StateIO"></a><a id="2118" href="libraries.IOlibrary.html#2118" class="Record">StateIO</a>  <a id="2127" class="Symbol">:</a> <a id="2129" href="Agda.Primitive.html#388" class="Primitive">Set</a>  <a id="2134" class="Keyword">where</a>
       <a id="2147" class="Keyword">constructor</a> <a id="⟨_ledger,_initialAddr,_gas⟩"></a><a id="2159" href="libraries.IOlibrary.html#2159" class="InductiveConstructor Operator">⟨_ledger,_initialAddr,_gas⟩</a>
       <a id="2194" class="Keyword">field</a>
        <a id="StateIO.ledger"></a><a id="2208" href="libraries.IOlibrary.html#2208" class="Field">ledger</a>       <a id="2221" class="Symbol">:</a> <a id="2223" href="libraries.Mainlibrary.html#1036" class="Function">Ledger</a>
        <a id="StateIO.initialAddr"></a><a id="2238" href="libraries.IOlibrary.html#2238" class="Field">initialAddr</a>  <a id="2251" class="Symbol">:</a> <a id="2253" href="basicDataStructure.html#405" class="Function">Address</a>
        <a id="StateIO.gas"></a><a id="2269" href="libraries.IOlibrary.html#2269" class="Field">gas</a>          <a id="2282" class="Symbol">:</a> <a id="2284" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="2286" class="Keyword">open</a> <a id="2291" href="libraries.IOlibrary.html#2118" class="Module">StateIO</a> <a id="2299" class="Keyword">public</a>




</pre></body></html>