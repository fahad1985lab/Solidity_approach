<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Simple-Model.example.solidityToagdaInsimplemodel-counterexample</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html" class="Module">Simple-Model.example.solidityToagdaInsimplemodel-counterexample</a> <a id="72" class="Keyword">where</a>

<a id="79" class="Keyword">open</a> <a id="84" class="Keyword">import</a> <a id="91" href="Data.Nat.html" class="Module">Data.Nat</a>  <a id="101" class="Keyword">hiding</a> <a id="108" class="Symbol">(</a><a id="109" href="Data.Nat.Base.html#1801" class="Function Operator">_&lt;_</a><a id="112" class="Symbol">)</a>
<a id="114" class="Keyword">open</a> <a id="119" class="Keyword">import</a> <a id="126" href="Data.List.html" class="Module">Data.List</a>
<a id="136" class="Keyword">open</a> <a id="141" class="Keyword">import</a> <a id="148" href="Data.Bool.html" class="Module">Data.Bool</a> <a id="158" class="Keyword">hiding</a> <a id="165" class="Symbol">(</a><a id="166" href="Data.Bool.Base.html#760" class="Datatype Operator">_&lt;_</a><a id="169" class="Symbol">)</a> <a id="171" class="Comment">--hiding (_&lt;_)</a>
<a id="186" class="Keyword">open</a> <a id="191" class="Keyword">import</a> <a id="198" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>   <a id="215" class="Keyword">hiding</a> <a id="222" class="Symbol">(</a><a id="223" href="Data.Bool.Base.html#760" class="Datatype Operator">_&lt;_</a><a id="226" class="Symbol">)</a>
<a id="228" class="Keyword">open</a> <a id="233" class="Keyword">import</a> <a id="240" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="254" class="Keyword">hiding</a> <a id="261" class="Symbol">(</a><a id="262" href="Data.Nat.Base.html#1801" class="Function Operator">_&lt;_</a><a id="265" class="Symbol">)</a>
<a id="267" class="Keyword">open</a> <a id="272" class="Keyword">import</a> <a id="279" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="290" class="Keyword">hiding</a> <a id="297" class="Symbol">(</a><a id="298" href="Data.Maybe.Base.html#2256" class="Function Operator">_&gt;&gt;=_</a><a id="303" class="Symbol">)</a>
<a id="305" class="Keyword">open</a> <a id="310" class="Keyword">import</a> <a id="317" href="Data.String.html" class="Module">Data.String</a> <a id="329" class="Keyword">hiding</a> <a id="336" class="Symbol">(</a><a id="337" href="Data.String.Base.html#2468" class="Function">length</a><a id="343" class="Symbol">;</a> <a id="345" href="Data.String.Base.html#1605" class="Primitive">show</a><a id="349" class="Symbol">;</a> <a id="351" href="Data.String.Base.html#1849" class="Function Operator">_&lt;_</a><a id="354" class="Symbol">)</a>
<a id="356" class="Keyword">open</a> <a id="361" class="Keyword">import</a> <a id="368" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a>

<a id="383" class="Comment">--simple model</a>
<a id="398" class="Keyword">open</a> <a id="403" class="Keyword">import</a> <a id="410" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html" class="Module">Simple-Model.ledgerversion.Ledger-Simple-Model</a>


<a id="459" class="Comment">--library</a>
<a id="469" class="Keyword">open</a> <a id="474" class="Keyword">import</a> <a id="481" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html" class="Module">Simple-Model.library-simple-model.basicDataStructureWithSimpleModel</a>



<a id="552" class="Comment">--compare</a>
<a id="_&lt;_"></a><a id="562" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#562" class="Function Operator">_&lt;_</a> <a id="566" class="Symbol">:</a> <a id="568" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="570" class="Symbol">→</a> <a id="572" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="574" class="Symbol">→</a> <a id="576" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="581" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a> <a id="586" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#562" class="Function Operator">&lt;</a> <a id="588" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#588" class="Bound">m</a> <a id="590" class="Symbol">=</a> <a id="592" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>
<a id="597" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="601" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#601" class="Bound">n</a> <a id="603" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#562" class="Function Operator">&lt;</a> <a id="605" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a> <a id="610" class="Symbol">=</a> <a id="612" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
<a id="618" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="622" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#622" class="Bound">n</a> <a id="624" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#562" class="Function Operator">&lt;</a> <a id="626" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="630" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#630" class="Bound">m</a> <a id="632" class="Symbol">=</a> <a id="634" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#622" class="Bound">n</a> <a id="636" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#562" class="Function Operator">&lt;</a> <a id="638" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#630" class="Bound">m</a>

<a id="641" class="Comment">--Example of a simple counter</a>

<a id="672" class="Comment">-- constant variable</a>
<a id="const"></a><a id="693" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#693" class="Function">const</a> <a id="699" class="Symbol">:</a> <a id="701" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="703" class="Symbol">→</a> <a id="705" class="Symbol">(</a><a id="706" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a> <a id="710" class="Symbol">→</a> <a id="712" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1274" class="Datatype">SmartContract</a> <a id="726" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a><a id="729" class="Symbol">)</a>
<a id="731" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#693" class="Function">const</a> <a id="737" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#737" class="Bound">n</a> <a id="739" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#739" class="Bound">msg</a> <a id="743" class="Symbol">=</a> <a id="745" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1314" class="InductiveConstructor">return</a> <a id="752" class="Symbol">(</a><a id="753" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#420" class="InductiveConstructor">nat</a> <a id="757" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#737" class="Bound">n</a><a id="758" class="Symbol">)</a>


<a id="762" class="Comment">-- define uint as in Solidity</a>
<a id="Max_Uint"></a><a id="792" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#792" class="Function Operator">Max_Uint</a> <a id="801" class="Symbol">:</a> <a id="803" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="805" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#792" class="Function Operator">Max_Uint</a> <a id="814" class="Symbol">=</a> <a id="816" class="Number">65535</a> 


<a id="825" class="Comment">-- test our ledger with our example</a>
<a id="testLedger"></a><a id="861" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#861" class="Function">testLedger</a> <a id="872" class="Symbol">:</a> <a id="874" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2019" class="Function">Ledger</a>
<a id="881" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#861" class="Function">testLedger</a> <a id="892" class="Number">1</a> <a id="894" class="Symbol">.</a><a id="895" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1911" class="Field">amount</a>             <a id="914" class="Symbol">=</a> <a id="916" class="Number">40</a>
<a id="919" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#861" class="Function">testLedger</a> <a id="930" class="Number">1</a> <a id="932" class="Symbol">.</a><a id="933" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1933" class="Field">fun</a> <a id="937" class="String">&quot;counter&quot;</a> <a id="947" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#947" class="Bound">m</a>    <a id="952" class="Symbol">=</a> <a id="954" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#693" class="Function">const</a> <a id="960" class="Number">0</a> <a id="962" class="Symbol">(</a><a id="963" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#420" class="InductiveConstructor">nat</a> <a id="967" class="Number">0</a><a id="968" class="Symbol">)</a>
<a id="970" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#861" class="Function">testLedger</a> <a id="981" class="Number">1</a> <a id="983" class="Symbol">.</a><a id="984" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1933" class="Field">fun</a> <a id="988" class="String">&quot;increment&quot;</a> <a id="1000" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#1000" class="Bound">m</a>  <a id="1003" class="Symbol">=</a>
                 <a id="1022" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1391" class="InductiveConstructor">exec</a> <a id="1027" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#730" class="InductiveConstructor">currentAddrLookupc</a>  <a id="1047" class="Symbol">λ</a> <a id="1049" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#1049" class="Bound">addr</a> <a id="1054" class="Symbol">→</a>
                 <a id="1073" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1391" class="InductiveConstructor">exec</a> <a id="1078" class="Symbol">(</a><a id="1079" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#600" class="InductiveConstructor">callc</a> <a id="1085" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#1049" class="Bound">addr</a> <a id="1090" class="String">&quot;counter&quot;</a> <a id="1100" class="Symbol">(</a><a id="1101" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#420" class="InductiveConstructor">nat</a> <a id="1105" class="Number">0</a><a id="1106" class="Symbol">))</a>
                 <a id="1126" class="Symbol">λ{(</a><a id="1129" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#420" class="InductiveConstructor">nat</a> <a id="1133" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#1133" class="Bound">oldcounter</a><a id="1143" class="Symbol">)</a> <a id="1145" class="Symbol">→</a>
                  <a id="1165" class="Symbol">(</a><a id="1166" href="Data.Bool.Base.html#1505" class="Function Operator">if</a> <a id="1169" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#1133" class="Bound">oldcounter</a> <a id="1180" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#562" class="Function Operator">&lt;</a> <a id="1182" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#792" class="Function Operator">Max_Uint</a>
                   <a id="1210" href="Data.Bool.Base.html#1505" class="Function Operator">then</a> <a id="1215" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1391" class="InductiveConstructor">exec</a> <a id="1220" class="Symbol">(</a><a id="1221" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#659" class="InductiveConstructor">updatec</a> <a id="1229" class="String">&quot;counter&quot;</a> <a id="1239" class="Symbol">(</a><a id="1240" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#693" class="Function">const</a> <a id="1246" class="Symbol">(</a><a id="1247" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="1251" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#1133" class="Bound">oldcounter</a><a id="1261" class="Symbol">)))</a>
                <a id="1281" class="Symbol">(λ</a> <a id="1284" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#1284" class="Bound">_</a> <a id="1286" class="Symbol">→</a> <a id="1288" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1314" class="InductiveConstructor">return</a> <a id="1295" class="Symbol">(</a><a id="1296" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#420" class="InductiveConstructor">nat</a> <a id="1300" class="Symbol">(</a><a id="1301" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="1305" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#1133" class="Bound">oldcounter</a><a id="1315" class="Symbol">)))</a>
                   <a id="1338" href="Data.Bool.Base.html#1505" class="Function Operator">else</a>
                  <a id="1361" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1349" class="InductiveConstructor">error</a> <a id="1367" class="Symbol">(</a><a id="1368" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#595" class="InductiveConstructor">strErr</a> <a id="1375" class="String">&quot;out of range error&quot;</a><a id="1395" class="Symbol">));</a>
                <a id="1415" class="CatchallClause Symbol">_</a> <a id="1417" class="Symbol">→</a> <a id="1419" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1349" class="InductiveConstructor">error</a> <a id="1425" class="Symbol">(</a><a id="1426" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#595" class="InductiveConstructor">strErr</a> <a id="1433" class="String">&quot;counter returns not a number&quot;</a><a id="1463" class="Symbol">)}</a>
  
<a id="1469" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#861" class="CatchallClause Function">testLedger</a><a id="1479" class="CatchallClause"> </a><a id="1480" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#1480" class="CatchallClause Bound">ow</a><a id="1482" class="CatchallClause"> </a><a id="1483" class="CatchallClause Symbol">.</a><a id="1484" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1911" class="CatchallClause Field">amount</a>         <a id="1499" class="Symbol">=</a> <a id="1501" class="Number">0</a>
<a id="1503" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#861" class="CatchallClause Function">testLedger</a><a id="1513" class="CatchallClause"> </a><a id="1514" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#1514" class="CatchallClause Bound">ow</a><a id="1516" class="CatchallClause"> </a><a id="1517" class="CatchallClause Symbol">.</a><a id="1518" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1933" class="CatchallClause Field">fun</a><a id="1521" class="CatchallClause"> </a><a id="1522" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#1522" class="CatchallClause Bound">ow&#39;</a><a id="1525" class="CatchallClause"> </a><a id="1526" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#1526" class="CatchallClause Bound">ow&#39;&#39;</a>   <a id="1533" class="Symbol">=</a> <a id="1535" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1349" class="InductiveConstructor">error</a> <a id="1541" class="Symbol">(</a><a id="1542" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#595" class="InductiveConstructor">strErr</a> <a id="1549" class="String">&quot;Undefined&quot;</a><a id="1560" class="Symbol">)</a>

</pre></body></html>