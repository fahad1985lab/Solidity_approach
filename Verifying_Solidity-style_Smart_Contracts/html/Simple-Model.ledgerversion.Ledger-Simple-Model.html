<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Simple-Model.ledgerversion.Ledger-Simple-Model</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html" class="Module">Simple-Model.ledgerversion.Ledger-Simple-Model</a> <a id="55" class="Keyword">where</a>

<a id="62" class="Keyword">open</a> <a id="67" class="Keyword">import</a> <a id="74" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="83" class="Keyword">open</a> <a id="88" class="Keyword">import</a> <a id="95" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a> <a id="112" class="Keyword">using</a> <a id="118" class="Symbol">(</a><a id="119" href="Agda.Builtin.Nat.html#426" class="Primitive Operator">_-_</a><a id="122" class="Symbol">)</a>
<a id="124" class="Keyword">open</a> <a id="129" class="Keyword">import</a> <a id="136" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="146" class="Keyword">open</a> <a id="151" class="Keyword">import</a> <a id="158" href="Data.List.html" class="Module">Data.List</a>
<a id="168" class="Keyword">open</a> <a id="173" class="Keyword">import</a> <a id="180" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="190" class="Keyword">open</a> <a id="195" class="Keyword">import</a> <a id="202" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>
<a id="217" class="Keyword">open</a> <a id="222" class="Keyword">import</a> <a id="229" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="243" class="Keyword">open</a> <a id="248" class="Keyword">import</a> <a id="255" href="Data.Maybe.html" class="Module">Data.Maybe</a>  <a id="267" class="Keyword">hiding</a> <a id="274" class="Symbol">(</a><a id="275" href="Data.Maybe.Base.html#2256" class="Function Operator">_&gt;&gt;=_</a><a id="280" class="Symbol">)</a>
<a id="282" class="Keyword">open</a> <a id="287" class="Keyword">import</a> <a id="294" href="Data.String.html" class="Module">Data.String</a> <a id="306" class="Keyword">hiding</a> <a id="313" class="Symbol">(</a><a id="314" href="Data.String.Base.html#2468" class="Function">length</a><a id="320" class="Symbol">)</a>

<a id="323" class="Comment">--library for simple model</a>
<a id="350" class="Keyword">open</a> <a id="355" class="Keyword">import</a> <a id="362" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html" class="Module">Simple-Model.library-simple-model.basicDataStructureWithSimpleModel</a>

<a id="431" class="Comment">-- main library</a>
<a id="447" class="Keyword">open</a> <a id="452" class="Keyword">import</a> <a id="459" href="libraries.natCompare.html" class="Module">libraries.natCompare</a>




<a id="484" class="Keyword">mutual</a>


<a id="493" class="Comment">--contract-commands</a>
  <a id="515" class="Keyword">data</a> <a id="CCommands"></a><a id="520" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#520" class="Datatype">CCommands</a> <a id="530" class="Symbol">:</a> <a id="532" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="536" class="Keyword">where</a>
    <a id="CCommands.transferc"></a><a id="546" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#546" class="InductiveConstructor">transferc</a>  <a id="557" class="Symbol">:</a>  <a id="560" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#479" class="Function">Amount</a> <a id="567" class="Symbol">→</a> <a id="569" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#636" class="Function">Address</a> <a id="577" class="Symbol">→</a> <a id="579" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#520" class="Datatype">CCommands</a>
    <a id="CCommands.callc"></a><a id="593" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#593" class="InductiveConstructor">callc</a>      <a id="604" class="Symbol">:</a>  <a id="607" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#636" class="Function">Address</a> <a id="615" class="Symbol">→</a> <a id="617" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#223" class="Function">FunctionName</a> <a id="630" class="Symbol">→</a> <a id="632" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#369" class="Datatype">Msg</a> <a id="636" class="Symbol">→</a> <a id="638" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#520" class="Datatype">CCommands</a>
    <a id="CCommands.updatec"></a><a id="652" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#652" class="InductiveConstructor">updatec</a>    <a id="663" class="Symbol">:</a>  <a id="666" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#223" class="Function">FunctionName</a> <a id="679" class="Symbol">→</a> <a id="681" class="Symbol">(</a><a id="682" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#369" class="Datatype">Msg</a> <a id="686" class="Symbol">→</a> <a id="688" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1191" class="Datatype">SmartContract</a> <a id="702" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#369" class="Datatype">Msg</a><a id="705" class="Symbol">)</a> <a id="707" class="Symbol">→</a> <a id="709" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#520" class="Datatype">CCommands</a>
    <a id="CCommands.currentAddrLookupc"></a><a id="723" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#723" class="InductiveConstructor">currentAddrLookupc</a>  <a id="743" class="Symbol">:</a> <a id="745" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#520" class="Datatype">CCommands</a>
    <a id="CCommands.callAddrLookupc"></a><a id="759" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#759" class="InductiveConstructor">callAddrLookupc</a>     <a id="779" class="Symbol">:</a> <a id="781" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#520" class="Datatype">CCommands</a>
    <a id="CCommands.getAmountc"></a><a id="795" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#795" class="InductiveConstructor">getAmountc</a>          <a id="815" class="Symbol">:</a> <a id="817" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#636" class="Function">Address</a> <a id="825" class="Symbol">→</a> <a id="827" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#520" class="Datatype">CCommands</a>


<a id="839" class="Comment">--contract-response</a>
  <a id="CResponse"></a><a id="861" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#861" class="Function">CResponse</a> <a id="871" class="Symbol">:</a> <a id="873" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#520" class="Datatype">CCommands</a> <a id="883" class="Symbol">→</a> <a id="885" href="Agda.Primitive.html#388" class="Primitive">Set</a>
  <a id="891" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#861" class="Function">CResponse</a> <a id="901" class="Symbol">(</a><a id="902" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#546" class="InductiveConstructor">transferc</a> <a id="912" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#912" class="Bound">amount</a> <a id="919" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#919" class="Bound">addr</a><a id="923" class="Symbol">)</a>  <a id="926" class="Symbol">=</a>  <a id="929" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="933" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#861" class="Function">CResponse</a> <a id="943" class="Symbol">(</a><a id="944" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#593" class="InductiveConstructor">callc</a> <a id="950" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#950" class="Bound">addr</a> <a id="955" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#955" class="Bound">fname</a> <a id="961" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#961" class="Bound">msg</a><a id="964" class="Symbol">)</a>   <a id="968" class="Symbol">=</a>  <a id="971" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#369" class="Datatype">Msg</a>
  <a id="977" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#861" class="Function">CResponse</a> <a id="987" class="Symbol">(</a><a id="988" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#652" class="InductiveConstructor">updatec</a> <a id="996" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#996" class="Bound">fname</a> <a id="1002" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1002" class="Bound">fdef</a><a id="1006" class="Symbol">)</a>     <a id="1012" class="Symbol">=</a>  <a id="1015" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="1019" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#861" class="Function">CResponse</a> <a id="1029" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#723" class="InductiveConstructor">currentAddrLookupc</a>       <a id="1054" class="Symbol">=</a> <a id="1056" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#636" class="Function">Address</a>
  <a id="1066" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#861" class="Function">CResponse</a> <a id="1076" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#759" class="InductiveConstructor">callAddrLookupc</a>          <a id="1101" class="Symbol">=</a> <a id="1103" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#636" class="Function">Address</a>
  <a id="1113" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#861" class="Function">CResponse</a> <a id="1123" class="Symbol">(</a><a id="1124" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#795" class="InductiveConstructor">getAmountc</a> <a id="1135" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1135" class="Bound">addr</a><a id="1139" class="Symbol">)</a>        <a id="1148" class="Symbol">=</a> <a id="1150" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#479" class="Function">Amount</a>



<a id="1160" class="Comment">--define smart contract</a>
  <a id="1186" class="Keyword">data</a> <a id="SmartContract"></a><a id="1191" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1191" class="Datatype">SmartContract</a> <a id="1205" class="Symbol">(</a><a id="1206" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1206" class="Bound">A</a> <a id="1208" class="Symbol">:</a> <a id="1210" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="1213" class="Symbol">)</a> <a id="1215" class="Symbol">:</a> <a id="1217" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1221" class="Keyword">where</a>
    <a id="SmartContract.return"></a><a id="1231" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1231" class="InductiveConstructor">return</a>  <a id="1239" class="Symbol">:</a>  <a id="1242" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1206" class="Bound">A</a> <a id="1244" class="Symbol">→</a> <a id="1246" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1191" class="Datatype">SmartContract</a> <a id="1260" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1206" class="Bound">A</a>
    <a id="SmartContract.error"></a><a id="1266" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1266" class="InductiveConstructor">error</a>   <a id="1274" class="Symbol">:</a>  <a id="1277" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#528" class="Datatype">ErrorMsg</a> <a id="1286" class="Symbol">→</a> <a id="1288" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1191" class="Datatype">SmartContract</a> <a id="1302" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1206" class="Bound">A</a>
    <a id="SmartContract.exec"></a><a id="1308" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1308" class="InductiveConstructor">exec</a>    <a id="1316" class="Symbol">:</a>  <a id="1319" class="Symbol">(</a><a id="1320" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1320" class="Bound">c</a> <a id="1322" class="Symbol">:</a> <a id="1324" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#520" class="Datatype">CCommands</a><a id="1333" class="Symbol">)</a>
            <a id="1347" class="Symbol">→</a> <a id="1349" class="Symbol">(</a><a id="1350" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#861" class="Function">CResponse</a> <a id="1360" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1320" class="Bound">c</a> <a id="1362" class="Symbol">→</a> <a id="1364" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1191" class="Datatype">SmartContract</a> <a id="1378" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1206" class="Bound">A</a><a id="1379" class="Symbol">)</a>
            <a id="1393" class="Symbol">→</a> <a id="1395" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1191" class="Datatype">SmartContract</a> <a id="1409" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1206" class="Bound">A</a>



<a id="1414" class="Comment">--define contract</a>
<a id="1432" class="Keyword">record</a> <a id="Contract"></a><a id="1439" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1439" class="Record">Contract</a> <a id="1448" class="Symbol">:</a> <a id="1450" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1454" class="Keyword">where</a>
  <a id="1462" class="Keyword">constructor</a> <a id="contract"></a><a id="1474" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1474" class="InductiveConstructor">contract</a>
  <a id="1485" class="Keyword">field</a>
    <a id="Contract.amount"></a><a id="1495" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1495" class="Field">amount</a>  <a id="1503" class="Symbol">:</a>  <a id="1506" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#479" class="Function">Amount</a>
    <a id="Contract.fun"></a><a id="1517" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1517" class="Field">fun</a>     <a id="1525" class="Symbol">:</a>  <a id="1528" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#223" class="Function">FunctionName</a>
            <a id="1553" class="Symbol">→</a> <a id="1555" class="Symbol">(</a><a id="1556" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#369" class="Datatype">Msg</a> <a id="1560" class="Symbol">→</a> <a id="1562" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1191" class="Datatype">SmartContract</a> <a id="1576" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#369" class="Datatype">Msg</a><a id="1579" class="Symbol">)</a>
<a id="1581" class="Keyword">open</a> <a id="1586" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1439" class="Module">Contract</a> <a id="1595" class="Keyword">public</a>


<a id="1604" class="Comment">-- define ledger</a>
<a id="Ledger"></a><a id="1621" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1621" class="Function">Ledger</a> <a id="1628" class="Symbol">:</a> <a id="1630" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="1634" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1621" class="Function">Ledger</a> <a id="1641" class="Symbol">=</a> <a id="1643" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#636" class="Function">Address</a>  <a id="1652" class="Symbol">→</a> <a id="1654" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1439" class="Record">Contract</a>


<a id="1665" class="Comment">--define exeute stack element</a>
<a id="1695" class="Keyword">record</a> <a id="ExecStackEl"></a><a id="1702" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1702" class="Record">ExecStackEl</a> <a id="1714" class="Symbol">:</a> <a id="1716" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1720" class="Keyword">where</a>
  <a id="1728" class="Keyword">constructor</a> <a id="execStackEl"></a><a id="1740" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1740" class="InductiveConstructor">execStackEl</a>
  <a id="1754" class="Keyword">field</a>
    <a id="ExecStackEl.lastCallAddress"></a><a id="1764" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1764" class="Field">lastCallAddress</a>  <a id="1781" class="Symbol">:</a>  <a id="1784" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#636" class="Function">Address</a>
    <a id="ExecStackEl.calledAddress"></a><a id="1796" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1796" class="Field">calledAddress</a>    <a id="1813" class="Symbol">:</a>  <a id="1816" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#636" class="Function">Address</a>
    <a id="ExecStackEl.continuation"></a><a id="1828" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1828" class="Field">continuation</a>     <a id="1845" class="Symbol">:</a>  <a id="1848" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#369" class="Datatype">Msg</a> <a id="1852" class="Symbol">→</a> <a id="1854" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1191" class="Datatype">SmartContract</a> <a id="1868" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#369" class="Datatype">Msg</a>
<a id="1872" class="Keyword">open</a> <a id="1877" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1702" class="Module">ExecStackEl</a> <a id="1889" class="Keyword">public</a>


<a id="ExecutionStack"></a><a id="1898" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1898" class="Function">ExecutionStack</a> <a id="1913" class="Symbol">:</a> <a id="1915" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="1919" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1898" class="Function">ExecutionStack</a> <a id="1934" class="Symbol">=</a> <a id="1936" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1941" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1702" class="Record">ExecStackEl</a>


<a id="1955" class="Comment">--define state execution function</a>
<a id="1989" class="Keyword">record</a> <a id="StateExecFun"></a><a id="1996" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1996" class="Record">StateExecFun</a> <a id="2009" class="Symbol">:</a> <a id="2011" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="2015" class="Keyword">where</a>
  <a id="2023" class="Keyword">constructor</a> <a id="stateEF"></a><a id="2035" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2035" class="InductiveConstructor">stateEF</a>
  <a id="2045" class="Keyword">field</a>
    <a id="StateExecFun.ledger"></a><a id="2055" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2055" class="Field">ledger</a>           <a id="2072" class="Symbol">:</a>  <a id="2075" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1621" class="Function">Ledger</a>
    <a id="StateExecFun.executionStack"></a><a id="2086" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2086" class="Field">executionStack</a>   <a id="2103" class="Symbol">:</a>  <a id="2106" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1898" class="Function">ExecutionStack</a>
    <a id="StateExecFun.lastCallAddress"></a><a id="2125" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2125" class="Field">lastCallAddress</a>  <a id="2142" class="Symbol">:</a>  <a id="2145" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#636" class="Function">Address</a>
    <a id="StateExecFun.currentAddress"></a><a id="2157" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2157" class="Field">currentAddress</a>   <a id="2174" class="Symbol">:</a>  <a id="2177" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#636" class="Function">Address</a>
    <a id="StateExecFun.nextstep"></a><a id="2189" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2189" class="Field">nextstep</a>         <a id="2206" class="Symbol">:</a>  <a id="2209" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1191" class="Datatype">SmartContract</a> <a id="2223" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#369" class="Datatype">Msg</a>
<a id="2227" class="Keyword">open</a> <a id="2232" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1996" class="Module">StateExecFun</a> <a id="2245" class="Keyword">public</a>



<a id="2255" class="Comment">--define update ledger</a>
<a id="updateLedger"></a><a id="2278" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2278" class="Function">updateLedger</a> <a id="2291" class="Symbol">:</a> <a id="2293" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1621" class="Function">Ledger</a> <a id="2300" class="Symbol">→</a>  <a id="2303" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#636" class="Function">Address</a> <a id="2311" class="Symbol">→</a> <a id="2313" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#223" class="Function">FunctionName</a> <a id="2326" class="Symbol">→</a> <a id="2328" class="Symbol">(</a><a id="2329" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#369" class="Datatype">Msg</a> <a id="2333" class="Symbol">→</a> <a id="2335" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1191" class="Datatype">SmartContract</a> <a id="2349" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#369" class="Datatype">Msg</a><a id="2352" class="Symbol">)</a> <a id="2354" class="Symbol">→</a> <a id="2356" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1621" class="Function">Ledger</a>
<a id="2363" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2278" class="Function">updateLedger</a> <a id="2376" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2376" class="Bound">ledger</a> <a id="2383" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2383" class="Bound">changedAddr</a> <a id="2395" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2395" class="Bound">changedFname</a> <a id="2408" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2408" class="Bound">f</a> <a id="2410" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2410" class="Bound">a</a> <a id="2412" class="Symbol">.</a><a id="2413" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1495" class="Field">amount</a>
         <a id="2429" class="Symbol">=</a> <a id="2431" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2376" class="Bound">ledger</a> <a id="2438" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2410" class="Bound">a</a> <a id="2440" class="Symbol">.</a><a id="2441" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1495" class="Field">amount</a>
<a id="2448" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2278" class="Function">updateLedger</a> <a id="2461" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2461" class="Bound">ledger</a> <a id="2468" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2468" class="Bound">changedAddr</a> <a id="2480" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2480" class="Bound">changedFname</a> <a id="2493" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2493" class="Bound">f</a> <a id="2495" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2495" class="Bound">a</a> <a id="2497" class="Symbol">.</a><a id="2498" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1517" class="Field">fun</a> <a id="2502" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2502" class="Bound">fname</a>
         <a id="2517" class="Symbol">=</a> <a id="2519" href="Data.Bool.Base.html#1505" class="Function Operator">if</a> <a id="2522" class="Symbol">(</a><a id="2523" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2495" class="Bound">a</a> <a id="2525" href="Data.Nat.Base.html#1283" class="Primitive Operator">≡ᵇ</a> <a id="2528" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2468" class="Bound">changedAddr</a><a id="2539" class="Symbol">)</a> <a id="2541" href="Data.Bool.Base.html#995" class="Function Operator">∧</a> <a id="2543" class="Symbol">(</a><a id="2544" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2502" class="Bound">fname</a> <a id="2550" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#267" class="Function Operator">≡fun</a> <a id="2555" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2480" class="Bound">changedFname</a><a id="2567" class="Symbol">)</a>
            <a id="2581" href="Data.Bool.Base.html#1505" class="Function Operator">then</a> <a id="2586" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2493" class="Bound">f</a> <a id="2588" href="Data.Bool.Base.html#1505" class="Function Operator">else</a> <a id="2593" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2461" class="Bound">ledger</a> <a id="2600" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2495" class="Bound">a</a> <a id="2602" class="Symbol">.</a><a id="2603" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1517" class="Field">fun</a> <a id="2607" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2502" class="Bound">fname</a>


<a id="2615" class="Comment">-- update ledger amount</a>
<a id="updateLedgerAmount"></a><a id="2639" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2639" class="Function">updateLedgerAmount</a> <a id="2658" class="Symbol">:</a> <a id="2660" class="Symbol">(</a><a id="2661" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2661" class="Bound">ledger</a> <a id="2668" class="Symbol">:</a> <a id="2670" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1621" class="Function">Ledger</a><a id="2676" class="Symbol">)</a>
         <a id="2687" class="Symbol">→</a> <a id="2689" class="Symbol">(</a><a id="2690" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2690" class="Bound">currentAddr</a> <a id="2702" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2702" class="Bound">destinationAddr</a> <a id="2718" class="Symbol">:</a> <a id="2720" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#636" class="Function">Address</a><a id="2727" class="Symbol">)</a>
               <a id="2744" class="Symbol">(</a><a id="2745" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2745" class="Bound">amount&#39;</a> <a id="2753" class="Symbol">:</a> <a id="2755" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#479" class="Function">Amount</a><a id="2761" class="Symbol">)</a>
         <a id="2772" class="Symbol">→</a> <a id="2774" class="Symbol">(</a><a id="2775" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2775" class="Bound">correctAmount</a> <a id="2789" class="Symbol">:</a> <a id="2791" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2745" class="Bound">amount&#39;</a> <a id="2799" href="libraries.natCompare.html#712" class="Function Operator">≦r</a>  <a id="2803" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2661" class="Bound">ledger</a> <a id="2810" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2690" class="Bound">currentAddr</a> <a id="2822" class="Symbol">.</a><a id="2823" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1495" class="Field">amount</a><a id="2829" class="Symbol">)</a>
         <a id="2840" class="Symbol">→</a> <a id="2842" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1621" class="Function">Ledger</a>
<a id="2849" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2639" class="Function">updateLedgerAmount</a> <a id="2868" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2868" class="Bound">ledger</a> <a id="2875" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2875" class="Bound">currentAddr</a> <a id="2887" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2887" class="Bound">destinationAddr</a> <a id="2903" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2903" class="Bound">amount&#39;</a> <a id="2911" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2911" class="Bound">correctAmount</a> <a id="2925" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2925" class="Bound">addr</a> <a id="2930" class="Symbol">.</a><a id="2931" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1495" class="Field">amount</a>
     <a id="2943" class="Symbol">=</a> <a id="2945" href="Data.Bool.Base.html#1505" class="Function Operator">if</a> <a id="2948" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2925" class="Bound">addr</a> <a id="2953" href="Data.Nat.Base.html#1283" class="Primitive Operator">≡ᵇ</a> <a id="2956" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2875" class="Bound">currentAddr</a>
     <a id="2973" href="Data.Bool.Base.html#1505" class="Function Operator">then</a> <a id="2978" class="Symbol">(</a><a id="2979" href="Data.Bool.Base.html#1505" class="Function Operator">if</a> <a id="2982" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2925" class="Bound">addr</a> <a id="2987" href="Data.Nat.Base.html#1283" class="Primitive Operator">≡ᵇ</a> <a id="2990" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2887" class="Bound">destinationAddr</a>
           <a id="3017" href="Data.Bool.Base.html#1505" class="Function Operator">then</a> <a id="3022" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2868" class="Bound">ledger</a> <a id="3029" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2925" class="Bound">addr</a> <a id="3034" class="Symbol">.</a><a id="3035" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1495" class="Field">amount</a>
           <a id="3053" href="Data.Bool.Base.html#1505" class="Function Operator">else</a> <a id="3058" href="libraries.natCompare.html#3559" class="Function">subtract</a> <a id="3067" class="Symbol">(</a><a id="3068" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2868" class="Bound">ledger</a> <a id="3075" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2875" class="Bound">currentAddr</a> <a id="3087" class="Symbol">.</a><a id="3088" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1495" class="Field">amount</a><a id="3094" class="Symbol">)</a> <a id="3096" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2903" class="Bound">amount&#39;</a> <a id="3104" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2911" class="Bound">correctAmount</a><a id="3117" class="Symbol">)</a>
     <a id="3124" href="Data.Bool.Base.html#1505" class="Function Operator">else</a> <a id="3129" class="Symbol">(</a><a id="3130" href="Data.Bool.Base.html#1505" class="Function Operator">if</a> <a id="3133" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2925" class="Bound">addr</a> <a id="3138" href="Data.Nat.Base.html#1283" class="Primitive Operator">≡ᵇ</a> <a id="3141" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2887" class="Bound">destinationAddr</a>
     <a id="3162" href="Data.Bool.Base.html#1505" class="Function Operator">then</a> <a id="3167" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2868" class="Bound">ledger</a> <a id="3174" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2887" class="Bound">destinationAddr</a> <a id="3190" class="Symbol">.</a><a id="3191" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1495" class="Field">amount</a> <a id="3198" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="3200" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2903" class="Bound">amount&#39;</a>
     <a id="3213" href="Data.Bool.Base.html#1505" class="Function Operator">else</a> <a id="3218" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2868" class="Bound">ledger</a> <a id="3225" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2925" class="Bound">addr</a> <a id="3230" class="Symbol">.</a><a id="3231" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1495" class="Field">amount</a><a id="3237" class="Symbol">)</a>
<a id="3239" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2639" class="Function">updateLedgerAmount</a> <a id="3258" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3258" class="Bound">ledger</a> <a id="3265" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3265" class="Bound">currentAddr</a> <a id="3277" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3277" class="Bound">newAddr</a> <a id="3285" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3285" class="Bound">amount&#39;</a> <a id="3293" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3293" class="Bound">correctAmount</a> <a id="3307" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3307" class="Bound">addr</a> <a id="3312" class="Symbol">.</a><a id="3313" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1517" class="Field">fun</a>
     <a id="3322" class="Symbol">=</a> <a id="3324" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3258" class="Bound">ledger</a> <a id="3331" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3307" class="Bound">addr</a> <a id="3336" class="Symbol">.</a><a id="3337" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1517" class="Field">fun</a>




<a id="3345" class="Comment">--define execute transfer aux</a>
<a id="executeTransferAux"></a><a id="3375" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3375" class="Function">executeTransferAux</a> <a id="3394" class="Symbol">:</a> <a id="3396" class="Symbol">(</a><a id="3397" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3397" class="Bound">oldLedger</a> <a id="3407" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3407" class="Bound">currentLedger</a> <a id="3421" class="Symbol">:</a> <a id="3423" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1621" class="Function">Ledger</a><a id="3429" class="Symbol">)</a>
                  <a id="3449" class="Symbol">→</a> <a id="3451" class="Symbol">(</a><a id="3452" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3452" class="Bound">executionStack</a> <a id="3467" class="Symbol">:</a> <a id="3469" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1898" class="Function">ExecutionStack</a><a id="3483" class="Symbol">)</a>
                  <a id="3503" class="Symbol">→</a> <a id="3505" class="Symbol">(</a><a id="3506" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3506" class="Bound">callAddr</a> <a id="3515" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3515" class="Bound">currentAddr</a> <a id="3527" class="Symbol">:</a> <a id="3529" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#636" class="Function">Address</a><a id="3536" class="Symbol">)</a>
                  <a id="3556" class="Symbol">→</a> <a id="3558" class="Symbol">(</a><a id="3559" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3559" class="Bound">amount&#39;</a> <a id="3567" class="Symbol">:</a> <a id="3569" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#479" class="Function">Amount</a><a id="3575" class="Symbol">)</a>
                  <a id="3595" class="Symbol">→</a> <a id="3597" class="Symbol">(</a><a id="3598" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3598" class="Bound">destinationAddr</a> <a id="3614" class="Symbol">:</a> <a id="3616" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#636" class="Function">Address</a><a id="3623" class="Symbol">)</a>
                  <a id="3643" class="Symbol">→</a> <a id="3645" class="Symbol">(</a><a id="3646" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3646" class="Bound">cont</a> <a id="3651" class="Symbol">:</a> <a id="3653" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1191" class="Datatype">SmartContract</a> <a id="3667" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#369" class="Datatype">Msg</a><a id="3670" class="Symbol">)</a>
                  <a id="3690" class="Symbol">→</a> <a id="3692" class="Symbol">(</a><a id="3693" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3693" class="Bound">cp</a>  <a id="3697" class="Symbol">:</a> <a id="3699" href="libraries.natCompare.html#1049" class="Datatype">OrderingLeq</a> <a id="3711" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3559" class="Bound">amount&#39;</a> <a id="3719" class="Symbol">(</a><a id="3720" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3407" class="Bound">currentLedger</a> <a id="3734" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3515" class="Bound">currentAddr</a> <a id="3746" class="Symbol">.</a><a id="3747" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1495" class="Field">amount</a>  <a id="3755" class="Symbol">))</a>
                  <a id="3776" class="Symbol">→</a> <a id="3778" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1996" class="Record">StateExecFun</a>
<a id="3791" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3375" class="Function">executeTransferAux</a> <a id="3810" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3810" class="Bound">oldLedger</a> <a id="3820" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3820" class="Bound">currentLedger</a> <a id="3834" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3834" class="Bound">executionStack</a> <a id="3849" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3849" class="Bound">callAddr</a> <a id="3858" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3858" class="Bound">currentAddr</a> <a id="3870" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3870" class="Bound">amount&#39;</a> <a id="3878" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3878" class="Bound">destinationAddr</a> <a id="3894" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3894" class="Bound">cont</a> <a id="3899" class="Symbol">(</a><a id="3900" href="libraries.natCompare.html#1087" class="InductiveConstructor">leq</a> <a id="3904" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3904" class="Bound">x</a><a id="3905" class="Symbol">)</a> <a id="3907" class="Symbol">=</a>
          <a id="3919" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2035" class="InductiveConstructor">stateEF</a> <a id="3927" class="Symbol">(</a><a id="3928" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2639" class="Function">updateLedgerAmount</a> <a id="3947" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3820" class="Bound">currentLedger</a> <a id="3961" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3858" class="Bound">currentAddr</a> <a id="3973" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3878" class="Bound">destinationAddr</a> <a id="3989" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3870" class="Bound">amount&#39;</a> <a id="3997" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3904" class="Bound">x</a><a id="3998" class="Symbol">)</a>
             <a id="4013" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3834" class="Bound">executionStack</a> <a id="4028" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3849" class="Bound">callAddr</a> <a id="4037" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3858" class="Bound">currentAddr</a> <a id="4049" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3894" class="Bound">cont</a>

<a id="4055" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3375" class="Function">executeTransferAux</a> <a id="4074" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4074" class="Bound">oldLedger</a> <a id="4084" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4084" class="Bound">currentLedger</a> <a id="4098" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4098" class="Bound">executionStack</a> <a id="4113" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4113" class="Bound">callAddr</a> <a id="4122" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4122" class="Bound">currentAddr</a> <a id="4134" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4134" class="Bound">amount</a> <a id="4141" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4141" class="Bound">destinationAddr</a> <a id="4157" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4157" class="Bound">cont</a> <a id="4162" class="Symbol">(</a><a id="4163" href="libraries.natCompare.html#1125" class="InductiveConstructor">greater</a> <a id="4171" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4171" class="Bound">x</a><a id="4172" class="Symbol">)</a> <a id="4174" class="Symbol">=</a>
         <a id="4185" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2035" class="InductiveConstructor">stateEF</a> <a id="4193" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4074" class="Bound">oldLedger</a> <a id="4203" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4098" class="Bound">executionStack</a> <a id="4218" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4113" class="Bound">callAddr</a> <a id="4227" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4122" class="Bound">currentAddr</a>
             <a id="4252" class="Symbol">(</a><a id="4253" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1266" class="InductiveConstructor">error</a> <a id="4259" class="Symbol">(</a><a id="4260" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#551" class="InductiveConstructor">strErr</a> <a id="4267" class="String">&quot;not enough money&quot;</a><a id="4285" class="Symbol">))</a>

<a id="4289" class="Comment">--define execute transfer</a>
<a id="executeTransfer"></a><a id="4315" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4315" class="Function">executeTransfer</a> <a id="4331" class="Symbol">:</a> <a id="4333" class="Symbol">(</a><a id="4334" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4334" class="Bound">oldLedger</a> <a id="4344" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4344" class="Bound">currentLedger</a> <a id="4358" class="Symbol">:</a> <a id="4360" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1621" class="Function">Ledger</a><a id="4366" class="Symbol">)</a>
                  <a id="4386" class="Symbol">→</a> <a id="4388" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1898" class="Function">ExecutionStack</a>
                  <a id="4421" class="Symbol">→</a> <a id="4423" class="Symbol">(</a><a id="4424" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4424" class="Bound">callAddr</a> <a id="4433" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4433" class="Bound">currentAddr</a> <a id="4445" class="Symbol">:</a> <a id="4447" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#636" class="Function">Address</a><a id="4454" class="Symbol">)</a>
                  <a id="4474" class="Symbol">→</a> <a id="4476" class="Symbol">(</a><a id="4477" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4477" class="Bound">amount&#39;</a> <a id="4485" class="Symbol">:</a> <a id="4487" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#479" class="Function">Amount</a><a id="4493" class="Symbol">)</a>
                  <a id="4513" class="Symbol">→</a> <a id="4515" class="Symbol">(</a><a id="4516" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4516" class="Bound">destinationAddr</a> <a id="4532" class="Symbol">:</a> <a id="4534" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#636" class="Function">Address</a><a id="4541" class="Symbol">)</a>
                  <a id="4561" class="Symbol">→</a> <a id="4563" class="Symbol">(</a><a id="4564" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4564" class="Bound">cont</a> <a id="4569" class="Symbol">:</a> <a id="4571" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1191" class="Datatype">SmartContract</a> <a id="4585" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#369" class="Datatype">Msg</a><a id="4588" class="Symbol">)</a>
                  <a id="4608" class="Symbol">→</a> <a id="4610" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1996" class="Record">StateExecFun</a>
<a id="4623" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4315" class="Function">executeTransfer</a> <a id="4639" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4639" class="Bound">oldLedger</a> <a id="4649" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4649" class="Bound">currentLedger</a> <a id="4663" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4663" class="Bound">exexecutionStack</a> <a id="4680" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4680" class="Bound">callAddr</a> <a id="4689" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4689" class="Bound">currentAddr</a> <a id="4701" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4701" class="Bound">amount&#39;</a> <a id="4709" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4709" class="Bound">destinationAddr</a> <a id="4725" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4725" class="Bound">cont</a>
                <a id="4746" class="Symbol">=</a> <a id="4748" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3375" class="Function">executeTransferAux</a> <a id="4767" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4639" class="Bound">oldLedger</a> <a id="4777" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4649" class="Bound">currentLedger</a> <a id="4791" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4663" class="Bound">exexecutionStack</a> <a id="4808" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4680" class="Bound">callAddr</a> <a id="4817" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4689" class="Bound">currentAddr</a> <a id="4829" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4701" class="Bound">amount&#39;</a>
                   <a id="4856" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4709" class="Bound">destinationAddr</a> <a id="4872" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4725" class="Bound">cont</a>  <a id="4878" class="Symbol">(</a><a id="4879" href="libraries.natCompare.html#2249" class="Function">compareLeq</a> <a id="4890" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4701" class="Bound">amount&#39;</a> <a id="4898" class="Symbol">(</a><a id="4899" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4649" class="Bound">currentLedger</a> <a id="4913" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4689" class="Bound">currentAddr</a> <a id="4925" class="Symbol">.</a><a id="4926" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1495" class="Field">amount</a>  <a id="4934" class="Symbol">))</a>

<a id="4938" class="Comment">--define stepEF</a>
<a id="stepEF"></a><a id="4954" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4954" class="Function">stepEF</a> <a id="4961" class="Symbol">:</a> <a id="4963" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1621" class="Function">Ledger</a> <a id="4970" class="Symbol">→</a> <a id="4972" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1996" class="Record">StateExecFun</a> <a id="4985" class="Symbol">→</a> <a id="4987" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1996" class="Record">StateExecFun</a>
<a id="stepEFntimes"></a><a id="5000" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5000" class="Function">stepEFntimes</a> <a id="5013" class="Symbol">:</a> <a id="5015" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1621" class="Function">Ledger</a> <a id="5022" class="Symbol">→</a> <a id="5024" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1996" class="Record">StateExecFun</a> <a id="5037" class="Symbol">→</a> <a id="5039" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="5041" class="Symbol">→</a> <a id="5043" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1996" class="Record">StateExecFun</a>
<a id="5056" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4954" class="Function">stepEF</a> <a id="5063" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5063" class="Bound">oldLedger</a> <a id="5073" class="Symbol">(</a><a id="5074" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2035" class="InductiveConstructor">stateEF</a> <a id="5082" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5082" class="Bound">currentLedger</a> <a id="5096" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="5099" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5099" class="Bound">callAddr</a> <a id="5108" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5108" class="Bound">currentAddr</a> <a id="5120" class="Symbol">(</a><a id="5121" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1231" class="InductiveConstructor">return</a> <a id="5128" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5128" class="Bound">result</a><a id="5134" class="Symbol">))</a>
       <a id="5144" class="Symbol">=</a> <a id="5146" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2035" class="InductiveConstructor">stateEF</a> <a id="5154" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5082" class="Bound">currentLedger</a>  <a id="5169" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="5172" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5099" class="Bound">callAddr</a> <a id="5181" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5108" class="Bound">currentAddr</a> <a id="5193" class="Symbol">(</a><a id="5194" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1231" class="InductiveConstructor">return</a> <a id="5201" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5128" class="Bound">result</a><a id="5207" class="Symbol">)</a>
<a id="5209" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4954" class="Function">stepEF</a> <a id="5216" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5216" class="Bound">oldLedger</a> <a id="5226" class="Symbol">(</a><a id="5227" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2035" class="InductiveConstructor">stateEF</a> <a id="5235" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5235" class="Bound">currentLedger</a> <a id="5249" class="Symbol">(</a><a id="5250" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5250" class="Bound">execSEl</a> <a id="5258" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5260" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5260" class="Bound">executionStack</a><a id="5274" class="Symbol">)</a> <a id="5276" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5276" class="Bound">callAddr</a> <a id="5285" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5285" class="Bound">currentAddr</a> <a id="5297" class="Symbol">(</a><a id="5298" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1231" class="InductiveConstructor">return</a> <a id="5305" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5305" class="Bound">result</a><a id="5311" class="Symbol">))</a>
       <a id="5321" class="Symbol">=</a> <a id="5323" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2035" class="InductiveConstructor">stateEF</a> <a id="5331" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5235" class="Bound">currentLedger</a> <a id="5345" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5260" class="Bound">executionStack</a> <a id="5360" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5276" class="Bound">callAddr</a>  <a id="5370" class="Symbol">(</a><a id="5371" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5250" class="Bound">execSEl</a> <a id="5379" class="Symbol">.</a><a id="5380" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1796" class="Field">calledAddress</a><a id="5393" class="Symbol">)</a> <a id="5395" class="Symbol">(</a><a id="5396" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5250" class="Bound">execSEl</a> <a id="5404" class="Symbol">.</a><a id="5405" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1828" class="Field">continuation</a> <a id="5418" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5305" class="Bound">result</a><a id="5424" class="Symbol">)</a>
<a id="5426" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4954" class="CatchallClause Function">stepEF</a><a id="5432" class="CatchallClause"> </a><a id="5433" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5433" class="CatchallClause Bound">oldLedger</a><a id="5442" class="CatchallClause"> </a><a id="5443" class="CatchallClause Symbol">(</a><a id="5444" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2035" class="CatchallClause InductiveConstructor">stateEF</a><a id="5451" class="CatchallClause"> </a><a id="5452" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5452" class="CatchallClause Bound">currentLedger</a><a id="5465" class="CatchallClause"> </a><a id="5466" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5466" class="CatchallClause Bound">executionStack</a><a id="5480" class="CatchallClause"> </a><a id="5481" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5481" class="CatchallClause Bound">callAddr</a><a id="5489" class="CatchallClause"> </a><a id="5490" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5490" class="CatchallClause Bound">currentAddr</a><a id="5501" class="CatchallClause"> </a><a id="5502" class="CatchallClause Symbol">(</a><a id="5503" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1308" class="CatchallClause InductiveConstructor">exec</a><a id="5507" class="CatchallClause"> </a><a id="5508" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#723" class="CatchallClause InductiveConstructor">currentAddrLookupc</a><a id="5526" class="CatchallClause"> </a><a id="5527" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5527" class="CatchallClause Bound">cont</a><a id="5531" class="CatchallClause Symbol">))</a>
       <a id="5541" class="Symbol">=</a> <a id="5543" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2035" class="InductiveConstructor">stateEF</a> <a id="5551" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5452" class="Bound">currentLedger</a> <a id="5565" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5466" class="Bound">executionStack</a> <a id="5580" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5481" class="Bound">callAddr</a> <a id="5589" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5490" class="Bound">currentAddr</a> <a id="5601" class="Symbol">(</a><a id="5602" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5527" class="Bound">cont</a> <a id="5607" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5490" class="Bound">currentAddr</a><a id="5618" class="Symbol">)</a>
<a id="5620" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4954" class="CatchallClause Function">stepEF</a><a id="5626" class="CatchallClause"> </a><a id="5627" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5627" class="CatchallClause Bound">oldLedger</a><a id="5636" class="CatchallClause"> </a><a id="5637" class="CatchallClause Symbol">(</a><a id="5638" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2035" class="CatchallClause InductiveConstructor">stateEF</a><a id="5645" class="CatchallClause"> </a><a id="5646" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5646" class="CatchallClause Bound">currentLedger</a><a id="5659" class="CatchallClause"> </a><a id="5660" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5660" class="CatchallClause Bound">executionStack</a><a id="5674" class="CatchallClause"> </a><a id="5675" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5675" class="CatchallClause Bound">callAddr</a><a id="5683" class="CatchallClause"> </a><a id="5684" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5684" class="CatchallClause Bound">currentAddr</a><a id="5695" class="CatchallClause"> </a><a id="5696" class="CatchallClause Symbol">(</a><a id="5697" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1308" class="CatchallClause InductiveConstructor">exec</a><a id="5701" class="CatchallClause"> </a><a id="5702" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#759" class="CatchallClause InductiveConstructor">callAddrLookupc</a><a id="5717" class="CatchallClause"> </a><a id="5718" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5718" class="CatchallClause Bound">cont</a><a id="5722" class="CatchallClause Symbol">))</a>
       <a id="5732" class="Symbol">=</a> <a id="5734" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2035" class="InductiveConstructor">stateEF</a> <a id="5742" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5646" class="Bound">currentLedger</a> <a id="5756" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5660" class="Bound">executionStack</a> <a id="5771" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5675" class="Bound">callAddr</a> <a id="5780" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5684" class="Bound">currentAddr</a> <a id="5792" class="Symbol">(</a><a id="5793" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5718" class="Bound">cont</a> <a id="5798" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5675" class="Bound">callAddr</a><a id="5806" class="Symbol">)</a>
<a id="5808" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4954" class="CatchallClause Function">stepEF</a><a id="5814" class="CatchallClause"> </a><a id="5815" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5815" class="CatchallClause Bound">oldLedger</a><a id="5824" class="CatchallClause"> </a><a id="5825" class="CatchallClause Symbol">(</a><a id="5826" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2035" class="CatchallClause InductiveConstructor">stateEF</a><a id="5833" class="CatchallClause"> </a><a id="5834" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5834" class="CatchallClause Bound">currentLedger</a><a id="5847" class="CatchallClause"> </a><a id="5848" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5848" class="CatchallClause Bound">executionStack</a><a id="5862" class="CatchallClause"> </a><a id="5863" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5863" class="CatchallClause Bound">callAddr</a><a id="5871" class="CatchallClause"> </a><a id="5872" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5872" class="CatchallClause Bound">currentAddr</a>
                            <a id="5912" class="CatchallClause Symbol">(</a><a id="5913" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1308" class="CatchallClause InductiveConstructor">exec</a><a id="5917" class="CatchallClause"> </a><a id="5918" class="CatchallClause Symbol">(</a><a id="5919" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#652" class="CatchallClause InductiveConstructor">updatec</a><a id="5926" class="CatchallClause"> </a><a id="5927" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5927" class="CatchallClause Bound">changedFname</a><a id="5939" class="CatchallClause"> </a><a id="5940" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5940" class="CatchallClause Bound">changedFdef</a><a id="5951" class="CatchallClause Symbol">)</a><a id="5952" class="CatchallClause"> </a><a id="5953" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5953" class="CatchallClause Bound">cont</a><a id="5957" class="CatchallClause Symbol">))</a>
       <a id="5967" class="Symbol">=</a> <a id="5969" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2035" class="InductiveConstructor">stateEF</a> <a id="5977" class="Symbol">(</a><a id="5978" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2278" class="Function">updateLedger</a> <a id="5991" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5834" class="Bound">currentLedger</a> <a id="6005" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5872" class="Bound">currentAddr</a> <a id="6017" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5927" class="Bound">changedFname</a> <a id="6030" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5940" class="Bound">changedFdef</a><a id="6041" class="Symbol">)</a>
                   <a id="6062" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5848" class="Bound">executionStack</a> <a id="6077" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5863" class="Bound">callAddr</a> <a id="6086" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5872" class="Bound">currentAddr</a> <a id="6098" class="Symbol">(</a><a id="6099" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5953" class="Bound">cont</a> <a id="6104" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a><a id="6106" class="Symbol">)</a>
<a id="6108" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4954" class="CatchallClause Function">stepEF</a><a id="6114" class="CatchallClause"> </a><a id="6115" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6115" class="CatchallClause Bound">oldLedger</a><a id="6124" class="CatchallClause"> </a><a id="6125" class="CatchallClause Symbol">(</a><a id="6126" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2035" class="CatchallClause InductiveConstructor">stateEF</a><a id="6133" class="CatchallClause"> </a><a id="6134" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6134" class="CatchallClause Bound">currentLedger</a><a id="6147" class="CatchallClause"> </a><a id="6148" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6148" class="CatchallClause Bound">executionStack</a><a id="6162" class="CatchallClause"> </a><a id="6163" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6163" class="CatchallClause Bound">oldCalladdr</a><a id="6174" class="CatchallClause"> </a><a id="6175" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6175" class="CatchallClause Bound">oldCurrentAddr</a><a id="6189" class="CatchallClause"> </a><a id="6190" class="CatchallClause Symbol">(</a><a id="6191" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1308" class="CatchallClause InductiveConstructor">exec</a><a id="6195" class="CatchallClause"> </a><a id="6196" class="CatchallClause Symbol">(</a><a id="6197" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#593" class="CatchallClause InductiveConstructor">callc</a><a id="6202" class="CatchallClause"> </a><a id="6203" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6203" class="CatchallClause Bound">newaddr</a><a id="6210" class="CatchallClause"> </a><a id="6211" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6211" class="CatchallClause Bound">fname</a><a id="6216" class="CatchallClause"> </a><a id="6217" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6217" class="CatchallClause Bound">msg</a><a id="6220" class="CatchallClause Symbol">)</a><a id="6221" class="CatchallClause"> </a><a id="6222" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6222" class="CatchallClause Bound">cont</a><a id="6226" class="CatchallClause Symbol">))</a>
       <a id="6236" class="Symbol">=</a> <a id="6238" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2035" class="InductiveConstructor">stateEF</a> <a id="6246" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6134" class="Bound">currentLedger</a> <a id="6260" class="Symbol">(</a><a id="6261" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1740" class="InductiveConstructor">execStackEl</a> <a id="6273" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6163" class="Bound">oldCalladdr</a> <a id="6285" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6175" class="Bound">oldCurrentAddr</a> <a id="6300" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6222" class="Bound">cont</a>  <a id="6306" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6308" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6148" class="Bound">executionStack</a><a id="6322" class="Symbol">)</a>  <a id="6325" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6175" class="Bound">oldCurrentAddr</a> <a id="6340" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6203" class="Bound">newaddr</a>
                   <a id="6367" class="Symbol">(</a><a id="6368" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6134" class="Bound">currentLedger</a> <a id="6382" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6203" class="Bound">newaddr</a> <a id="6390" class="Symbol">.</a><a id="6391" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1517" class="Field">fun</a> <a id="6395" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6211" class="Bound">fname</a> <a id="6401" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6217" class="Bound">msg</a><a id="6404" class="Symbol">)</a>

<a id="6407" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4954" class="CatchallClause Function">stepEF</a><a id="6413" class="CatchallClause"> </a><a id="6414" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6414" class="CatchallClause Bound">oldLedger</a><a id="6423" class="CatchallClause"> </a><a id="6424" class="CatchallClause Symbol">(</a><a id="6425" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2035" class="CatchallClause InductiveConstructor">stateEF</a><a id="6432" class="CatchallClause"> </a><a id="6433" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6433" class="CatchallClause Bound">currentLedger</a><a id="6446" class="CatchallClause"> </a><a id="6447" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6447" class="CatchallClause Bound">executionStack</a><a id="6461" class="CatchallClause"> </a><a id="6462" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6462" class="CatchallClause Bound">callAddr</a><a id="6470" class="CatchallClause"> </a><a id="6471" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6471" class="CatchallClause Bound">currentAddr</a><a id="6482" class="CatchallClause"> </a><a id="6483" class="CatchallClause Symbol">(</a><a id="6484" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1308" class="CatchallClause InductiveConstructor">exec</a><a id="6488" class="CatchallClause"> </a><a id="6489" class="CatchallClause Symbol">(</a><a id="6490" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#546" class="CatchallClause InductiveConstructor">transferc</a><a id="6499" class="CatchallClause"> </a><a id="6500" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6500" class="CatchallClause Bound">amount</a><a id="6506" class="CatchallClause"> </a><a id="6507" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6507" class="CatchallClause Bound">destinationAddr</a><a id="6522" class="CatchallClause"> </a><a id="6523" class="CatchallClause Symbol">)</a><a id="6524" class="CatchallClause"> </a><a id="6525" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6525" class="CatchallClause Bound">cont</a><a id="6529" class="CatchallClause Symbol">))</a>
       <a id="6539" class="Symbol">=</a> <a id="6541" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4315" class="Function">executeTransfer</a> <a id="6557" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6414" class="Bound">oldLedger</a> <a id="6567" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6433" class="Bound">currentLedger</a> <a id="6581" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6447" class="Bound">executionStack</a> <a id="6596" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6462" class="Bound">callAddr</a> <a id="6605" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6471" class="Bound">currentAddr</a> <a id="6617" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6500" class="Bound">amount</a> <a id="6624" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6507" class="Bound">destinationAddr</a> <a id="6640" class="Symbol">(</a><a id="6641" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6525" class="Bound">cont</a> <a id="6646" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a><a id="6648" class="Symbol">)</a>
<a id="6650" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4954" class="CatchallClause Function">stepEF</a><a id="6656" class="CatchallClause"> </a><a id="6657" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6657" class="CatchallClause Bound">oldLedger</a><a id="6666" class="CatchallClause"> </a><a id="6667" class="CatchallClause Symbol">(</a><a id="6668" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2035" class="CatchallClause InductiveConstructor">stateEF</a><a id="6675" class="CatchallClause"> </a><a id="6676" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6676" class="CatchallClause Bound">currentLedger</a><a id="6689" class="CatchallClause"> </a><a id="6690" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6690" class="CatchallClause Bound">executionStack</a><a id="6704" class="CatchallClause"> </a><a id="6705" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6705" class="CatchallClause Bound">callAddr</a><a id="6713" class="CatchallClause"> </a><a id="6714" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6714" class="CatchallClause Bound">currentAddr</a><a id="6725" class="CatchallClause"> </a><a id="6726" class="CatchallClause Symbol">(</a><a id="6727" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1308" class="CatchallClause InductiveConstructor">exec</a><a id="6731" class="CatchallClause"> </a><a id="6732" class="CatchallClause Symbol">(</a><a id="6733" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#795" class="CatchallClause InductiveConstructor">getAmountc</a><a id="6743" class="CatchallClause">  </a><a id="6745" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6745" class="CatchallClause Bound">addrLookedUp</a><a id="6757" class="CatchallClause Symbol">)</a><a id="6758" class="CatchallClause"> </a><a id="6759" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6759" class="CatchallClause Bound">cont</a><a id="6763" class="CatchallClause Symbol">))</a>
       <a id="6773" class="Symbol">=</a> <a id="6775" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2035" class="InductiveConstructor">stateEF</a> <a id="6783" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6676" class="Bound">currentLedger</a> <a id="6797" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6690" class="Bound">executionStack</a> <a id="6812" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6705" class="Bound">callAddr</a> <a id="6821" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6714" class="Bound">currentAddr</a> <a id="6833" class="Symbol">(</a><a id="6834" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6759" class="Bound">cont</a> <a id="6839" class="Symbol">(</a><a id="6840" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6676" class="Bound">currentLedger</a> <a id="6854" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6745" class="Bound">addrLookedUp</a> <a id="6867" class="Symbol">.</a><a id="6868" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1495" class="Field">amount</a><a id="6874" class="Symbol">))</a>
<a id="6877" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4954" class="CatchallClause Function">stepEF</a><a id="6883" class="CatchallClause"> </a><a id="6884" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6884" class="CatchallClause Bound">oldLedger</a><a id="6893" class="CatchallClause"> </a><a id="6894" class="CatchallClause Symbol">(</a><a id="6895" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2035" class="CatchallClause InductiveConstructor">stateEF</a><a id="6902" class="CatchallClause"> </a><a id="6903" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6903" class="CatchallClause Bound">currentLedger</a><a id="6916" class="CatchallClause"> </a><a id="6917" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6917" class="CatchallClause Bound">executionStack</a><a id="6931" class="CatchallClause"> </a><a id="6932" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6932" class="CatchallClause Bound">callAddr</a><a id="6940" class="CatchallClause"> </a><a id="6941" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6941" class="CatchallClause Bound">currentAddr</a><a id="6952" class="CatchallClause"> </a><a id="6953" class="CatchallClause Symbol">(</a><a id="6954" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1266" class="CatchallClause InductiveConstructor">error</a><a id="6959" class="CatchallClause"> </a><a id="6960" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6960" class="CatchallClause Bound">errorMsg</a><a id="6968" class="CatchallClause Symbol">))</a>
       <a id="6978" class="Symbol">=</a> <a id="6980" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2035" class="InductiveConstructor">stateEF</a> <a id="6988" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6884" class="Bound">oldLedger</a> <a id="6998" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6917" class="Bound">executionStack</a> <a id="7013" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6932" class="Bound">callAddr</a> <a id="7022" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6941" class="Bound">currentAddr</a> <a id="7034" class="Symbol">(</a><a id="7035" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1266" class="InductiveConstructor">error</a> <a id="7041" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6960" class="Bound">errorMsg</a><a id="7049" class="Symbol">)</a>



<a id="7054" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5000" class="Function">stepEFntimes</a> <a id="7067" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7067" class="Bound">oldLedger</a> <a id="7077" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7077" class="Bound">ledgerstateexecfun</a> <a id="7096" class="Number">0</a>
             <a id="7111" class="Symbol">=</a> <a id="7113" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7077" class="Bound">ledgerstateexecfun</a>
<a id="7132" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5000" class="Function">stepEFntimes</a> <a id="7145" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7145" class="Bound">oldLedger</a> <a id="7155" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7155" class="Bound">ledgerstateexecfun</a> <a id="7174" class="Symbol">(</a><a id="7175" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="7179" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7179" class="Bound">n</a><a id="7180" class="Symbol">)</a>
      <a id="7188" class="Symbol">=</a> <a id="7190" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4954" class="Function">stepEF</a> <a id="7197" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7145" class="Bound">oldLedger</a> <a id="7207" class="Symbol">(</a><a id="7208" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5000" class="Function">stepEFntimes</a> <a id="7221" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7145" class="Bound">oldLedger</a> <a id="7231" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7155" class="Bound">ledgerstateexecfun</a> <a id="7250" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7179" class="Bound">n</a><a id="7251" class="Symbol">)</a>


<a id="7255" class="Comment">--define step ledger ntimes</a>
<a id="stepLedgerFunntimes"></a><a id="7283" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7283" class="Function">stepLedgerFunntimes</a> <a id="7303" class="Symbol">:</a> <a id="7305" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1621" class="Function">Ledger</a> <a id="7312" class="Symbol">→</a> <a id="7314" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#636" class="Function">Address</a>
        <a id="7330" class="Symbol">→</a> <a id="7332" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#636" class="Function">Address</a> <a id="7340" class="Symbol">→</a> <a id="7342" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#223" class="Function">FunctionName</a>
        <a id="7363" class="Symbol">→</a> <a id="7365" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#369" class="Datatype">Msg</a> <a id="7369" class="Symbol">→</a> <a id="7371" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="7373" class="Symbol">→</a> <a id="7375" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1996" class="Record">StateExecFun</a>
<a id="7388" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7283" class="Function">stepLedgerFunntimes</a> <a id="7408" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7408" class="Bound">ledger</a> <a id="7415" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7415" class="Bound">callAddr</a> <a id="7424" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7424" class="Bound">currentAddr</a> <a id="7436" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7436" class="Bound">funname</a> <a id="7444" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7444" class="Bound">msg</a> <a id="7448" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7448" class="Bound">n</a>
        <a id="7458" class="Symbol">=</a> <a id="7460" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5000" class="Function">stepEFntimes</a> <a id="7473" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7408" class="Bound">ledger</a> <a id="7480" class="Symbol">(</a><a id="7481" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2035" class="InductiveConstructor">stateEF</a> <a id="7489" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7408" class="Bound">ledger</a> <a id="7496" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="7499" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7415" class="Bound">callAddr</a> <a id="7508" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7424" class="Bound">currentAddr</a>
        <a id="7528" class="Symbol">(</a><a id="7529" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7408" class="Bound">ledger</a> <a id="7536" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7424" class="Bound">currentAddr</a> <a id="7548" class="Symbol">.</a><a id="7549" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1517" class="Field">fun</a> <a id="7553" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7436" class="Bound">funname</a> <a id="7561" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7444" class="Bound">msg</a><a id="7564" class="Symbol">))</a> <a id="7567" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7448" class="Bound">n</a>

<a id="7570" class="Comment">--define stepef ledger list</a>
<a id="stepLedgerFunntimesList"></a><a id="7598" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7598" class="Function">stepLedgerFunntimesList</a> <a id="7622" class="Symbol">:</a> <a id="7624" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1621" class="Function">Ledger</a> <a id="7631" class="Symbol">→</a> <a id="7633" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#636" class="Function">Address</a>
                          <a id="7667" class="Symbol">→</a>  <a id="7670" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#636" class="Function">Address</a> <a id="7678" class="Symbol">→</a> <a id="7680" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#223" class="Function">FunctionName</a>
                          <a id="7719" class="Symbol">→</a> <a id="7721" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#369" class="Datatype">Msg</a> <a id="7725" class="Symbol">→</a> <a id="7727" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="7729" class="Symbol">→</a> <a id="7731" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="7736" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1996" class="Record">StateExecFun</a>
<a id="7749" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7598" class="Function">stepLedgerFunntimesList</a> <a id="7773" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7773" class="Bound">ledger</a> <a id="7780" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7780" class="Bound">callAddr</a> <a id="7789" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7789" class="Bound">currentAddr</a> <a id="7801" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7801" class="Bound">funname</a> <a id="7809" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7809" class="Bound">msg</a> <a id="7813" class="Number">0</a> <a id="7815" class="Symbol">=</a> <a id="7817" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="7820" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7598" class="Function">stepLedgerFunntimesList</a> <a id="7844" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7844" class="Bound">ledger</a> <a id="7851" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7851" class="Bound">callAddr</a> <a id="7860" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7860" class="Bound">currentAddr</a> <a id="7872" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7872" class="Bound">funname</a> <a id="7880" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7880" class="Bound">msg</a> <a id="7884" class="Symbol">(</a><a id="7885" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="7889" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7889" class="Bound">n</a><a id="7890" class="Symbol">)</a>
        <a id="7900" class="Symbol">=</a> <a id="7902" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7283" class="Function">stepLedgerFunntimes</a> <a id="7922" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7844" class="Bound">ledger</a> <a id="7929" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7851" class="Bound">callAddr</a> <a id="7938" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7860" class="Bound">currentAddr</a> <a id="7950" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7872" class="Bound">funname</a> <a id="7958" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7880" class="Bound">msg</a> <a id="7962" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7889" class="Bound">n</a> <a id="7964" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="7976" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7598" class="Function">stepLedgerFunntimesList</a> <a id="8000" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7844" class="Bound">ledger</a> <a id="8007" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7851" class="Bound">callAddr</a> <a id="8016" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7860" class="Bound">currentAddr</a> <a id="8028" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7872" class="Bound">funname</a> <a id="8036" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7880" class="Bound">msg</a> <a id="8040" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7889" class="Bound">n</a>



<a id="8045" class="Symbol">{-#</a> <a id="8049" class="Keyword">NON_TERMINATING</a> <a id="8065" class="Symbol">#-}</a>

<a id="evaluateNonTerminatingAux"></a><a id="8070" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8070" class="Function">evaluateNonTerminatingAux</a> <a id="8096" class="Symbol">:</a> <a id="8098" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1621" class="Function">Ledger</a> <a id="8105" class="Symbol">→</a> <a id="8107" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1996" class="Record">StateExecFun</a> <a id="8120" class="Symbol">→</a> <a id="8122" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#757" class="Datatype">NatOrError</a>
<a id="8133" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8070" class="Function">evaluateNonTerminatingAux</a> <a id="8159" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8159" class="Bound">oldledger</a> <a id="8169" class="Symbol">(</a><a id="8170" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2035" class="InductiveConstructor">stateEF</a> <a id="8178" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8178" class="Bound">currentLedger</a> <a id="8192" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="8195" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8195" class="Bound">callAddr</a> <a id="8204" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8204" class="Bound">currentAddr</a> <a id="8216" class="Symbol">(</a><a id="8217" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1231" class="InductiveConstructor">return</a> <a id="8224" class="Symbol">(</a><a id="8225" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#388" class="InductiveConstructor">nat</a> <a id="8229" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8229" class="Bound">n</a><a id="8230" class="Symbol">)))</a> <a id="8234" class="Symbol">=</a> <a id="8236" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#781" class="InductiveConstructor">nat</a> <a id="8240" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8229" class="Bound">n</a>
<a id="8242" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8070" class="CatchallClause Function">evaluateNonTerminatingAux</a><a id="8267" class="CatchallClause"> </a><a id="8268" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8268" class="CatchallClause Bound">oldledger</a><a id="8277" class="CatchallClause"> </a><a id="8278" class="CatchallClause Symbol">(</a><a id="8279" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2035" class="CatchallClause InductiveConstructor">stateEF</a><a id="8286" class="CatchallClause"> </a><a id="8287" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8287" class="CatchallClause Bound">currentLedger</a><a id="8300" class="CatchallClause"> </a><a id="8301" href="Agda.Builtin.List.html#184" class="CatchallClause InductiveConstructor">[]</a><a id="8303" class="CatchallClause"> </a><a id="8304" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8304" class="CatchallClause Bound">callAddr</a><a id="8312" class="CatchallClause"> </a><a id="8313" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8313" class="CatchallClause Bound">currentAddr</a><a id="8324" class="CatchallClause"> </a><a id="8325" class="CatchallClause Symbol">(</a><a id="8326" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1231" class="CatchallClause InductiveConstructor">return</a><a id="8332" class="CatchallClause"> </a><a id="8333" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8333" class="CatchallClause Bound">otherwise</a><a id="8342" class="CatchallClause Symbol">))</a> <a id="8345" class="Symbol">=</a> <a id="8347" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#803" class="InductiveConstructor">err</a> <a id="8351" class="Symbol">(</a><a id="8352" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#551" class="InductiveConstructor">strErr</a> <a id="8359" class="String">&quot;result returned not nat&quot;</a><a id="8384" class="Symbol">)</a>
<a id="8386" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8070" class="CatchallClause Function">evaluateNonTerminatingAux</a><a id="8411" class="CatchallClause"> </a><a id="8412" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8412" class="CatchallClause Bound">oldledger</a><a id="8421" class="CatchallClause"> </a><a id="8422" class="CatchallClause Symbol">(</a><a id="8423" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2035" class="CatchallClause InductiveConstructor">stateEF</a><a id="8430" class="CatchallClause"> </a><a id="8431" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8431" class="CatchallClause Bound">currentLedger</a><a id="8444" class="CatchallClause"> </a><a id="8445" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8445" class="CatchallClause Bound">s</a><a id="8446" class="CatchallClause"> </a><a id="8447" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8447" class="CatchallClause Bound">callAddr</a><a id="8455" class="CatchallClause"> </a><a id="8456" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8456" class="CatchallClause Bound">currentAddr</a><a id="8467" class="CatchallClause"> </a><a id="8468" class="CatchallClause Symbol">(</a><a id="8469" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1266" class="CatchallClause InductiveConstructor">error</a><a id="8474" class="CatchallClause"> </a><a id="8475" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8475" class="CatchallClause Bound">msg</a><a id="8478" class="CatchallClause Symbol">))</a> <a id="8481" class="Symbol">=</a> <a id="8483" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#803" class="InductiveConstructor">err</a> <a id="8487" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8475" class="Bound">msg</a>
<a id="8491" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8070" class="CatchallClause Function">evaluateNonTerminatingAux</a><a id="8516" class="CatchallClause"> </a><a id="8517" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8517" class="CatchallClause Bound">oldledger</a><a id="8526" class="CatchallClause"> </a><a id="8527" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8527" class="CatchallClause Bound">state</a> <a id="8533" class="Symbol">=</a> <a id="8535" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8070" class="Function">evaluateNonTerminatingAux</a> <a id="8561" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8517" class="Bound">oldledger</a> <a id="8571" class="Symbol">(</a><a id="8572" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4954" class="Function">stepEF</a>  <a id="8580" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8517" class="Bound">oldledger</a> <a id="8590" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8527" class="Bound">state</a><a id="8595" class="Symbol">)</a>

<a id="evaluateNonTerminating"></a><a id="8598" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8598" class="Function">evaluateNonTerminating</a> <a id="8621" class="Symbol">:</a> <a id="8623" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1621" class="Function">Ledger</a> <a id="8630" class="Symbol">→</a> <a id="8632" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#636" class="Function">Address</a> <a id="8640" class="Symbol">→</a>  <a id="8643" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#636" class="Function">Address</a> <a id="8651" class="Symbol">→</a> <a id="8653" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#223" class="Function">FunctionName</a> <a id="8666" class="Symbol">→</a> <a id="8668" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#369" class="Datatype">Msg</a> <a id="8672" class="Symbol">→</a> <a id="8674" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#757" class="Datatype">NatOrError</a>
<a id="8685" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8598" class="Function">evaluateNonTerminating</a> <a id="8708" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8708" class="Bound">ledger</a> <a id="8715" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8715" class="Bound">callAddr</a> <a id="8724" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8724" class="Bound">currentAddr</a>  <a id="8737" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8737" class="Bound">funname</a> <a id="8745" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8745" class="Bound">msg</a> <a id="8749" class="Symbol">=</a>  <a id="8752" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8070" class="Function">evaluateNonTerminatingAux</a> <a id="8778" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8708" class="Bound">ledger</a> <a id="8785" class="Symbol">(</a><a id="8786" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2035" class="InductiveConstructor">stateEF</a> <a id="8794" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8708" class="Bound">ledger</a> <a id="8801" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="8804" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8715" class="Bound">callAddr</a> <a id="8813" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8724" class="Bound">currentAddr</a> <a id="8825" class="Symbol">(</a><a id="8826" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8708" class="Bound">ledger</a> <a id="8833" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8724" class="Bound">currentAddr</a> <a id="8845" class="Symbol">.</a><a id="8846" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1517" class="Field">fun</a> <a id="8850" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8737" class="Bound">funname</a> <a id="8858" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8745" class="Bound">msg</a><a id="8861" class="Symbol">))</a>
</pre></body></html>