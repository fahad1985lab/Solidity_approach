<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>libraries.Mainlibrary</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="constantparameters.html" class="Module">constantparameters</a>

<a id="33" class="Keyword">module</a> <a id="40" href="libraries.Mainlibrary.html" class="Module">libraries.Mainlibrary</a> <a id="62" class="Keyword">where</a>

<a id="69" class="Keyword">open</a> <a id="74" class="Keyword">import</a> <a id="81" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="90" class="Keyword">open</a> <a id="95" class="Keyword">import</a> <a id="102" href="Data.List.html" class="Module">Data.List</a> <a id="112" class="Keyword">hiding</a> <a id="119" class="Symbol">(</a><a id="120" href="Data.List.Base.html#1954" class="Function Operator">_++_</a><a id="124" class="Symbol">)</a>
<a id="126" class="Keyword">open</a> <a id="131" class="Keyword">import</a> <a id="138" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a> <a id="155" class="Keyword">using</a> <a id="161" class="Symbol">(</a><a id="162" href="Agda.Builtin.Nat.html#426" class="Primitive Operator">_-_</a><a id="165" class="Symbol">;</a> <a id="167" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">_*_</a><a id="170" class="Symbol">)</a>
<a id="172" class="Keyword">open</a> <a id="177" class="Keyword">import</a> <a id="184" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="194" class="Keyword">open</a> <a id="199" class="Keyword">import</a> <a id="206" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="216" class="Keyword">open</a> <a id="221" class="Keyword">import</a> <a id="228" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>
<a id="243" class="Keyword">open</a> <a id="248" class="Keyword">import</a> <a id="255" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="269" class="Keyword">open</a> <a id="274" class="Keyword">import</a> <a id="281" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="292" class="Keyword">hiding</a> <a id="299" class="Symbol">(</a><a id="300" href="Data.Maybe.Base.html#2256" class="Function Operator">_&gt;&gt;=_</a><a id="305" class="Symbol">)</a>
<a id="307" class="Keyword">open</a> <a id="312" class="Keyword">import</a> <a id="319" href="Data.String.html" class="Module">Data.String</a> <a id="331" class="Keyword">hiding</a> <a id="338" class="Symbol">(</a><a id="339" href="Data.String.Base.html#2468" class="Function">length</a><a id="345" class="Symbol">;</a><a id="346" href="Data.String.Base.html#1605" class="Primitive">show</a><a id="350" class="Symbol">)</a>
<a id="352" class="Keyword">open</a> <a id="357" class="Keyword">import</a> <a id="364" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a>
<a id="378" class="Keyword">open</a> <a id="383" class="Keyword">import</a> <a id="390" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a> <a id="406" class="Symbol">as</a> <a id="409" class="Module">Maybe</a> <a id="415" class="Keyword">using</a> <a id="421" class="Symbol">(</a><a id="422" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a><a id="427" class="Symbol">;</a> <a id="429" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="436" class="Symbol">;</a> <a id="438" href="Data.Maybe.Base.html#2379" class="Function Operator">_&lt;∣&gt;_</a><a id="443" class="Symbol">;</a> <a id="445" href="Data.Maybe.Base.html#2494" class="Function">when</a><a id="449" class="Symbol">)</a>
<a id="451" class="Keyword">open</a> <a id="456" class="Keyword">import</a> <a id="463" href="Data.Maybe.Effectful.html" class="Module">Data.Maybe.Effectful</a>
<a id="484" class="Keyword">open</a> <a id="489" class="Keyword">import</a> <a id="496" href="Data.Product.html" class="Module">Data.Product</a> <a id="509" class="Keyword">renaming</a> <a id="518" class="Symbol">(</a><a id="519" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a> <a id="523" class="Symbol">to</a> <a id="526" class="InductiveConstructor Operator">_,,_</a> <a id="531" class="Symbol">)</a>
<a id="533" class="Keyword">open</a> <a id="538" class="Keyword">import</a> <a id="545" href="Agda.Builtin.String.html" class="Module">Agda.Builtin.String</a>

<a id="566" class="Comment">--our work</a>
<a id="577" class="Keyword">open</a> <a id="582" class="Keyword">import</a> <a id="589" href="basicDataStructure.html" class="Module">basicDataStructure</a>
<a id="608" class="Keyword">open</a> <a id="613" class="Keyword">import</a> <a id="620" href="libraries.natCompare.html" class="Module">libraries.natCompare</a>
<a id="641" class="Keyword">open</a> <a id="646" class="Keyword">import</a> <a id="653" href="Complex-Model.ccomand.ccommands-cresponse.html" class="Module">Complex-Model.ccomand.ccommands-cresponse</a>


<a id="697" class="Comment">--define contract in complex model</a>
<a id="732" class="Keyword">record</a> <a id="Contract"></a><a id="739" href="libraries.Mainlibrary.html#739" class="Record">Contract</a> <a id="748" class="Symbol">:</a> <a id="750" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="754" class="Keyword">where</a>
  <a id="762" class="Keyword">constructor</a> <a id="contract"></a><a id="774" href="libraries.Mainlibrary.html#774" class="InductiveConstructor">contract</a>
  <a id="785" class="Keyword">field</a>
    <a id="Contract.amount"></a><a id="795" href="libraries.Mainlibrary.html#795" class="Field">amount</a> <a id="802" class="Symbol">:</a> <a id="804" href="basicDataStructure.html#361" class="Function">Amount</a>
    <a id="Contract.fun"></a><a id="815" href="libraries.Mainlibrary.html#815" class="Field">fun</a>    <a id="822" class="Symbol">:</a> <a id="824" href="basicDataStructure.html#172" class="Function">FunctionName</a> <a id="837" class="Symbol">→</a> <a id="839" class="Symbol">(</a><a id="840" href="basicDataStructure.html#489" class="Datatype">Msg</a> <a id="844" class="Symbol">→</a> <a id="846" href="Complex-Model.ccomand.ccommands-cresponse.html#1444" class="Datatype">SmartContract</a> <a id="860" href="basicDataStructure.html#489" class="Datatype">Msg</a><a id="863" class="Symbol">)</a>
    <a id="Contract.viewFunction"></a><a id="869" href="libraries.Mainlibrary.html#869" class="Field">viewFunction</a> <a id="882" class="Symbol">:</a> <a id="884" href="basicDataStructure.html#172" class="Function">FunctionName</a> <a id="897" class="Symbol">→</a> <a id="899" href="basicDataStructure.html#489" class="Datatype">Msg</a> <a id="903" class="Symbol">→</a> <a id="905" href="basicDataStructure.html#1381" class="Datatype">MsgOrError</a>
    <a id="Contract.viewFunctionCost"></a><a id="920" href="libraries.Mainlibrary.html#920" class="Field">viewFunctionCost</a> <a id="937" class="Symbol">:</a> <a id="939" href="basicDataStructure.html#172" class="Function">FunctionName</a> <a id="952" class="Symbol">→</a> <a id="954" href="basicDataStructure.html#489" class="Datatype">Msg</a> <a id="958" class="Symbol">→</a> <a id="960" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="962" class="Keyword">open</a> <a id="967" href="libraries.Mainlibrary.html#739" class="Module">Contract</a> <a id="976" class="Keyword">public</a>

<a id="984" class="Comment">--define ledger</a>
<a id="Ledger"></a><a id="1000" href="libraries.Mainlibrary.html#1000" class="Function">Ledger</a> <a id="1007" class="Symbol">:</a> <a id="1009" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="1013" href="libraries.Mainlibrary.html#1000" class="Function">Ledger</a> <a id="1020" class="Symbol">=</a> <a id="1022" href="basicDataStructure.html#388" class="Function">Address</a>  <a id="1031" class="Symbol">→</a> <a id="1033" href="libraries.Mainlibrary.html#739" class="Record">Contract</a>



<a id="1045" class="Comment">--define execute stack element</a>
<a id="1076" class="Keyword">record</a> <a id="ExecStackEl"></a><a id="1083" href="libraries.Mainlibrary.html#1083" class="Record">ExecStackEl</a> <a id="1095" class="Symbol">:</a> <a id="1097" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1101" class="Keyword">where</a>
  <a id="1109" class="Keyword">constructor</a> <a id="execStackEl"></a><a id="1121" href="libraries.Mainlibrary.html#1121" class="InductiveConstructor">execStackEl</a>
  <a id="1135" class="Keyword">field</a>
    <a id="ExecStackEl.lastCallAddress"></a><a id="1145" href="libraries.Mainlibrary.html#1145" class="Field">lastCallAddress</a> <a id="1161" class="Symbol">:</a> <a id="1163" href="basicDataStructure.html#388" class="Function">Address</a>
    <a id="ExecStackEl.calledAddress"></a><a id="1175" href="libraries.Mainlibrary.html#1175" class="Field">calledAddress</a>   <a id="1191" class="Symbol">:</a> <a id="1193" href="basicDataStructure.html#388" class="Function">Address</a>
    <a id="ExecStackEl.continuation"></a><a id="1205" href="libraries.Mainlibrary.html#1205" class="Field">continuation</a> <a id="1218" class="Symbol">:</a> <a id="1220" class="Symbol">(</a><a id="1221" href="basicDataStructure.html#489" class="Datatype">Msg</a> <a id="1225" class="Symbol">→</a> <a id="1227" href="Complex-Model.ccomand.ccommands-cresponse.html#1444" class="Datatype">SmartContract</a> <a id="1241" href="basicDataStructure.html#489" class="Datatype">Msg</a><a id="1244" class="Symbol">)</a>
    <a id="ExecStackEl.costCont"></a><a id="1250" href="libraries.Mainlibrary.html#1250" class="Field">costCont</a>     <a id="1263" class="Symbol">:</a> <a id="1265" href="basicDataStructure.html#489" class="Datatype">Msg</a> <a id="1269" class="Symbol">→</a> <a id="1271" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
    <a id="ExecStackEl.funcNameexecStackEl"></a><a id="1277" href="libraries.Mainlibrary.html#1277" class="Field">funcNameexecStackEl</a> <a id="1297" class="Symbol">:</a> <a id="1299" href="basicDataStructure.html#172" class="Function">FunctionName</a>
    <a id="ExecStackEl.msgexecStackEl"></a><a id="1316" href="libraries.Mainlibrary.html#1316" class="Field">msgexecStackEl</a>      <a id="1336" class="Symbol">:</a> <a id="1338" href="basicDataStructure.html#489" class="Datatype">Msg</a>
<a id="1342" class="Keyword">open</a> <a id="1347" href="libraries.Mainlibrary.html#1083" class="Module">ExecStackEl</a> <a id="1359" class="Keyword">public</a>


<a id="ExecutionStack"></a><a id="1368" href="libraries.Mainlibrary.html#1368" class="Function">ExecutionStack</a> <a id="1383" class="Symbol">:</a> <a id="1385" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="1389" href="libraries.Mainlibrary.html#1368" class="Function">ExecutionStack</a> <a id="1404" class="Symbol">=</a> <a id="1406" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1411" href="libraries.Mainlibrary.html#1083" class="Record">ExecStackEl</a>




<a id="1427" class="Comment">--define state execution function</a>
<a id="1461" class="Keyword">record</a> <a id="StateExecFun"></a><a id="1468" href="libraries.Mainlibrary.html#1468" class="Record">StateExecFun</a> <a id="1481" class="Symbol">:</a> <a id="1483" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1487" class="Keyword">where</a>
  <a id="1495" class="Keyword">constructor</a> <a id="stateEF"></a><a id="1507" href="libraries.Mainlibrary.html#1507" class="InductiveConstructor">stateEF</a>
  <a id="1517" class="Keyword">field</a>
    <a id="StateExecFun.ledger"></a><a id="1527" href="libraries.Mainlibrary.html#1527" class="Field">ledger</a>         <a id="1542" class="Symbol">:</a> <a id="1544" href="libraries.Mainlibrary.html#1000" class="Function">Ledger</a>
    <a id="StateExecFun.executionStack"></a><a id="1555" href="libraries.Mainlibrary.html#1555" class="Field">executionStack</a> <a id="1570" class="Symbol">:</a> <a id="1572" href="libraries.Mainlibrary.html#1368" class="Function">ExecutionStack</a>
    <a id="StateExecFun.initialAddr"></a><a id="1591" href="libraries.Mainlibrary.html#1591" class="Field">initialAddr</a>    <a id="1606" class="Symbol">:</a> <a id="1608" href="basicDataStructure.html#388" class="Function">Address</a>
    <a id="StateExecFun.lastCallAddr"></a><a id="1620" href="libraries.Mainlibrary.html#1620" class="Field">lastCallAddr</a>   <a id="1635" class="Symbol">:</a> <a id="1637" href="basicDataStructure.html#388" class="Function">Address</a>
    <a id="StateExecFun.calledAddr"></a><a id="1649" href="libraries.Mainlibrary.html#1649" class="Field">calledAddr</a>     <a id="1664" class="Symbol">:</a> <a id="1666" href="basicDataStructure.html#388" class="Function">Address</a>
    <a id="StateExecFun.nextstep"></a><a id="1678" href="libraries.Mainlibrary.html#1678" class="Field">nextstep</a>       <a id="1693" class="Symbol">:</a> <a id="1695" href="Complex-Model.ccomand.ccommands-cresponse.html#1444" class="Datatype">SmartContract</a> <a id="1709" href="basicDataStructure.html#489" class="Datatype">Msg</a>
    <a id="StateExecFun.gasLeft"></a><a id="1717" href="libraries.Mainlibrary.html#1717" class="Field">gasLeft</a>        <a id="1732" class="Symbol">:</a> <a id="1734" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
    <a id="StateExecFun.funNameevalState"></a><a id="1740" href="libraries.Mainlibrary.html#1740" class="Field">funNameevalState</a> <a id="1757" class="Symbol">:</a> <a id="1759" href="basicDataStructure.html#172" class="Function">FunctionName</a>
    <a id="StateExecFun.msgevalState"></a><a id="1776" href="libraries.Mainlibrary.html#1776" class="Field">msgevalState</a>   <a id="1791" class="Symbol">:</a> <a id="1793" href="basicDataStructure.html#489" class="Datatype">Msg</a>
<a id="1797" class="Keyword">open</a> <a id="1802" href="libraries.Mainlibrary.html#1468" class="Module">StateExecFun</a> <a id="1815" class="Keyword">public</a>

</pre></body></html>