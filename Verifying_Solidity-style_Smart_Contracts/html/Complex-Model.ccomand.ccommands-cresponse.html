<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Complex-Model.ccomand.ccommands-cresponse</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Complex-Model.ccomand.ccommands-cresponse.html" class="Module">Complex-Model.ccomand.ccommands-cresponse</a> <a id="50" class="Keyword">where</a>

<a id="57" class="Keyword">open</a> <a id="62" class="Keyword">import</a> <a id="69" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="78" class="Keyword">open</a> <a id="83" class="Keyword">import</a> <a id="90" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a> <a id="107" class="Keyword">using</a> <a id="113" class="Symbol">(</a><a id="114" href="Agda.Builtin.Nat.html#426" class="Primitive Operator">_-_</a><a id="117" class="Symbol">)</a>
<a id="119" class="Keyword">open</a> <a id="124" class="Keyword">import</a> <a id="131" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="141" class="Keyword">open</a> <a id="146" class="Keyword">import</a> <a id="153" href="Data.List.html" class="Module">Data.List</a>
<a id="163" class="Keyword">open</a> <a id="168" class="Keyword">import</a> <a id="175" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="185" class="Keyword">open</a> <a id="190" class="Keyword">import</a> <a id="197" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>
<a id="212" class="Keyword">open</a> <a id="217" class="Keyword">import</a> <a id="224" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="238" class="Keyword">open</a> <a id="243" class="Keyword">import</a> <a id="250" href="Data.Maybe.html" class="Module">Data.Maybe</a>  <a id="262" class="Keyword">hiding</a> <a id="269" class="Symbol">(</a><a id="270" href="Data.Maybe.Base.html#2256" class="Function Operator">_&gt;&gt;=_</a><a id="275" class="Symbol">)</a>
<a id="277" class="Keyword">open</a> <a id="282" class="Keyword">import</a> <a id="289" href="Data.String.html" class="Module">Data.String</a> <a id="301" class="Keyword">hiding</a> <a id="308" class="Symbol">(</a><a id="309" href="Data.String.Base.html#2468" class="Function">length</a><a id="315" class="Symbol">)</a>
<a id="317" class="Keyword">open</a> <a id="322" class="Keyword">import</a> <a id="329" href="Data.Empty.html" class="Module">Data.Empty</a>


<a id="342" class="Comment">-- libraries</a>
<a id="355" class="Keyword">open</a> <a id="360" class="Keyword">import</a> <a id="367" href="basicDataStructure.html" class="Module">basicDataStructure</a>
<a id="386" class="Keyword">open</a> <a id="391" class="Keyword">import</a> <a id="398" href="libraries.natCompare.html" class="Module">libraries.natCompare</a>



<a id="422" class="Keyword">mutual</a>

<a id="430" class="Comment">--contract-command</a>
  <a id="451" class="Keyword">data</a> <a id="CCommands"></a><a id="456" href="Complex-Model.ccomand.ccommands-cresponse.html#456" class="Datatype">CCommands</a> <a id="466" class="Symbol">:</a> <a id="468" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="472" class="Keyword">where</a>
    <a id="CCommands.callView"></a><a id="482" href="Complex-Model.ccomand.ccommands-cresponse.html#482" class="InductiveConstructor">callView</a>   <a id="493" class="Symbol">:</a> <a id="495" href="basicDataStructure.html#388" class="Function">Address</a> <a id="503" class="Symbol">→</a> <a id="505" href="basicDataStructure.html#172" class="Function">FunctionName</a> <a id="518" class="Symbol">→</a> <a id="520" href="basicDataStructure.html#489" class="Datatype">Msg</a> <a id="524" class="Symbol">→</a> <a id="526" href="Complex-Model.ccomand.ccommands-cresponse.html#456" class="Datatype">CCommands</a>
    <a id="CCommands.updatec"></a><a id="540" href="Complex-Model.ccomand.ccommands-cresponse.html#540" class="InductiveConstructor">updatec</a>    <a id="551" class="Symbol">:</a> <a id="553" href="basicDataStructure.html#172" class="Function">FunctionName</a> <a id="566" class="Symbol">→</a> <a id="568" class="Symbol">((</a><a id="570" href="basicDataStructure.html#489" class="Datatype">Msg</a> <a id="574" class="Symbol">→</a> <a id="576" href="basicDataStructure.html#1381" class="Datatype">MsgOrError</a><a id="586" class="Symbol">)</a>
               <a id="603" class="Symbol">→</a> <a id="605" class="Symbol">(</a><a id="606" href="basicDataStructure.html#489" class="Datatype">Msg</a> <a id="610" class="Symbol">→</a> <a id="612" href="basicDataStructure.html#1381" class="Datatype">MsgOrError</a><a id="622" class="Symbol">))</a> <a id="625" class="Symbol">→</a> <a id="627" class="Symbol">((</a><a id="629" href="basicDataStructure.html#489" class="Datatype">Msg</a> <a id="633" class="Symbol">→</a> <a id="635" href="basicDataStructure.html#1381" class="Datatype">MsgOrError</a><a id="645" class="Symbol">)</a>
               <a id="662" class="Symbol">→</a> <a id="664" class="Symbol">(</a><a id="665" href="basicDataStructure.html#489" class="Datatype">Msg</a> <a id="669" class="Symbol">→</a> <a id="671" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="672" class="Symbol">)</a> <a id="674" class="Symbol">→</a> <a id="676" href="basicDataStructure.html#489" class="Datatype">Msg</a> <a id="680" class="Symbol">→</a> <a id="682" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="683" class="Symbol">)</a> <a id="685" class="Symbol">→</a> <a id="687" href="Complex-Model.ccomand.ccommands-cresponse.html#456" class="Datatype">CCommands</a>
    <a id="CCommands.raiseException"></a><a id="701" href="Complex-Model.ccomand.ccommands-cresponse.html#701" class="InductiveConstructor">raiseException</a> <a id="716" class="Symbol">:</a> <a id="718" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="720" class="Symbol">→</a> <a id="722" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="729" class="Symbol">→</a> <a id="731" href="Complex-Model.ccomand.ccommands-cresponse.html#456" class="Datatype">CCommands</a>
    <a id="CCommands.transferc"></a><a id="745" href="Complex-Model.ccomand.ccommands-cresponse.html#745" class="InductiveConstructor">transferc</a>  <a id="756" class="Symbol">:</a> <a id="758" href="basicDataStructure.html#361" class="Function">Amount</a> <a id="765" class="Symbol">→</a> <a id="767" href="basicDataStructure.html#388" class="Function">Address</a> <a id="775" class="Symbol">→</a> <a id="777" href="Complex-Model.ccomand.ccommands-cresponse.html#456" class="Datatype">CCommands</a>
    <a id="CCommands.callc"></a><a id="791" href="Complex-Model.ccomand.ccommands-cresponse.html#791" class="InductiveConstructor">callc</a>      <a id="802" class="Symbol">:</a> <a id="804" href="basicDataStructure.html#388" class="Function">Address</a> <a id="812" class="Symbol">→</a> <a id="814" href="basicDataStructure.html#172" class="Function">FunctionName</a> <a id="827" class="Symbol">→</a> <a id="829" href="basicDataStructure.html#489" class="Datatype">Msg</a> <a id="833" class="Symbol">→</a> <a id="835" href="Complex-Model.ccomand.ccommands-cresponse.html#456" class="Datatype">CCommands</a>
    <a id="CCommands.currentAddrLookupc"></a><a id="849" href="Complex-Model.ccomand.ccommands-cresponse.html#849" class="InductiveConstructor">currentAddrLookupc</a> <a id="868" class="Symbol">:</a> <a id="870" href="Complex-Model.ccomand.ccommands-cresponse.html#456" class="Datatype">CCommands</a>
    <a id="CCommands.callAddrLookupc"></a><a id="884" href="Complex-Model.ccomand.ccommands-cresponse.html#884" class="InductiveConstructor">callAddrLookupc</a> <a id="900" class="Symbol">:</a> <a id="902" href="Complex-Model.ccomand.ccommands-cresponse.html#456" class="Datatype">CCommands</a>
    <a id="CCommands.getAmountc"></a><a id="916" href="Complex-Model.ccomand.ccommands-cresponse.html#916" class="InductiveConstructor">getAmountc</a> <a id="927" class="Symbol">:</a> <a id="929" href="basicDataStructure.html#388" class="Function">Address</a> <a id="937" class="Symbol">→</a> <a id="939" href="Complex-Model.ccomand.ccommands-cresponse.html#456" class="Datatype">CCommands</a>



<a id="952" class="Comment">-- contract-response</a>
  <a id="CResponse"></a><a id="975" href="Complex-Model.ccomand.ccommands-cresponse.html#975" class="Function">CResponse</a> <a id="985" class="Symbol">:</a> <a id="987" href="Complex-Model.ccomand.ccommands-cresponse.html#456" class="Datatype">CCommands</a> <a id="997" class="Symbol">→</a> <a id="999" href="Agda.Primitive.html#388" class="Primitive">Set</a>
  <a id="1005" href="Complex-Model.ccomand.ccommands-cresponse.html#975" class="Function">CResponse</a> <a id="1015" class="Symbol">(</a><a id="1016" href="Complex-Model.ccomand.ccommands-cresponse.html#482" class="InductiveConstructor">callView</a> <a id="1025" href="Complex-Model.ccomand.ccommands-cresponse.html#1025" class="Bound">addr</a> <a id="1030" href="Complex-Model.ccomand.ccommands-cresponse.html#1030" class="Bound">fname</a> <a id="1036" href="Complex-Model.ccomand.ccommands-cresponse.html#1036" class="Bound">msg</a><a id="1039" class="Symbol">)</a>  <a id="1042" class="Symbol">=</a> <a id="1044" href="basicDataStructure.html#1381" class="Datatype">MsgOrError</a>
  <a id="1057" href="Complex-Model.ccomand.ccommands-cresponse.html#975" class="Function">CResponse</a> <a id="1067" class="Symbol">(</a><a id="1068" href="Complex-Model.ccomand.ccommands-cresponse.html#540" class="InductiveConstructor">updatec</a> <a id="1076" href="Complex-Model.ccomand.ccommands-cresponse.html#1076" class="Bound">fname</a> <a id="1082" href="Complex-Model.ccomand.ccommands-cresponse.html#1082" class="Bound">fdef</a> <a id="1087" href="Complex-Model.ccomand.ccommands-cresponse.html#1087" class="Bound">cost</a><a id="1091" class="Symbol">)</a>  <a id="1094" class="Symbol">=</a> <a id="1096" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="1100" href="Complex-Model.ccomand.ccommands-cresponse.html#975" class="Function">CResponse</a> <a id="1110" class="Symbol">(</a><a id="1111" href="Complex-Model.ccomand.ccommands-cresponse.html#701" class="InductiveConstructor">raiseException</a> <a id="1126" class="Symbol">_</a> <a id="1128" href="Complex-Model.ccomand.ccommands-cresponse.html#1128" class="Bound">str</a><a id="1131" class="Symbol">)</a>     <a id="1137" class="Symbol">=</a> <a id="1139" href="Data.Empty.html#895" class="Function">⊥</a>
  <a id="1143" href="Complex-Model.ccomand.ccommands-cresponse.html#975" class="Function">CResponse</a> <a id="1153" class="Symbol">(</a><a id="1154" href="Complex-Model.ccomand.ccommands-cresponse.html#745" class="InductiveConstructor">transferc</a> <a id="1164" href="Complex-Model.ccomand.ccommands-cresponse.html#1164" class="Bound">amount</a> <a id="1171" href="Complex-Model.ccomand.ccommands-cresponse.html#1171" class="Bound">addr</a><a id="1175" class="Symbol">)</a>   <a id="1179" class="Symbol">=</a> <a id="1181" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="1185" href="Complex-Model.ccomand.ccommands-cresponse.html#975" class="Function">CResponse</a> <a id="1195" class="Symbol">(</a><a id="1196" href="Complex-Model.ccomand.ccommands-cresponse.html#791" class="InductiveConstructor">callc</a> <a id="1202" href="Complex-Model.ccomand.ccommands-cresponse.html#1202" class="Bound">addr</a> <a id="1207" href="Complex-Model.ccomand.ccommands-cresponse.html#1207" class="Bound">fname</a> <a id="1213" href="Complex-Model.ccomand.ccommands-cresponse.html#1213" class="Bound">msg</a><a id="1216" class="Symbol">)</a>    <a id="1221" class="Symbol">=</a> <a id="1223" href="basicDataStructure.html#489" class="Datatype">Msg</a>
  <a id="1229" href="Complex-Model.ccomand.ccommands-cresponse.html#975" class="Function">CResponse</a> <a id="1239" href="Complex-Model.ccomand.ccommands-cresponse.html#849" class="InductiveConstructor">currentAddrLookupc</a> <a id="1258" class="Symbol">=</a> <a id="1260" href="basicDataStructure.html#388" class="Function">Address</a>
  <a id="1270" href="Complex-Model.ccomand.ccommands-cresponse.html#975" class="Function">CResponse</a> <a id="1280" href="Complex-Model.ccomand.ccommands-cresponse.html#884" class="InductiveConstructor">callAddrLookupc</a> <a id="1296" class="Symbol">=</a> <a id="1298" href="basicDataStructure.html#388" class="Function">Address</a>
  <a id="1308" href="Complex-Model.ccomand.ccommands-cresponse.html#975" class="Function">CResponse</a> <a id="1318" class="Symbol">(</a><a id="1319" href="Complex-Model.ccomand.ccommands-cresponse.html#916" class="InductiveConstructor">getAmountc</a> <a id="1330" href="Complex-Model.ccomand.ccommands-cresponse.html#1330" class="Bound">addr</a><a id="1334" class="Symbol">)</a> <a id="1336" class="Symbol">=</a> <a id="1338" href="basicDataStructure.html#361" class="Function">Amount</a>



<a id="1348" class="Comment">--SmartContract is datatype of what happens when a function is applied to its arguments.</a>
  <a id="1439" class="Keyword">data</a> <a id="SmartContract"></a><a id="1444" href="Complex-Model.ccomand.ccommands-cresponse.html#1444" class="Datatype">SmartContract</a> <a id="1458" class="Symbol">(</a><a id="1459" href="Complex-Model.ccomand.ccommands-cresponse.html#1459" class="Bound">A</a> <a id="1461" class="Symbol">:</a> <a id="1463" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="1466" class="Symbol">)</a> <a id="1468" class="Symbol">:</a> <a id="1470" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1474" class="Keyword">where</a>
    <a id="SmartContract.return"></a><a id="1484" href="Complex-Model.ccomand.ccommands-cresponse.html#1484" class="InductiveConstructor">return</a>  <a id="1492" class="Symbol">:</a>  <a id="1495" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="1497" class="Symbol">→</a> <a id="1499" href="Complex-Model.ccomand.ccommands-cresponse.html#1459" class="Bound">A</a> <a id="1501" class="Symbol">→</a> <a id="1503" href="Complex-Model.ccomand.ccommands-cresponse.html#1444" class="Datatype">SmartContract</a> <a id="1517" href="Complex-Model.ccomand.ccommands-cresponse.html#1459" class="Bound">A</a>
    <a id="SmartContract.error"></a><a id="1523" href="Complex-Model.ccomand.ccommands-cresponse.html#1523" class="InductiveConstructor">error</a>   <a id="1531" class="Symbol">:</a>  <a id="1534" href="basicDataStructure.html#623" class="Datatype">ErrorMsg</a> <a id="1543" class="Symbol">→</a> <a id="1545" href="basicDataStructure.html#789" class="Record">DebugInfo</a> <a id="1555" class="Symbol">→</a> <a id="1557" href="Complex-Model.ccomand.ccommands-cresponse.html#1444" class="Datatype">SmartContract</a> <a id="1571" href="Complex-Model.ccomand.ccommands-cresponse.html#1459" class="Bound">A</a>
    <a id="SmartContract.exec"></a><a id="1577" href="Complex-Model.ccomand.ccommands-cresponse.html#1577" class="InductiveConstructor">exec</a>    <a id="1585" class="Symbol">:</a>  <a id="1588" class="Symbol">(</a><a id="1589" href="Complex-Model.ccomand.ccommands-cresponse.html#1589" class="Bound">c</a> <a id="1591" class="Symbol">:</a> <a id="1593" href="Complex-Model.ccomand.ccommands-cresponse.html#456" class="Datatype">CCommands</a><a id="1602" class="Symbol">)</a> <a id="1604" class="Symbol">→</a> <a id="1606" class="Symbol">(</a><a id="1607" href="Complex-Model.ccomand.ccommands-cresponse.html#975" class="Function">CResponse</a> <a id="1617" href="Complex-Model.ccomand.ccommands-cresponse.html#1589" class="Bound">c</a> <a id="1619" class="Symbol">→</a> <a id="1621" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1622" class="Symbol">)</a>
            <a id="1636" class="Symbol">→</a> <a id="1638" class="Symbol">(</a><a id="1639" href="Complex-Model.ccomand.ccommands-cresponse.html#975" class="Function">CResponse</a> <a id="1649" href="Complex-Model.ccomand.ccommands-cresponse.html#1589" class="Bound">c</a> <a id="1651" class="Symbol">→</a> <a id="1653" href="Complex-Model.ccomand.ccommands-cresponse.html#1444" class="Datatype">SmartContract</a> <a id="1667" href="Complex-Model.ccomand.ccommands-cresponse.html#1459" class="Bound">A</a><a id="1668" class="Symbol">)</a>
            <a id="1682" class="Symbol">→</a> <a id="1684" href="Complex-Model.ccomand.ccommands-cresponse.html#1444" class="Datatype">SmartContract</a> <a id="1698" href="Complex-Model.ccomand.ccommands-cresponse.html#1459" class="Bound">A</a>



</pre></body></html>