<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Complex-Model.ccomand.ccommands-cresponse</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Complex-Model.ccomand.ccommands-cresponse.html" class="Module">Complex-Model.ccomand.ccommands-cresponse</a> <a id="50" class="Keyword">where</a>

<a id="57" class="Keyword">open</a> <a id="62" class="Keyword">import</a> <a id="69" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="78" class="Keyword">open</a> <a id="83" class="Keyword">import</a> <a id="90" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a> <a id="107" class="Keyword">using</a> <a id="113" class="Symbol">(</a><a id="114" href="Agda.Builtin.Nat.html#426" class="Primitive Operator">_-_</a><a id="117" class="Symbol">)</a>
<a id="119" class="Keyword">open</a> <a id="124" class="Keyword">import</a> <a id="131" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="141" class="Keyword">open</a> <a id="146" class="Keyword">import</a> <a id="153" href="Data.List.html" class="Module">Data.List</a>
<a id="163" class="Keyword">open</a> <a id="168" class="Keyword">import</a> <a id="175" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="185" class="Keyword">open</a> <a id="190" class="Keyword">import</a> <a id="197" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>
<a id="212" class="Keyword">open</a> <a id="217" class="Keyword">import</a> <a id="224" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="238" class="Keyword">open</a> <a id="243" class="Keyword">import</a> <a id="250" href="Data.Maybe.html" class="Module">Data.Maybe</a>  <a id="262" class="Keyword">hiding</a> <a id="269" class="Symbol">(</a><a id="270" href="Data.Maybe.Base.html#2256" class="Function Operator">_&gt;&gt;=_</a><a id="275" class="Symbol">)</a>
<a id="277" class="Keyword">open</a> <a id="282" class="Keyword">import</a> <a id="289" href="Data.String.html" class="Module">Data.String</a> <a id="301" class="Keyword">hiding</a> <a id="308" class="Symbol">(</a><a id="309" href="Data.String.Base.html#2468" class="Function">length</a><a id="315" class="Symbol">)</a>
<a id="317" class="Keyword">open</a> <a id="322" class="Keyword">import</a> <a id="329" href="Data.Empty.html" class="Module">Data.Empty</a>


<a id="342" class="Comment">-- libraries</a>
<a id="355" class="Keyword">open</a> <a id="360" class="Keyword">import</a> <a id="367" href="basicDataStructure.html" class="Module">basicDataStructure</a>
<a id="386" class="Keyword">open</a> <a id="391" class="Keyword">import</a> <a id="398" href="libraries.natCompare.html" class="Module">libraries.natCompare</a>




<a id="423" class="Keyword">mutual</a>
<a id="430" class="Comment">-- contract-commands:</a>

  <a id="455" class="Keyword">data</a> <a id="CCommands"></a><a id="460" href="Complex-Model.ccomand.ccommands-cresponse.html#460" class="Datatype">CCommands</a> <a id="470" class="Symbol">:</a> <a id="472" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="476" class="Keyword">where</a>
    <a id="CCommands.callc"></a><a id="486" href="Complex-Model.ccomand.ccommands-cresponse.html#486" class="InductiveConstructor">callc</a> <a id="492" class="Symbol">:</a> <a id="494" href="basicDataStructure.html#387" class="Function">Address</a> <a id="502" class="Symbol">→</a> <a id="504" href="basicDataStructure.html#173" class="Function">FunctionName</a> <a id="517" class="Symbol">→</a> <a id="519" href="basicDataStructure.html#511" class="Datatype">Msg</a> <a id="523" class="Symbol">→</a> <a id="525" href="basicDataStructure.html#360" class="Function">Amount</a> <a id="532" class="Symbol">→</a> <a id="534" href="Complex-Model.ccomand.ccommands-cresponse.html#460" class="Datatype">CCommands</a>
    <a id="CCommands.getTransferAmount"></a><a id="548" href="Complex-Model.ccomand.ccommands-cresponse.html#548" class="InductiveConstructor">getTransferAmount</a> <a id="566" class="Symbol">:</a> <a id="568" href="Complex-Model.ccomand.ccommands-cresponse.html#460" class="Datatype">CCommands</a>
    <a id="CCommands.eventc"></a><a id="582" href="Complex-Model.ccomand.ccommands-cresponse.html#582" class="InductiveConstructor">eventc</a> <a id="589" class="Symbol">:</a> <a id="591" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="598" class="Symbol">→</a> <a id="600" href="Complex-Model.ccomand.ccommands-cresponse.html#460" class="Datatype">CCommands</a>
    <a id="CCommands.callView"></a><a id="614" href="Complex-Model.ccomand.ccommands-cresponse.html#614" class="InductiveConstructor">callView</a>   <a id="625" class="Symbol">:</a> <a id="627" href="basicDataStructure.html#387" class="Function">Address</a> <a id="635" class="Symbol">→</a> <a id="637" href="basicDataStructure.html#173" class="Function">FunctionName</a> <a id="650" class="Symbol">→</a> <a id="652" href="basicDataStructure.html#511" class="Datatype">Msg</a> <a id="656" class="Symbol">→</a> <a id="658" href="Complex-Model.ccomand.ccommands-cresponse.html#460" class="Datatype">CCommands</a>
    <a id="CCommands.updatec"></a><a id="672" href="Complex-Model.ccomand.ccommands-cresponse.html#672" class="InductiveConstructor">updatec</a>    <a id="683" class="Symbol">:</a> <a id="685" href="basicDataStructure.html#173" class="Function">FunctionName</a> <a id="698" class="Symbol">→</a> <a id="700" class="Symbol">((</a><a id="702" href="basicDataStructure.html#511" class="Datatype">Msg</a> <a id="706" class="Symbol">→</a> <a id="708" href="basicDataStructure.html#1475" class="Datatype">MsgOrError</a><a id="718" class="Symbol">)</a> <a id="720" class="Symbol">→</a> <a id="722" class="Symbol">(</a><a id="723" href="basicDataStructure.html#511" class="Datatype">Msg</a> <a id="727" class="Symbol">→</a> <a id="729" href="basicDataStructure.html#1475" class="Datatype">MsgOrError</a><a id="739" class="Symbol">))</a>
               <a id="757" class="Symbol">→</a> <a id="759" class="Symbol">((</a><a id="761" href="basicDataStructure.html#511" class="Datatype">Msg</a> <a id="765" class="Symbol">→</a> <a id="767" href="basicDataStructure.html#1475" class="Datatype">MsgOrError</a><a id="777" class="Symbol">)</a> <a id="779" class="Symbol">→</a> <a id="781" class="Symbol">(</a><a id="782" href="basicDataStructure.html#511" class="Datatype">Msg</a> <a id="786" class="Symbol">→</a> <a id="788" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="789" class="Symbol">)</a> <a id="791" class="Symbol">→</a> <a id="793" href="basicDataStructure.html#511" class="Datatype">Msg</a> <a id="797" class="Symbol">→</a> <a id="799" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="800" class="Symbol">)</a> <a id="802" class="Symbol">→</a> <a id="804" href="Complex-Model.ccomand.ccommands-cresponse.html#460" class="Datatype">CCommands</a>
    <a id="CCommands.transferc"></a><a id="818" href="Complex-Model.ccomand.ccommands-cresponse.html#818" class="InductiveConstructor">transferc</a>  <a id="829" class="Symbol">:</a> <a id="831" href="basicDataStructure.html#360" class="Function">Amount</a> <a id="838" class="Symbol">→</a> <a id="840" href="basicDataStructure.html#387" class="Function">Address</a> <a id="848" class="Symbol">→</a> <a id="850" href="Complex-Model.ccomand.ccommands-cresponse.html#460" class="Datatype">CCommands</a>
    <a id="CCommands.transfercWithoutFallBack"></a><a id="864" href="Complex-Model.ccomand.ccommands-cresponse.html#864" class="InductiveConstructor">transfercWithoutFallBack</a>  <a id="890" class="Symbol">:</a> <a id="892" href="basicDataStructure.html#360" class="Function">Amount</a> <a id="899" class="Symbol">→</a> <a id="901" href="basicDataStructure.html#387" class="Function">Address</a> <a id="909" class="Symbol">→</a> <a id="911" href="Complex-Model.ccomand.ccommands-cresponse.html#460" class="Datatype">CCommands</a>    
    <a id="CCommands.callcAssumingTransferc"></a><a id="929" href="Complex-Model.ccomand.ccommands-cresponse.html#929" class="InductiveConstructor">callcAssumingTransferc</a> <a id="952" class="Symbol">:</a> <a id="954" href="basicDataStructure.html#387" class="Function">Address</a> <a id="962" class="Symbol">→</a> <a id="964" href="basicDataStructure.html#173" class="Function">FunctionName</a> <a id="977" class="Symbol">→</a> <a id="979" href="basicDataStructure.html#511" class="Datatype">Msg</a> <a id="983" class="Symbol">→</a> <a id="985" href="basicDataStructure.html#360" class="Function">Amount</a> <a id="992" class="Symbol">→</a> <a id="994" href="Complex-Model.ccomand.ccommands-cresponse.html#460" class="Datatype">CCommands</a> 
    <a id="CCommands.currentAddrLookupc"></a><a id="1009" href="Complex-Model.ccomand.ccommands-cresponse.html#1009" class="InductiveConstructor">currentAddrLookupc</a> <a id="1028" class="Symbol">:</a> <a id="1030" href="Complex-Model.ccomand.ccommands-cresponse.html#460" class="Datatype">CCommands</a>
    <a id="CCommands.callAddrLookupc"></a><a id="1044" href="Complex-Model.ccomand.ccommands-cresponse.html#1044" class="InductiveConstructor">callAddrLookupc</a> <a id="1060" class="Symbol">:</a> <a id="1062" href="Complex-Model.ccomand.ccommands-cresponse.html#460" class="Datatype">CCommands</a>
    <a id="CCommands.getAmountc"></a><a id="1076" href="Complex-Model.ccomand.ccommands-cresponse.html#1076" class="InductiveConstructor">getAmountc</a> <a id="1087" class="Symbol">:</a> <a id="1089" href="basicDataStructure.html#387" class="Function">Address</a> <a id="1097" class="Symbol">→</a> <a id="1099" href="Complex-Model.ccomand.ccommands-cresponse.html#460" class="Datatype">CCommands</a>
    

<a id="1115" class="Comment">-- contract-response:</a>
  <a id="CResponse"></a><a id="1139" href="Complex-Model.ccomand.ccommands-cresponse.html#1139" class="Function">CResponse</a> <a id="1149" class="Symbol">:</a> <a id="1151" href="Complex-Model.ccomand.ccommands-cresponse.html#460" class="Datatype">CCommands</a> <a id="1161" class="Symbol">→</a> <a id="1163" href="Agda.Primitive.html#388" class="Primitive">Set</a>
  <a id="1169" href="Complex-Model.ccomand.ccommands-cresponse.html#1139" class="Function">CResponse</a> <a id="1179" class="Symbol">(</a><a id="1180" href="Complex-Model.ccomand.ccommands-cresponse.html#486" class="InductiveConstructor">callc</a> <a id="1186" href="Complex-Model.ccomand.ccommands-cresponse.html#1186" class="Bound">addr</a> <a id="1191" href="Complex-Model.ccomand.ccommands-cresponse.html#1191" class="Bound">fname</a> <a id="1197" href="Complex-Model.ccomand.ccommands-cresponse.html#1197" class="Bound">msg</a> <a id="1201" href="Complex-Model.ccomand.ccommands-cresponse.html#1201" class="Bound">amount</a><a id="1207" class="Symbol">)</a> <a id="1209" class="Symbol">=</a> <a id="1211" href="basicDataStructure.html#511" class="Datatype">Msg</a>
  <a id="1217" href="Complex-Model.ccomand.ccommands-cresponse.html#1139" class="Function">CResponse</a> <a id="1227" href="Complex-Model.ccomand.ccommands-cresponse.html#548" class="InductiveConstructor">getTransferAmount</a> <a id="1245" class="Symbol">=</a> <a id="1247" href="basicDataStructure.html#360" class="Function">Amount</a>
  <a id="1256" href="Complex-Model.ccomand.ccommands-cresponse.html#1139" class="Function">CResponse</a> <a id="1266" class="Symbol">(</a><a id="1267" href="Complex-Model.ccomand.ccommands-cresponse.html#582" class="InductiveConstructor">eventc</a> <a id="1274" href="Complex-Model.ccomand.ccommands-cresponse.html#1274" class="Bound">s</a><a id="1275" class="Symbol">)</a> <a id="1277" class="Symbol">=</a> <a id="1279" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="1283" href="Complex-Model.ccomand.ccommands-cresponse.html#1139" class="Function">CResponse</a> <a id="1293" class="Symbol">(</a><a id="1294" href="Complex-Model.ccomand.ccommands-cresponse.html#818" class="InductiveConstructor">transferc</a> <a id="1304" href="Complex-Model.ccomand.ccommands-cresponse.html#1304" class="Bound">amount</a> <a id="1311" href="Complex-Model.ccomand.ccommands-cresponse.html#1311" class="Bound">addr</a><a id="1315" class="Symbol">)</a>   <a id="1319" class="Symbol">=</a> <a id="1321" href="basicDataStructure.html#511" class="Datatype">Msg</a>
  <a id="1327" href="Complex-Model.ccomand.ccommands-cresponse.html#1139" class="Function">CResponse</a> <a id="1337" class="Symbol">(</a><a id="1338" href="Complex-Model.ccomand.ccommands-cresponse.html#864" class="InductiveConstructor">transfercWithoutFallBack</a> <a id="1363" href="Complex-Model.ccomand.ccommands-cresponse.html#1363" class="Bound">amount</a> <a id="1370" href="Complex-Model.ccomand.ccommands-cresponse.html#1370" class="Bound">addr</a><a id="1374" class="Symbol">)</a> <a id="1376" class="Symbol">=</a> <a id="1378" href="basicDataStructure.html#511" class="Datatype">Msg</a>
  <a id="1384" href="Complex-Model.ccomand.ccommands-cresponse.html#1139" class="Function">CResponse</a> <a id="1394" class="Symbol">(</a><a id="1395" href="Complex-Model.ccomand.ccommands-cresponse.html#929" class="InductiveConstructor">callcAssumingTransferc</a> <a id="1418" href="Complex-Model.ccomand.ccommands-cresponse.html#1418" class="Bound">addr</a> <a id="1423" href="Complex-Model.ccomand.ccommands-cresponse.html#1423" class="Bound">fname</a> <a id="1429" href="Complex-Model.ccomand.ccommands-cresponse.html#1429" class="Bound">msg</a> <a id="1433" href="Complex-Model.ccomand.ccommands-cresponse.html#1433" class="Bound">amount</a><a id="1439" class="Symbol">)</a>    <a id="1444" class="Symbol">=</a> <a id="1446" href="basicDataStructure.html#511" class="Datatype">Msg</a>
  <a id="1452" href="Complex-Model.ccomand.ccommands-cresponse.html#1139" class="Function">CResponse</a> <a id="1462" href="Complex-Model.ccomand.ccommands-cresponse.html#1009" class="InductiveConstructor">currentAddrLookupc</a> <a id="1481" class="Symbol">=</a> <a id="1483" href="basicDataStructure.html#387" class="Function">Address</a>
  <a id="1493" href="Complex-Model.ccomand.ccommands-cresponse.html#1139" class="Function">CResponse</a> <a id="1503" href="Complex-Model.ccomand.ccommands-cresponse.html#1044" class="InductiveConstructor">callAddrLookupc</a> <a id="1519" class="Symbol">=</a> <a id="1521" href="basicDataStructure.html#387" class="Function">Address</a>
  <a id="1531" href="Complex-Model.ccomand.ccommands-cresponse.html#1139" class="Function">CResponse</a> <a id="1541" class="Symbol">(</a><a id="1542" href="Complex-Model.ccomand.ccommands-cresponse.html#1076" class="InductiveConstructor">getAmountc</a> <a id="1553" href="Complex-Model.ccomand.ccommands-cresponse.html#1553" class="Bound">addr</a><a id="1557" class="Symbol">)</a> <a id="1559" class="Symbol">=</a> <a id="1561" href="basicDataStructure.html#360" class="Function">Amount</a>
  <a id="1570" href="Complex-Model.ccomand.ccommands-cresponse.html#1139" class="Function">CResponse</a> <a id="1580" class="Symbol">(</a><a id="1581" href="Complex-Model.ccomand.ccommands-cresponse.html#614" class="InductiveConstructor">callView</a> <a id="1590" href="Complex-Model.ccomand.ccommands-cresponse.html#1590" class="Bound">addr</a> <a id="1595" href="Complex-Model.ccomand.ccommands-cresponse.html#1595" class="Bound">fname</a> <a id="1601" href="Complex-Model.ccomand.ccommands-cresponse.html#1601" class="Bound">msg</a><a id="1604" class="Symbol">)</a>  <a id="1607" class="Symbol">=</a> <a id="1609" href="basicDataStructure.html#1475" class="Datatype">MsgOrError</a>
  <a id="1622" href="Complex-Model.ccomand.ccommands-cresponse.html#1139" class="Function">CResponse</a> <a id="1632" class="Symbol">(</a><a id="1633" href="Complex-Model.ccomand.ccommands-cresponse.html#672" class="InductiveConstructor">updatec</a> <a id="1641" href="Complex-Model.ccomand.ccommands-cresponse.html#1641" class="Bound">fname</a> <a id="1647" href="Complex-Model.ccomand.ccommands-cresponse.html#1647" class="Bound">fdef</a> <a id="1652" href="Complex-Model.ccomand.ccommands-cresponse.html#1652" class="Bound">cost</a><a id="1656" class="Symbol">)</a>  <a id="1659" class="Symbol">=</a> <a id="1661" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>



<a id="1666" class="Comment">--SmartContract is datatype of what happens when a function is applied to its arguments.</a>
  <a id="1757" class="Keyword">data</a> <a id="SmartContract"></a><a id="1762" href="Complex-Model.ccomand.ccommands-cresponse.html#1762" class="Datatype">SmartContract</a> <a id="1776" class="Symbol">(</a><a id="1777" href="Complex-Model.ccomand.ccommands-cresponse.html#1777" class="Bound">A</a> <a id="1779" class="Symbol">:</a> <a id="1781" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="1784" class="Symbol">)</a> <a id="1786" class="Symbol">:</a> <a id="1788" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1792" class="Keyword">where</a>
    <a id="SmartContract.return"></a><a id="1802" href="Complex-Model.ccomand.ccommands-cresponse.html#1802" class="InductiveConstructor">return</a>  <a id="1810" class="Symbol">:</a> <a id="1812" href="Complex-Model.ccomand.ccommands-cresponse.html#1777" class="Bound">A</a> <a id="1814" class="Symbol">→</a> <a id="1816" href="Complex-Model.ccomand.ccommands-cresponse.html#1762" class="Datatype">SmartContract</a> <a id="1830" href="Complex-Model.ccomand.ccommands-cresponse.html#1777" class="Bound">A</a>
    <a id="SmartContract.error"></a><a id="1836" href="Complex-Model.ccomand.ccommands-cresponse.html#1836" class="InductiveConstructor">error</a>   <a id="1844" class="Symbol">:</a> <a id="1846" href="basicDataStructure.html#674" class="Datatype">ErrorMsg</a> <a id="1855" class="Symbol">→</a> <a id="1857" href="basicDataStructure.html#849" class="Record">DebugInfo</a> <a id="1867" class="Symbol">→</a> <a id="1869" href="Complex-Model.ccomand.ccommands-cresponse.html#1762" class="Datatype">SmartContract</a> <a id="1883" href="Complex-Model.ccomand.ccommands-cresponse.html#1777" class="Bound">A</a>
    <a id="SmartContract.exec"></a><a id="1889" href="Complex-Model.ccomand.ccommands-cresponse.html#1889" class="InductiveConstructor">exec</a>    <a id="1897" class="Symbol">:</a> <a id="1899" class="Symbol">(</a><a id="1900" href="Complex-Model.ccomand.ccommands-cresponse.html#1900" class="Bound">c</a> <a id="1902" class="Symbol">:</a> <a id="1904" href="Complex-Model.ccomand.ccommands-cresponse.html#460" class="Datatype">CCommands</a><a id="1913" class="Symbol">)</a> <a id="1915" class="Symbol">→</a> <a id="1917" class="Symbol">(</a><a id="1918" href="Complex-Model.ccomand.ccommands-cresponse.html#1139" class="Function">CResponse</a> <a id="1928" href="Complex-Model.ccomand.ccommands-cresponse.html#1900" class="Bound">c</a> <a id="1930" class="Symbol">→</a> <a id="1932" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1933" class="Symbol">)</a>
            <a id="1947" class="Symbol">→</a> <a id="1949" class="Symbol">(</a><a id="1950" href="Complex-Model.ccomand.ccommands-cresponse.html#1139" class="Function">CResponse</a> <a id="1960" href="Complex-Model.ccomand.ccommands-cresponse.html#1900" class="Bound">c</a> <a id="1962" class="Symbol">→</a> <a id="1964" href="Complex-Model.ccomand.ccommands-cresponse.html#1762" class="Datatype">SmartContract</a> <a id="1978" href="Complex-Model.ccomand.ccommands-cresponse.html#1777" class="Bound">A</a><a id="1979" class="Symbol">)</a> <a id="1981" class="Symbol">→</a> <a id="1983" href="Complex-Model.ccomand.ccommands-cresponse.html#1762" class="Datatype">SmartContract</a> <a id="1997" href="Complex-Model.ccomand.ccommands-cresponse.html#1777" class="Bound">A</a>



<a id="emptymsg"></a><a id="2002" href="Complex-Model.ccomand.ccommands-cresponse.html#2002" class="Function">emptymsg</a> <a id="2011" class="Symbol">:</a> <a id="2013" href="basicDataStructure.html#511" class="Datatype">Msg</a>
<a id="2017" href="Complex-Model.ccomand.ccommands-cresponse.html#2002" class="Function">emptymsg</a> <a id="2026" class="Symbol">=</a> <a id="2028" href="basicDataStructure.html#603" class="InductiveConstructor">list</a> <a id="2033" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>


<a id="fallback"></a><a id="2038" href="Complex-Model.ccomand.ccommands-cresponse.html#2038" class="Function">fallback</a> <a id="2047" class="Symbol">:</a> <a id="2049" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="2056" href="Complex-Model.ccomand.ccommands-cresponse.html#2038" class="Function">fallback</a> <a id="2065" class="Symbol">=</a> <a id="2067" class="String">&quot;fallback&quot;</a>
</pre></body></html>