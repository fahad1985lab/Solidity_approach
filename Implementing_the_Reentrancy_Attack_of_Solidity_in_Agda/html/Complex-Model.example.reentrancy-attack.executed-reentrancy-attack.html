<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Complex-Model.example.reentrancy-attack.executed-reentrancy-attack</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="constantparameters.html" class="Module">constantparameters</a>

<a id="33" class="Keyword">module</a> <a id="40" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html" class="Module">Complex-Model.example.reentrancy-attack.executed-reentrancy-attack</a>  <a id="108" class="Keyword">where</a>
<a id="114" class="Keyword">open</a> <a id="119" class="Keyword">import</a> <a id="126" href="Data.List.html" class="Module">Data.List</a>
<a id="136" class="Keyword">open</a> <a id="141" class="Keyword">import</a> <a id="148" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a> 
<a id="164" class="Keyword">open</a> <a id="169" class="Keyword">import</a> <a id="176" href="Agda.Builtin.Unit.html" class="Module">Agda.Builtin.Unit</a>
<a id="194" class="Keyword">open</a> <a id="199" class="Keyword">import</a> <a id="206" href="Data.Product.html" class="Module">Data.Product</a> <a id="219" class="Keyword">renaming</a> <a id="228" class="Symbol">(</a><a id="229" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a> <a id="233" class="Symbol">to</a> <a id="236" class="InductiveConstructor Operator">_,,_</a> <a id="241" class="Symbol">)</a>
<a id="243" class="Keyword">open</a> <a id="248" class="Keyword">import</a> <a id="255" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="266" class="Keyword">hiding</a> <a id="273" class="Symbol">(</a><a id="274" href="Data.Maybe.Base.html#2256" class="Function Operator">_&gt;&gt;=_</a><a id="279" class="Symbol">)</a>
<a id="281" class="Keyword">open</a> <a id="286" class="Keyword">import</a> <a id="293" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> 
<a id="308" class="Keyword">open</a> <a id="313" class="Keyword">import</a> <a id="320" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a>
<a id="334" class="Keyword">open</a> <a id="339" class="Keyword">import</a> <a id="346" href="Data.Fin.Base.html" class="Module">Data.Fin.Base</a> <a id="360" class="Keyword">hiding</a> <a id="367" class="Symbol">(</a><a id="368" href="Data.Fin.Base.html#5934" class="Function Operator">_+_</a><a id="371" class="Symbol">;</a> <a id="373" href="Data.Fin.Base.html#6064" class="Function Operator">_-_</a><a id="376" class="Symbol">)</a>
<a id="378" class="Keyword">import</a> <a id="385" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="423" class="Symbol">as</a> <a id="426" class="Module">Eq</a>
<a id="429" class="Keyword">open</a> <a id="434" href="Relation.Binary.PropositionalEquality.html" class="Module">Eq</a> <a id="437" class="Keyword">using</a> <a id="443" class="Symbol">(</a><a id="444" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a> <a id="448" class="Symbol">;</a> <a id="450" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> <a id="455" class="Symbol">;</a> <a id="457" href="Relation.Binary.PropositionalEquality.Core.html#1712" class="Function">sym</a> <a id="461" class="Symbol">;</a> <a id="463" href="Relation.Binary.PropositionalEquality.Core.html#1158" class="Function">cong</a><a id="467" class="Symbol">)</a>
<a id="469" class="Keyword">open</a> <a id="474" class="Keyword">import</a> <a id="481" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a> <a id="498" class="Keyword">using</a> <a id="504" class="Symbol">(</a><a id="505" href="Agda.Builtin.Nat.html#426" class="Primitive Operator">_-_</a><a id="508" class="Symbol">;</a> <a id="510" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">_*_</a><a id="513" class="Symbol">)</a>
<a id="515" class="Keyword">open</a> <a id="520" class="Keyword">import</a> <a id="527" href="Data.String.html" class="Module">Data.String</a> <a id="539" class="Keyword">hiding</a> <a id="546" class="Symbol">(</a><a id="547" href="Data.String.Base.html#2468" class="Function">length</a><a id="553" class="Symbol">;</a> <a id="555" href="Data.String.Base.html#1605" class="Primitive">show</a><a id="559" class="Symbol">)</a> <a id="561" class="Keyword">renaming</a> <a id="570" class="Symbol">(</a><a id="571" href="Data.String.Base.html#2404" class="Function Operator">_++_</a> <a id="576" class="Symbol">to</a> <a id="579" class="Function Operator">_++str_</a><a id="586" class="Symbol">)</a>
<a id="588" class="Keyword">open</a> <a id="593" class="Keyword">import</a> <a id="600" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="610" class="Keyword">open</a> <a id="615" class="Keyword">import</a> <a id="622" href="Data.Empty.html" class="Module">Data.Empty</a>



<a id="636" class="Comment">--our work</a>
<a id="647" class="Keyword">open</a> <a id="652" class="Keyword">import</a> <a id="659" href="Complex-Model.example.reentrancy-attack.reentrancy-attack.html" class="Module">Complex-Model.example.reentrancy-attack.reentrancy-attack</a>
<a id="717" class="Keyword">open</a> <a id="722" class="Keyword">import</a> <a id="729" href="libraries.natCompare.html" class="Module">libraries.natCompare</a>
<a id="750" class="Keyword">open</a> <a id="755" class="Keyword">import</a> <a id="762" href="Complex-Model.ledgerversion.Ledger-Complex-Model-with-reentrancy-attack.html" class="Module">Complex-Model.ledgerversion.Ledger-Complex-Model-with-reentrancy-attack</a> <a id="834" href="constantparameters.html#682" class="Function">exampleParameters</a>
<a id="852" class="Keyword">open</a> <a id="857" class="Keyword">import</a> <a id="864" href="basicDataStructure.html" class="Module">basicDataStructure</a>
<a id="883" class="Keyword">open</a> <a id="888" class="Keyword">import</a> <a id="895" href="libraries.Mainlibrary-new-version.html" class="Module">libraries.Mainlibrary-new-version</a>
<a id="929" class="Keyword">open</a> <a id="934" class="Keyword">import</a> <a id="941" href="Complex-Model.ledgerversion.Ledger-Complex-Model-improved-terminate.html" class="Module">Complex-Model.ledgerversion.Ledger-Complex-Model-improved-terminate</a> <a id="1009" href="constantparameters.html#682" class="Function">exampleParameters</a>
<a id="1027" class="Keyword">open</a> <a id="1032" class="Keyword">import</a> <a id="1039" href="Complex-Model.ccomand.ccommands-cresponse.html" class="Module">Complex-Model.ccomand.ccommands-cresponse</a>


<a id="1083" class="Comment">--------------------------- First test   (deposit 5000 wei)</a>
<a id="1143" class="Comment">---- deposit 25000 wei at address 0 for address 2</a>
<a id="1193" class="Comment">-- the test case is correct.</a>
<a id="1222" class="Comment">--- and same as the other one</a>
<a id="1252" class="Comment">-- using function &quot;deposit&quot; with (nat 0) on testLedger</a>

<a id="resultAfterdeposit"></a><a id="1308" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#1308" class="Function">resultAfterdeposit</a> <a id="1327" class="Symbol">:</a> <a id="1329" href="libraries.Mainlibrary-new-version.html#1040" class="Function">Ledger</a> <a id="1336" href="Data.Product.Base.html#1618" class="Function Operator">×</a>  <a id="1339" href="basicDataStructure.html#1700" class="Record">MsgOrErrorWithGas</a>
<a id="1357" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#1308" class="Function">resultAfterdeposit</a> <a id="1376" class="Symbol">=</a> <a id="1378" href="Complex-Model.ledgerversion.Ledger-Complex-Model-improved-terminate.html#6487" class="Function">evaluateTerminatingfinal</a> <a id="1403" href="Complex-Model.example.reentrancy-attack.reentrancy-attack.html#3143" class="Function">testLedger</a> <a id="1414" class="Number">2</a> <a id="1416" class="Number">2</a> <a id="1418" class="Number">0</a> <a id="1420" class="String">&quot;deposit&quot;</a> <a id="1430" class="Symbol">(</a><a id="1431" href="basicDataStructure.html#530" class="InductiveConstructor">nat</a> <a id="1435" class="Number">0</a><a id="1436" class="Symbol">)</a> <a id="1438" class="Number">25000</a> <a id="1444" class="Symbol">(</a><a id="1445" class="String">&quot;deposit function&quot;</a> <a id="1464" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1466" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="1468" class="Symbol">)</a> <a id="1470" class="Number">250</a>


<a id="1476" class="Comment">--- resultReturneddeposit return the result </a>
<a id="resultReturneddeposit"></a><a id="1521" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#1521" class="Function">resultReturneddeposit</a> <a id="1543" class="Symbol">:</a> <a id="1545" href="basicDataStructure.html#1700" class="Record">MsgOrErrorWithGas</a>
<a id="1563" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#1521" class="Function">resultReturneddeposit</a> <a id="1585" class="Symbol">=</a> <a id="1587" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="1593" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#1308" class="Function">resultAfterdeposit</a>

<a id="1613" class="Comment">{-
theMsg (nat 0) , 231 gas,
(&quot;deposit +25000 wei at address 0 for address 2\n New balance at address 0 is 125000wei \n&quot;
 ∷ &quot;deposit function&quot; ∷ [])
-}</a>



<a id="1768" class="Comment">-- obtain our ledger to get our amount for each contract</a>
<a id="ledgerAfterdeposit"></a><a id="1825" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#1825" class="Function">ledgerAfterdeposit</a> <a id="1844" class="Symbol">:</a> <a id="1846" href="libraries.Mainlibrary-new-version.html#1040" class="Function">Ledger</a>
<a id="1853" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#1825" class="Function">ledgerAfterdeposit</a> <a id="1872" class="Symbol">=</a> <a id="1874" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="1880" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#1308" class="Function">resultAfterdeposit</a> 



<a id="1903" class="Comment">--- check amount after deposit 25000 wei at address 0</a>
<a id="checkamountAfterdepositAtadd0"></a><a id="1957" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#1957" class="Function">checkamountAfterdepositAtadd0</a> <a id="1987" class="Symbol">:</a> <a id="1989" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="1991" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#1957" class="Function">checkamountAfterdepositAtadd0</a> <a id="2021" class="Symbol">=</a> <a id="2023" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#1825" class="Function">ledgerAfterdeposit</a> <a id="2042" class="Number">0</a> <a id="2044" class="Symbol">.</a><a id="2045" href="libraries.Mainlibrary-new-version.html#827" class="Field">amount</a>

<a id="2053" class="Comment">{- result amount at address 0 after deposit 5000 wei and before was 10000 wei
125000 
-}</a>


<a id="2144" class="Comment">--check amount after deposit 25000 wei at address 0 for address 2</a>
<a id="checkamountAfterdepositAtadd2"></a><a id="2210" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#2210" class="Function">checkamountAfterdepositAtadd2</a> <a id="2240" class="Symbol">:</a> <a id="2242" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="2244" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#2210" class="Function">checkamountAfterdepositAtadd2</a> <a id="2274" class="Symbol">=</a> <a id="2276" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#1825" class="Function">ledgerAfterdeposit</a> <a id="2295" class="Number">2</a> <a id="2297" class="Symbol">.</a><a id="2298" href="libraries.Mainlibrary-new-version.html#827" class="Field">amount</a>
<a id="2305" class="Comment">{- result amount at address 2, before was 26000 wei
 981
-}</a>


<a id="2367" class="Comment">--check viewfunction after deposit 25000 wei at address 0 for address 2 (nat 2)</a>
<a id="checkviewFunctionAfterdeposit"></a><a id="2447" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#2447" class="Function">checkviewFunctionAfterdeposit</a> <a id="2477" class="Symbol">:</a> <a id="2479" href="basicDataStructure.html#1475" class="Datatype">MsgOrError</a>
<a id="2490" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#2447" class="Function">checkviewFunctionAfterdeposit</a> <a id="2520" class="Symbol">=</a> <a id="2522" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#1825" class="Function">ledgerAfterdeposit</a> <a id="2541" class="Number">0</a> <a id="2543" class="Symbol">.</a><a id="2544" href="libraries.Mainlibrary-new-version.html#901" class="Field">viewFunction</a> <a id="2557" class="String">&quot;balance&quot;</a> <a id="2567" class="Symbol">(</a><a id="2568" href="basicDataStructure.html#530" class="InductiveConstructor">nat</a> <a id="2572" class="Number">2</a><a id="2573" class="Symbol">)</a>
<a id="2575" class="Comment">{-
theMsg (nat 25000)

-}</a>


<a id="2603" class="Comment">--------------------------- Second test   (withdraw 5000 wei)</a>
<a id="2665" class="Comment">---- In first case we depositted 25000 wei at address 0 for address 2</a>
<a id="2735" class="Comment">-- Now we need to use withdraw 25000 wei from address 0 and transfer it to address 2</a>
<a id="2820" class="Comment">-- using function &quot;withdraw&quot; with (nat 25000) on ledgerAfterdeposit</a>

<a id="resultAfterwithdraw"></a><a id="2889" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#2889" class="Function">resultAfterwithdraw</a> <a id="2909" class="Symbol">:</a> <a id="2911" href="libraries.Mainlibrary-new-version.html#1040" class="Function">Ledger</a> <a id="2918" href="Data.Product.Base.html#1618" class="Function Operator">×</a>  <a id="2921" href="basicDataStructure.html#1700" class="Record">MsgOrErrorWithGas</a>
<a id="2939" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#2889" class="Function">resultAfterwithdraw</a> <a id="2959" class="Symbol">=</a> <a id="2961" href="Complex-Model.ledgerversion.Ledger-Complex-Model-improved-terminate.html#6487" class="Function">evaluateTerminatingfinal</a> <a id="2986" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#1825" class="Function">ledgerAfterdeposit</a> <a id="3005" class="Number">2</a> <a id="3007" class="Number">2</a> <a id="3009" class="Number">0</a> <a id="3011" class="String">&quot;withdraw&quot;</a> <a id="3022" class="Symbol">(</a><a id="3023" href="basicDataStructure.html#530" class="InductiveConstructor">nat</a> <a id="3027" class="Number">25000</a><a id="3032" class="Symbol">)</a> <a id="3034" class="Number">0</a> <a id="3036" class="Symbol">(</a><a id="3037" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3039" class="Symbol">)</a> <a id="3041" class="Number">250</a>


<a id="3047" class="Comment">--- resultReturnedwithdraw return the result </a>
<a id="resultReturnedwithdraw"></a><a id="3093" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#3093" class="Function">resultReturnedwithdraw</a> <a id="3116" class="Symbol">:</a> <a id="3118" href="basicDataStructure.html#1700" class="Record">MsgOrErrorWithGas</a>
<a id="3136" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#3093" class="Function">resultReturnedwithdraw</a> <a id="3159" class="Symbol">=</a> <a id="3161" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="3167" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#2889" class="Function">resultAfterwithdraw</a>

<a id="3188" class="Comment">{-
theMsg (nat 0) , 227 gas,
(&quot;Balance at address 0  = 125000 wei.\n withdraw -25000 wei.&quot; ∷ [])
-}</a>


<a id="ledgerAfterwithdraw"></a><a id="3290" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#3290" class="Function">ledgerAfterwithdraw</a> <a id="3310" class="Symbol">:</a> <a id="3312" href="libraries.Mainlibrary-new-version.html#1040" class="Function">Ledger</a>
<a id="3319" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#3290" class="Function">ledgerAfterwithdraw</a> <a id="3339" class="Symbol">=</a> <a id="3341" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="3347" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#2889" class="Function">resultAfterwithdraw</a>

<a id="3368" class="Comment">--checkamountforAddr0Afterwithdraw to check amount at address 0 after withdraw 25000 wei</a>
<a id="checkamountforAddr0Afterwithdraw"></a><a id="3457" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#3457" class="Function">checkamountforAddr0Afterwithdraw</a> <a id="3490" class="Symbol">:</a> <a id="3492" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="3494" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#3457" class="Function">checkamountforAddr0Afterwithdraw</a> <a id="3527" class="Symbol">=</a> <a id="3529" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#3290" class="Function">ledgerAfterwithdraw</a> <a id="3549" class="Number">0</a> <a id="3551" class="Symbol">.</a><a id="3552" href="libraries.Mainlibrary-new-version.html#827" class="Field">amount</a> 
<a id="3560" class="Comment">{- result amount at address 0 after withdraw 25000 wei, before was 125000 wei
100000
-}</a>

<a id="3649" class="Comment">--checkamountforAddr1Afterwithdraw to check amount at address 2 after withdraw 25000 wei from addr 0</a>
<a id="checkamountforAddr1Afterwithdraw"></a><a id="3750" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#3750" class="Function">checkamountforAddr1Afterwithdraw</a> <a id="3783" class="Symbol">:</a> <a id="3785" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="3787" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#3750" class="Function">checkamountforAddr1Afterwithdraw</a> <a id="3820" class="Symbol">=</a> <a id="3822" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#3290" class="Function">ledgerAfterwithdraw</a> <a id="3842" class="Number">2</a> <a id="3844" class="Symbol">.</a><a id="3845" href="libraries.Mainlibrary-new-version.html#827" class="Field">amount</a> 
<a id="3853" class="Comment">{- result amount at address 2 after withdraw 25000 wei and transfer money to addr 2, before was  981 wei
25958
-}</a>


<a id="3969" class="Comment">--check viewfunction after withdraw 25000 wei from address 0 for address 2 (nat 2)</a>
<a id="checkviewFunctionAfterwithdraw"></a><a id="4052" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#4052" class="Function">checkviewFunctionAfterwithdraw</a> <a id="4083" class="Symbol">:</a> <a id="4085" href="basicDataStructure.html#1475" class="Datatype">MsgOrError</a>
<a id="4096" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#4052" class="Function">checkviewFunctionAfterwithdraw</a> <a id="4127" class="Symbol">=</a> <a id="4129" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#3290" class="Function">ledgerAfterwithdraw</a> <a id="4149" class="Number">0</a> <a id="4151" class="Symbol">.</a><a id="4152" href="libraries.Mainlibrary-new-version.html#901" class="Field">viewFunction</a> <a id="4165" class="String">&quot;balance&quot;</a> <a id="4175" class="Symbol">(</a><a id="4176" href="basicDataStructure.html#530" class="InductiveConstructor">nat</a> <a id="4180" class="Number">2</a><a id="4181" class="Symbol">)</a>
<a id="4183" class="Comment">{-
theMsg (nat 0)
-}</a>



<a id="4207" class="Comment">--------------------------- third test   (attack with 10000)</a>
<a id="4268" class="Comment">---- using attack function with amount sent 10000 wei</a>

<a id="resultAfterattack"></a><a id="4323" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#4323" class="Function">resultAfterattack</a> <a id="4341" class="Symbol">:</a> <a id="4343" href="libraries.Mainlibrary-new-version.html#1040" class="Function">Ledger</a> <a id="4350" href="Data.Product.Base.html#1618" class="Function Operator">×</a>  <a id="4353" href="basicDataStructure.html#1700" class="Record">MsgOrErrorWithGas</a>
<a id="4371" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#4323" class="Function">resultAfterattack</a> <a id="4389" class="Symbol">=</a> <a id="4391" href="Complex-Model.ledgerversion.Ledger-Complex-Model-improved-terminate.html#6487" class="Function">evaluateTerminatingfinal</a> <a id="4416" href="Complex-Model.example.reentrancy-attack.reentrancy-attack.html#3143" class="Function">testLedger</a> <a id="4427" class="Number">2</a> <a id="4429" class="Number">2</a> <a id="4431" class="Number">1</a> <a id="4433" class="String">&quot;attack&quot;</a> <a id="4442" class="Symbol">(</a><a id="4443" href="basicDataStructure.html#530" class="InductiveConstructor">nat</a> <a id="4447" class="Number">0</a><a id="4448" class="Symbol">)</a> <a id="4450" class="Number">25000</a> <a id="4456" class="Symbol">(</a><a id="4457" class="String">&quot;deposit function&quot;</a> <a id="4476" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="4478" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="4480" class="Symbol">)</a> <a id="4482" class="Number">250</a>







<a id="4493" class="Comment">--- resultReturneddeposit return the result </a>
<a id="resultReturnedattack"></a><a id="4538" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#4538" class="Function">resultReturnedattack</a> <a id="4559" class="Symbol">:</a> <a id="4561" href="basicDataStructure.html#1700" class="Record">MsgOrErrorWithGas</a>
<a id="4579" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#4538" class="Function">resultReturnedattack</a> <a id="4600" class="Symbol">=</a> <a id="4602" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="4608" href="Complex-Model.example.reentrancy-attack.executed-reentrancy-attack.html#4323" class="Function">resultAfterattack</a>
<a id="4626" class="Comment">{- result after attack

theMsg (nat 0) , 66 gas,
(&quot;Current balance at address 2  = 125750 wei&quot; ∷
 &quot;Current balance at address 1  = 0 wei&quot; ∷
 &quot;\nCurrent balance at address 0  = 0 wei&quot; ∷
 &quot;Balance at address 0  = 25000 wei.\n withdraw -25000 wei.&quot; ∷
 &quot;Balance at address 0  = 50000 wei.\n withdraw -25000 wei.&quot; ∷
 &quot;Balance at address 0  = 75000 wei.\n withdraw -25000 wei.&quot; ∷
 &quot;Balance at address 0  = 100000 wei.\n withdraw -25000 wei.&quot; ∷
 &quot;Balance at address 0  = 125000 wei.\n withdraw -25000 wei.&quot; ∷
 &quot;deposit +25000 wei at address 0 for address 1\n New balance at address 0 is 125000wei \n&quot;
 ∷ &quot;deposit function&quot; ∷ [])

-}</a>


</pre></body></html>