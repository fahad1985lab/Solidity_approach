<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Simple-Model.example.examplecounter</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Simple-Model.example.examplecounter.html" class="Module">Simple-Model.example.examplecounter</a> <a id="44" class="Keyword">where</a>

<a id="51" class="Keyword">open</a> <a id="56" class="Keyword">import</a> <a id="63" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="72" class="Keyword">open</a> <a id="77" class="Keyword">import</a> <a id="84" href="Data.List.html" class="Module">Data.List</a>
<a id="94" class="Keyword">open</a> <a id="99" class="Keyword">import</a> <a id="106" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="116" class="Keyword">open</a> <a id="121" class="Keyword">import</a> <a id="128" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>
<a id="143" class="Keyword">open</a> <a id="148" class="Keyword">import</a> <a id="155" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="169" class="Keyword">open</a> <a id="174" class="Keyword">import</a> <a id="181" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="192" class="Keyword">hiding</a> <a id="199" class="Symbol">(</a><a id="200" href="Data.Maybe.Base.html#2256" class="Function Operator">_&gt;&gt;=_</a><a id="205" class="Symbol">)</a>
<a id="207" class="Keyword">open</a> <a id="212" class="Keyword">import</a> <a id="219" href="Data.String.html" class="Module">Data.String</a> <a id="231" class="Keyword">hiding</a> <a id="238" class="Symbol">(</a><a id="239" href="Data.String.Base.html#2468" class="Function">length</a><a id="245" class="Symbol">)</a>


<a id="249" class="Comment">--simple model</a>
<a id="264" class="Keyword">open</a> <a id="269" class="Keyword">import</a> <a id="276" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html" class="Module">Simple-Model.ledgerversion.Ledger-Simple-Model</a>

<a id="324" class="Comment">--library</a>
<a id="334" class="Keyword">open</a> <a id="339" class="Keyword">import</a> <a id="346" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html" class="Module">Simple-Model.library-simple-model.basicDataStructureWithSimpleModel</a>
<a id="414" class="Keyword">open</a> <a id="419" class="Keyword">import</a> <a id="426" href="interface.ConsoleLib.html" class="Module">interface.ConsoleLib</a>

<a id="448" class="Comment">--IOledger</a>
<a id="459" class="Keyword">open</a> <a id="464" class="Keyword">import</a> <a id="471" href="Simple-Model.IOledger.IOledger-counter.html" class="Module">Simple-Model.IOledger.IOledger-counter</a>



<a id="513" class="Comment">--Example of a simple counter</a>
<a id="const"></a><a id="543" href="Simple-Model.example.examplecounter.html#543" class="Function">const</a> <a id="549" class="Symbol">:</a> <a id="551" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="553" class="Symbol">→</a> <a id="555" class="Symbol">(</a><a id="556" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a> <a id="560" class="Symbol">→</a> <a id="562" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1274" class="Datatype">SmartContract</a> <a id="576" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a><a id="579" class="Symbol">)</a>
<a id="581" href="Simple-Model.example.examplecounter.html#543" class="Function">const</a> <a id="587" href="Simple-Model.example.examplecounter.html#587" class="Bound">n</a> <a id="589" href="Simple-Model.example.examplecounter.html#589" class="Bound">msg</a> <a id="593" class="Symbol">=</a> <a id="595" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1314" class="InductiveConstructor">return</a> <a id="602" class="Symbol">(</a><a id="603" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#420" class="InductiveConstructor">nat</a> <a id="607" href="Simple-Model.example.examplecounter.html#587" class="Bound">n</a><a id="608" class="Symbol">)</a>


<a id="612" class="Comment">-- test our ledger with our example</a>
<a id="testLedger"></a><a id="648" href="Simple-Model.example.examplecounter.html#648" class="Function">testLedger</a> <a id="659" class="Symbol">:</a> <a id="661" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2019" class="Function">Ledger</a>

<a id="669" class="Comment">-- the example below we used in our paper</a>
<a id="711" href="Simple-Model.example.examplecounter.html#648" class="Function">testLedger</a> <a id="722" class="Number">0</a> <a id="724" class="Symbol">.</a><a id="725" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1911" class="Field">amount</a>  <a id="733" class="Symbol">=</a> <a id="735" class="Number">20</a>
<a id="738" href="Simple-Model.example.examplecounter.html#648" class="Function">testLedger</a> <a id="749" class="Number">1</a> <a id="751" class="Symbol">.</a><a id="752" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1911" class="Field">amount</a>             <a id="771" class="Symbol">=</a> <a id="773" class="Number">40</a>
<a id="776" href="Simple-Model.example.examplecounter.html#648" class="Function">testLedger</a> <a id="787" class="Number">1</a> <a id="789" class="Symbol">.</a><a id="790" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1933" class="Field">fun</a> <a id="794" class="String">&quot;counter&quot;</a> <a id="804" href="Simple-Model.example.examplecounter.html#804" class="Bound">m</a>   <a id="808" class="Symbol">=</a> <a id="810" href="Simple-Model.example.examplecounter.html#543" class="Function">const</a> <a id="816" class="Number">0</a> <a id="818" class="Symbol">(</a><a id="819" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#420" class="InductiveConstructor">nat</a> <a id="823" class="Number">0</a><a id="824" class="Symbol">)</a>
<a id="826" href="Simple-Model.example.examplecounter.html#648" class="Function">testLedger</a> <a id="837" class="Number">1</a> <a id="839" class="Symbol">.</a><a id="840" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1933" class="Field">fun</a> <a id="844" class="String">&quot;increment&quot;</a> <a id="856" href="Simple-Model.example.examplecounter.html#856" class="Bound">m</a>  <a id="859" class="Symbol">=</a> <a id="861" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1391" class="InductiveConstructor">exec</a> <a id="866" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#730" class="InductiveConstructor">currentAddrLookupc</a>  <a id="886" class="Symbol">λ</a> <a id="888" href="Simple-Model.example.examplecounter.html#888" class="Bound">addr</a> <a id="893" class="Symbol">→</a>
                                   <a id="930" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1391" class="InductiveConstructor">exec</a> <a id="935" class="Symbol">(</a><a id="936" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#600" class="InductiveConstructor">callc</a> <a id="942" href="Simple-Model.example.examplecounter.html#888" class="Bound">addr</a> <a id="947" class="String">&quot;counter&quot;</a> <a id="957" class="Symbol">(</a><a id="958" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#420" class="InductiveConstructor">nat</a> <a id="962" class="Number">0</a><a id="963" class="Symbol">))</a>
                                   <a id="1001" class="Symbol">λ{(</a><a id="1004" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#420" class="InductiveConstructor">nat</a> <a id="1008" href="Simple-Model.example.examplecounter.html#1008" class="Bound">n</a><a id="1009" class="Symbol">)</a> <a id="1011" class="Symbol">→</a> <a id="1013" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1391" class="InductiveConstructor">exec</a> <a id="1018" class="Symbol">(</a><a id="1019" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#659" class="InductiveConstructor">updatec</a> <a id="1027" class="String">&quot;counter&quot;</a> <a id="1037" class="Symbol">(</a><a id="1038" href="Simple-Model.example.examplecounter.html#543" class="Function">const</a> <a id="1044" class="Symbol">(</a><a id="1045" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="1049" href="Simple-Model.example.examplecounter.html#1008" class="Bound">n</a><a id="1050" class="Symbol">)))</a>
                                             <a id="1099" class="Symbol">λ</a> <a id="1101" href="Simple-Model.example.examplecounter.html#1101" class="Bound">_</a> <a id="1103" class="Symbol">→</a> <a id="1105" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1314" class="InductiveConstructor">return</a> <a id="1112" class="Symbol">(</a><a id="1113" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#420" class="InductiveConstructor">nat</a> <a id="1117" class="Symbol">(</a><a id="1118" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="1122" href="Simple-Model.example.examplecounter.html#1008" class="Bound">n</a><a id="1123" class="Symbol">));</a>
                                  <a id="1161" class="CatchallClause Symbol">_</a>        <a id="1170" class="Symbol">→</a> <a id="1172" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1349" class="InductiveConstructor">error</a> <a id="1178" class="Symbol">(</a><a id="1179" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#595" class="InductiveConstructor">strErr</a> <a id="1186" class="String">&quot;counter returns not a number&quot;</a><a id="1216" class="Symbol">)}</a>
<a id="1219" href="Simple-Model.example.examplecounter.html#648" class="Function">testLedger</a> <a id="1230" class="Number">1</a> <a id="1232" class="Symbol">.</a><a id="1233" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1933" class="Field">fun</a> <a id="1237" class="String">&quot;transfer&quot;</a> <a id="1248" href="Simple-Model.example.examplecounter.html#1248" class="Bound">m</a>  <a id="1251" class="Symbol">=</a> <a id="1253" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1391" class="InductiveConstructor">exec</a> <a id="1258" class="Symbol">(</a><a id="1259" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#553" class="InductiveConstructor">transferc</a> <a id="1269" class="Number">10</a>  <a id="1273" class="Number">0</a><a id="1274" class="Symbol">)</a> <a id="1276" class="Symbol">λ</a> <a id="1278" href="Simple-Model.example.examplecounter.html#1278" class="Bound">_</a> <a id="1280" class="Symbol">→</a> <a id="1282" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1314" class="InductiveConstructor">return</a> <a id="1289" href="Simple-Model.example.examplecounter.html#1248" class="Bound">m</a>

<a id="1292" href="Simple-Model.example.examplecounter.html#648" class="CatchallClause Function">testLedger</a><a id="1302" class="CatchallClause"> </a><a id="1303" href="Simple-Model.example.examplecounter.html#1303" class="CatchallClause Bound">ow</a><a id="1305" class="CatchallClause"> </a><a id="1306" class="CatchallClause Symbol">.</a><a id="1307" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1911" class="CatchallClause Field">amount</a>           <a id="1324" class="Symbol">=</a> <a id="1326" class="Number">0</a>
<a id="1328" href="Simple-Model.example.examplecounter.html#648" class="CatchallClause Function">testLedger</a><a id="1338" class="CatchallClause"> </a><a id="1339" href="Simple-Model.example.examplecounter.html#1339" class="CatchallClause Bound">ow</a><a id="1341" class="CatchallClause"> </a><a id="1342" class="CatchallClause Symbol">.</a><a id="1343" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1933" class="CatchallClause Field">fun</a><a id="1346" class="CatchallClause"> </a><a id="1347" href="Simple-Model.example.examplecounter.html#1347" class="CatchallClause Bound">ow&#39;</a><a id="1350" class="CatchallClause"> </a><a id="1351" href="Simple-Model.example.examplecounter.html#1351" class="CatchallClause Bound">ow&#39;&#39;</a>     <a id="1360" class="Symbol">=</a> <a id="1362" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1349" class="InductiveConstructor">error</a> <a id="1368" class="Symbol">(</a><a id="1369" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#595" class="InductiveConstructor">strErr</a> <a id="1376" class="String">&quot;Undefined&quot;</a><a id="1387" class="Symbol">)</a>


<a id="1391" class="Comment">-- To run IO</a>
<a id="main"></a><a id="1404" href="Simple-Model.example.examplecounter.html#1404" class="Function">main</a>  <a id="1410" class="Symbol">:</a>  <a id="1413" href="interface.ConsoleLib.html#904" class="Function">ConsoleProg</a> 
<a id="1426" href="Simple-Model.example.examplecounter.html#1404" class="Function">main</a>  <a id="1432" class="Symbol">=</a>  <a id="1435" href="interface.ConsoleLib.html#224" class="Function">run</a>  <a id="1440" class="Symbol">(</a><a id="1441" href="Simple-Model.IOledger.IOledger-counter.html#5346" class="Function">mainBody</a> <a id="1450" href="Simple-Model.example.examplecounter.html#648" class="Function">testLedger</a> <a id="1461" class="Number">0</a><a id="1462" class="Symbol">)</a>
</pre></body></html>