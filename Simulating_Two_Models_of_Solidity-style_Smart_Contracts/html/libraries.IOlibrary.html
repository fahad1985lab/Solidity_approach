<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>libraries.IOlibrary</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="constantparameters.html" class="Module">constantparameters</a>

<a id="33" class="Keyword">module</a> <a id="40" href="libraries.IOlibrary.html" class="Module">libraries.IOlibrary</a> <a id="60" class="Keyword">where</a>

<a id="67" class="Keyword">open</a> <a id="72" class="Keyword">import</a> <a id="79" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="88" class="Keyword">open</a> <a id="93" class="Keyword">import</a> <a id="100" href="Data.List.html" class="Module">Data.List</a> <a id="110" class="Keyword">hiding</a> <a id="117" class="Symbol">(</a><a id="118" href="Data.List.Base.html#1954" class="Function Operator">_++_</a><a id="122" class="Symbol">)</a>
<a id="124" class="Keyword">open</a> <a id="129" class="Keyword">import</a> <a id="136" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a> <a id="153" class="Keyword">using</a> <a id="159" class="Symbol">(</a><a id="160" href="Agda.Builtin.Nat.html#426" class="Primitive Operator">_-_</a><a id="163" class="Symbol">;</a> <a id="165" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">_*_</a><a id="168" class="Symbol">)</a>
<a id="170" class="Keyword">open</a> <a id="175" class="Keyword">import</a> <a id="182" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="192" class="Keyword">open</a> <a id="197" class="Keyword">import</a> <a id="204" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="214" class="Keyword">open</a> <a id="219" class="Keyword">import</a> <a id="226" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>
<a id="241" class="Keyword">open</a> <a id="246" class="Keyword">import</a> <a id="253" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="267" class="Keyword">open</a> <a id="272" class="Keyword">import</a> <a id="279" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="290" class="Keyword">hiding</a> <a id="297" class="Symbol">(</a><a id="298" href="Data.Maybe.Base.html#2256" class="Function Operator">_&gt;&gt;=_</a><a id="303" class="Symbol">)</a>
<a id="305" class="Keyword">open</a> <a id="310" class="Keyword">import</a> <a id="317" href="Data.String.html" class="Module">Data.String</a> <a id="329" class="Keyword">hiding</a> <a id="336" class="Symbol">(</a><a id="337" href="Data.String.Base.html#2468" class="Function">length</a><a id="343" class="Symbol">;</a><a id="344" href="Data.String.Base.html#1605" class="Primitive">show</a><a id="348" class="Symbol">)</a>
<a id="350" class="Keyword">open</a> <a id="355" class="Keyword">import</a> <a id="362" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a>
<a id="376" class="Keyword">open</a> <a id="381" class="Keyword">import</a> <a id="388" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a> <a id="404" class="Symbol">as</a> <a id="407" class="Module">Maybe</a> <a id="413" class="Keyword">using</a> <a id="419" class="Symbol">(</a><a id="420" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a><a id="425" class="Symbol">;</a> <a id="427" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="434" class="Symbol">;</a> <a id="436" href="Data.Maybe.Base.html#2379" class="Function Operator">_&lt;∣&gt;_</a><a id="441" class="Symbol">;</a> <a id="443" href="Data.Maybe.Base.html#2494" class="Function">when</a><a id="447" class="Symbol">)</a>
<a id="449" class="Keyword">import</a> <a id="456" href="Data.Maybe.Effectful.html" class="Module">Data.Maybe.Effectful</a>
<a id="477" class="Keyword">open</a> <a id="482" class="Keyword">import</a> <a id="489" href="Data.Product.html" class="Module">Data.Product</a> <a id="502" class="Keyword">renaming</a> <a id="511" class="Symbol">(</a><a id="512" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a> <a id="516" class="Symbol">to</a> <a id="519" class="InductiveConstructor Operator">_,,_</a> <a id="524" class="Symbol">)</a>
<a id="526" class="Keyword">open</a> <a id="531" class="Keyword">import</a> <a id="538" href="Agda.Builtin.String.html" class="Module">Agda.Builtin.String</a>

<a id="559" class="Comment">--our work</a>
<a id="570" class="Keyword">open</a> <a id="575" class="Keyword">import</a> <a id="582" href="libraries.natCompare.html" class="Module">libraries.natCompare</a>
<a id="603" class="Keyword">open</a> <a id="608" class="Keyword">import</a> <a id="615" href="libraries.Mainlibrary.html" class="Module">libraries.Mainlibrary</a>
<a id="637" class="Keyword">open</a> <a id="642" class="Keyword">import</a> <a id="649" href="interface.ConsoleLib.html" class="Module">interface.ConsoleLib</a>
<a id="670" class="Keyword">open</a> <a id="675" class="Keyword">import</a> <a id="682" href="Complex-Model.ccomand.ccommands-cresponse.html" class="Module">Complex-Model.ccomand.ccommands-cresponse</a>
<a id="724" class="Keyword">open</a> <a id="729" class="Keyword">import</a> <a id="736" href="basicDataStructure.html" class="Module">basicDataStructure</a>



<a id="string2FunctionName"></a><a id="758" href="libraries.IOlibrary.html#758" class="Function">string2FunctionName</a> <a id="778" class="Symbol">:</a> <a id="780" href="Agda.Builtin.String.html#335" class="Postulate">String</a> <a id="787" class="Symbol">→</a> <a id="789" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="795" href="basicDataStructure.html#190" class="Function">FunctionName</a>
<a id="808" href="libraries.IOlibrary.html#758" class="Function">string2FunctionName</a> <a id="828" href="libraries.IOlibrary.html#828" class="Bound">str</a> <a id="832" class="Symbol">=</a> <a id="834" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="839" href="libraries.IOlibrary.html#828" class="Bound">str</a>




<a id="funname2string"></a><a id="847" href="libraries.IOlibrary.html#847" class="Function">funname2string</a> <a id="862" class="Symbol">:</a> <a id="864" href="basicDataStructure.html#190" class="Function">FunctionName</a> <a id="877" class="Symbol">→</a> <a id="879" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="886" href="libraries.IOlibrary.html#847" class="Function">funname2string</a> <a id="901" href="libraries.IOlibrary.html#901" class="Bound">x</a> <a id="903" class="Symbol">=</a> <a id="905" href="libraries.IOlibrary.html#901" class="Bound">x</a>



<a id="910" class="Keyword">mutual</a>
  <a id="msgList2String"></a><a id="919" href="libraries.IOlibrary.html#919" class="Function">msgList2String</a> <a id="934" class="Symbol">:</a> <a id="936" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="941" href="basicDataStructure.html#523" class="Datatype">Msg</a> <a id="945" class="Symbol">→</a> <a id="947" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="956" href="libraries.IOlibrary.html#919" class="Function">msgList2String</a> <a id="971" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="974" class="Symbol">=</a> <a id="976" class="String">&quot;&quot;</a>
  <a id="981" href="libraries.IOlibrary.html#919" class="Function">msgList2String</a> <a id="996" class="Symbol">(</a><a id="997" href="libraries.IOlibrary.html#997" class="Bound">msg</a> <a id="1001" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1003" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="1005" class="Symbol">)</a> <a id="1007" class="Symbol">=</a> <a id="1009" href="libraries.IOlibrary.html#1108" class="Function">msg2string</a> <a id="1020" href="libraries.IOlibrary.html#997" class="Bound">msg</a>
  <a id="1026" href="libraries.IOlibrary.html#919" class="CatchallClause Function">msgList2String</a><a id="1040" class="CatchallClause"> </a><a id="1041" class="CatchallClause Symbol">(</a><a id="1042" href="libraries.IOlibrary.html#1042" class="CatchallClause Bound">msg</a><a id="1045" class="CatchallClause"> </a><a id="1046" href="Agda.Builtin.List.html#199" class="CatchallClause InductiveConstructor Operator">∷</a><a id="1047" class="CatchallClause"> </a><a id="1048" href="libraries.IOlibrary.html#1048" class="CatchallClause Bound">rest</a><a id="1052" class="CatchallClause Symbol">)</a> <a id="1054" class="Symbol">=</a> <a id="1056" href="libraries.IOlibrary.html#1108" class="Function">msg2string</a> <a id="1067" href="libraries.IOlibrary.html#1042" class="Bound">msg</a>  <a id="1072" href="Data.String.Base.html#2404" class="Function Operator">++</a> <a id="1075" class="String">&quot; , &quot;</a> <a id="1081" href="Data.String.Base.html#2404" class="Function Operator">++</a> <a id="1084" href="libraries.IOlibrary.html#919" class="Function">msgList2String</a> <a id="1099" href="libraries.IOlibrary.html#1048" class="Bound">rest</a>


  <a id="msg2string"></a><a id="1108" href="libraries.IOlibrary.html#1108" class="Function">msg2string</a> <a id="1119" class="Symbol">:</a> <a id="1121" href="basicDataStructure.html#523" class="Datatype">Msg</a> <a id="1125" class="Symbol">→</a> <a id="1127" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
  <a id="1136" href="libraries.IOlibrary.html#1108" class="Function">msg2string</a> <a id="1147" class="Symbol">(</a><a id="1148" href="basicDataStructure.html#542" class="InductiveConstructor">nat</a> <a id="1152" href="libraries.IOlibrary.html#1152" class="Bound">n</a><a id="1153" class="Symbol">)</a>         <a id="1163" class="Symbol">=</a> <a id="1165" class="String">&quot;(nat &quot;</a> <a id="1173" href="Data.String.Base.html#2404" class="Function Operator">++</a> <a id="1176" href="Data.Nat.Show.html#1962" class="Function">show</a> <a id="1181" href="libraries.IOlibrary.html#1152" class="Bound">n</a> <a id="1183" href="Data.String.Base.html#2404" class="Function Operator">++</a> <a id="1186" class="String">&quot;)&quot;</a>
  <a id="1192" href="libraries.IOlibrary.html#1108" class="Function">msg2string</a> <a id="1203" class="Symbol">(</a><a id="1204" href="libraries.IOlibrary.html#1204" class="Bound">msg</a> <a id="1208" href="basicDataStructure.html#578" class="InductiveConstructor Operator">+msg</a> <a id="1213" href="libraries.IOlibrary.html#1213" class="Bound">msg₁</a><a id="1217" class="Symbol">)</a> <a id="1219" class="Symbol">=</a>  <a id="1222" class="String">&quot;(&quot;</a> <a id="1226" href="Data.String.Base.html#2404" class="Function Operator">++</a> <a id="1229" href="libraries.IOlibrary.html#1108" class="Function">msg2string</a> <a id="1240" href="libraries.IOlibrary.html#1204" class="Bound">msg</a> <a id="1244" href="Data.String.Base.html#2404" class="Function Operator">++</a> <a id="1247" class="String">&quot; , &quot;</a> <a id="1253" href="Data.String.Base.html#2404" class="Function Operator">++</a> <a id="1256" href="libraries.IOlibrary.html#1108" class="Function">msg2string</a> <a id="1267" href="libraries.IOlibrary.html#1213" class="Bound">msg₁</a> <a id="1272" href="Data.String.Base.html#2404" class="Function Operator">++</a> <a id="1275" class="String">&quot;)&quot;</a>
  <a id="1281" href="libraries.IOlibrary.html#1108" class="Function">msg2string</a> <a id="1292" class="Symbol">(</a><a id="1293" href="basicDataStructure.html#615" class="InductiveConstructor">list</a> <a id="1298" href="libraries.IOlibrary.html#1298" class="Bound">l</a><a id="1299" class="Symbol">)</a>        <a id="1308" class="Symbol">=</a> <a id="1310" class="String">&quot;[&quot;</a> <a id="1314" href="Data.String.Base.html#2404" class="Function Operator">++</a> <a id="1317" href="libraries.IOlibrary.html#919" class="Function">msgList2String</a> <a id="1332" href="libraries.IOlibrary.html#1298" class="Bound">l</a> <a id="1334" href="Data.String.Base.html#2404" class="Function Operator">++</a> <a id="1337" class="String">&quot;]&quot;</a>


<a id="1343" class="Comment">-- Test cases</a>
<a id="1357" class="Comment">-- msg2string (nat 5)</a>
<a id="1379" class="Comment">--    &quot;(nat 5)&quot;&quot;(nat 5)&quot;</a>
<a id="1404" class="Comment">-- msg2string (list ((nat 3)  ∷ (nat 7) ∷ []))</a>
<a id="1451" class="Comment">--    &quot;[(nat 3) , (nat 7) ]&quot;</a>
<a id="1480" class="Comment">-- msg2string (list ((nat 3)  ∷ ((nat 7) +msg (nat 8) ) ∷ []))</a>
<a id="1543" class="Comment">--    &quot;[(nat 3) , ((nat 7) , (nat 8))]&quot;</a>

<a id="1584" class="Comment">--Error to String</a>
<a id="error2Str"></a><a id="1602" href="libraries.IOlibrary.html#1602" class="Function">error2Str</a> <a id="1612" class="Symbol">:</a> <a id="1614" href="basicDataStructure.html#671" class="Datatype">ErrorMsg</a> <a id="1623" class="Symbol">→</a> <a id="1625" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="1632" href="libraries.IOlibrary.html#1602" class="Function">error2Str</a> <a id="1642" class="Symbol">(</a><a id="1643" href="basicDataStructure.html#694" class="InductiveConstructor">strErr</a> <a id="1650" href="libraries.IOlibrary.html#1650" class="Bound">s</a><a id="1651" class="Symbol">)</a>  <a id="1654" class="Symbol">=</a> <a id="1656" href="libraries.IOlibrary.html#1650" class="Bound">s</a>
<a id="1658" href="libraries.IOlibrary.html#1602" class="Function">error2Str</a> <a id="1668" class="Symbol">(</a><a id="1669" href="basicDataStructure.html#726" class="InductiveConstructor">numErr</a> <a id="1676" href="libraries.IOlibrary.html#1676" class="Bound">n</a><a id="1677" class="Symbol">)</a>  <a id="1680" class="Symbol">=</a> <a id="1682" class="String">&quot;Number error (&quot;</a> <a id="1699" href="Data.String.Base.html#2404" class="Function Operator">++</a> <a id="1702" href="Data.Nat.Show.html#1962" class="Function">show</a> <a id="1707" href="libraries.IOlibrary.html#1676" class="Bound">n</a>  <a id="1710" href="Data.String.Base.html#2404" class="Function Operator">++</a> <a id="1713" class="String">&quot;)&quot;</a> 
<a id="1718" href="libraries.IOlibrary.html#1602" class="Function">error2Str</a> <a id="1728" href="basicDataStructure.html#753" class="InductiveConstructor">undefined</a> <a id="1738" class="Symbol">=</a> <a id="1740" class="String">&quot;Error undefined&quot;</a>
<a id="1758" href="libraries.IOlibrary.html#1602" class="Function">error2Str</a> <a id="1768" href="basicDataStructure.html#776" class="InductiveConstructor">outOfGasError</a> <a id="1782" class="Symbol">=</a> <a id="1784" class="String">&quot;Out of gas error&quot;</a>

<a id="1804" class="Comment">--ErrorMsg to String</a>
<a id="errorMsg2Str"></a><a id="1825" href="libraries.IOlibrary.html#1825" class="Function">errorMsg2Str</a> <a id="1838" class="Symbol">:</a> <a id="1840" href="basicDataStructure.html#1074" class="Datatype">NatOrError</a> <a id="1851" class="Symbol">→</a> <a id="1853" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="1860" href="libraries.IOlibrary.html#1825" class="Function">errorMsg2Str</a> <a id="1873" class="Symbol">(</a><a id="1874" href="basicDataStructure.html#1098" class="InductiveConstructor">nat</a> <a id="1878" href="libraries.IOlibrary.html#1878" class="Bound">n</a><a id="1879" class="Symbol">)</a> <a id="1881" class="Symbol">=</a> <a id="1883" href="Data.Nat.Show.html#1962" class="Function">show</a> <a id="1888" href="libraries.IOlibrary.html#1878" class="Bound">n</a>
<a id="1890" href="libraries.IOlibrary.html#1825" class="Function">errorMsg2Str</a> <a id="1903" class="Symbol">(</a><a id="1904" href="basicDataStructure.html#1120" class="InductiveConstructor">err</a> <a id="1908" href="libraries.IOlibrary.html#1908" class="Bound">e</a> <a id="1910" href="basicDataStructure.html#881" class="InductiveConstructor Operator">⟨</a> <a id="1912" href="libraries.IOlibrary.html#1912" class="Bound">lastcalladdr</a> <a id="1925" href="basicDataStructure.html#881" class="InductiveConstructor Operator">&gt;&gt;</a> <a id="1928" href="libraries.IOlibrary.html#1928" class="Bound">curraddr</a> <a id="1937" href="basicDataStructure.html#881" class="InductiveConstructor Operator">∙</a> <a id="1939" href="libraries.IOlibrary.html#1939" class="Bound">lastfunname</a> <a id="1951" href="basicDataStructure.html#881" class="InductiveConstructor Operator">[</a> <a id="1953" href="libraries.IOlibrary.html#1953" class="Bound">lastmsg</a> <a id="1961" href="basicDataStructure.html#881" class="InductiveConstructor Operator">]⟩</a><a id="1963" class="Symbol">)</a> <a id="1965" class="Symbol">=</a> <a id="1967" href="libraries.IOlibrary.html#1602" class="Function">error2Str</a> <a id="1977" href="libraries.IOlibrary.html#1908" class="Bound">e</a>
<a id="1979" href="libraries.IOlibrary.html#1825" class="Function">errorMsg2Str</a> <a id="1992" href="basicDataStructure.html#1161" class="InductiveConstructor">invalidtransaction</a> <a id="2011" class="Symbol">=</a> <a id="2013" class="String">&quot;invalidtransaction&quot;</a>


<a id="checkamount"></a><a id="2036" href="libraries.IOlibrary.html#2036" class="Function">checkamount</a> <a id="2048" class="Symbol">:</a> <a id="2050" href="libraries.Mainlibrary.html#1069" class="Function">Ledger</a> <a id="2057" class="Symbol">→</a> <a id="2059" href="basicDataStructure.html#405" class="Function">Address</a> <a id="2067" class="Symbol">→</a> <a id="2069" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="2071" href="libraries.IOlibrary.html#2036" class="Function">checkamount</a> <a id="2083" href="libraries.IOlibrary.html#2083" class="Bound">ledger</a> <a id="2090" href="libraries.IOlibrary.html#2090" class="Bound">addr</a> <a id="2095" class="Symbol">=</a> <a id="2097" href="libraries.IOlibrary.html#2083" class="Bound">ledger</a> <a id="2104" href="libraries.IOlibrary.html#2090" class="Bound">addr</a> <a id="2109" class="Symbol">.</a><a id="2110" href="libraries.Mainlibrary.html#833" class="Field">amount</a>




<a id="2121" class="Comment">-- define state for IO</a>
<a id="2144" class="Keyword">record</a> <a id="StateIO"></a><a id="2151" href="libraries.IOlibrary.html#2151" class="Record">StateIO</a>  <a id="2160" class="Symbol">:</a> <a id="2162" href="Agda.Primitive.html#388" class="Primitive">Set</a>  <a id="2167" class="Keyword">where</a>
       <a id="2180" class="Keyword">constructor</a> <a id="⟨_ledger,_initialAddr,_gas⟩"></a><a id="2192" href="libraries.IOlibrary.html#2192" class="InductiveConstructor Operator">⟨_ledger,_initialAddr,_gas⟩</a>
       <a id="2227" class="Keyword">field</a>
        <a id="StateIO.ledger"></a><a id="2241" href="libraries.IOlibrary.html#2241" class="Field">ledger</a>       <a id="2254" class="Symbol">:</a> <a id="2256" href="libraries.Mainlibrary.html#1069" class="Function">Ledger</a>
        <a id="StateIO.initialAddr"></a><a id="2271" href="libraries.IOlibrary.html#2271" class="Field">initialAddr</a>  <a id="2284" class="Symbol">:</a> <a id="2286" href="basicDataStructure.html#405" class="Function">Address</a>
        <a id="StateIO.gas"></a><a id="2302" href="libraries.IOlibrary.html#2302" class="Field">gas</a>          <a id="2315" class="Symbol">:</a> <a id="2317" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="2319" class="Keyword">open</a> <a id="2324" href="libraries.IOlibrary.html#2151" class="Module">StateIO</a> <a id="2332" class="Keyword">public</a>




</pre></body></html>