<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Simple-Model.ledgerversion.Ledger-Simple-Model</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html" class="Module">Simple-Model.ledgerversion.Ledger-Simple-Model</a> <a id="55" class="Keyword">where</a>

<a id="62" class="Keyword">open</a> <a id="67" class="Keyword">import</a> <a id="74" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="83" class="Keyword">open</a> <a id="88" class="Keyword">import</a> <a id="95" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a> <a id="112" class="Keyword">using</a> <a id="118" class="Symbol">(</a><a id="119" href="Agda.Builtin.Nat.html#426" class="Primitive Operator">_-_</a><a id="122" class="Symbol">)</a>
<a id="124" class="Keyword">open</a> <a id="129" class="Keyword">import</a> <a id="136" href="Data.Unit.html" class="Module">Data.Unit</a>
<a id="146" class="Keyword">open</a> <a id="151" class="Keyword">import</a> <a id="158" href="Data.List.html" class="Module">Data.List</a>
<a id="168" class="Keyword">open</a> <a id="173" class="Keyword">import</a> <a id="180" href="Data.Bool.html" class="Module">Data.Bool</a>
<a id="190" class="Keyword">open</a> <a id="195" class="Keyword">import</a> <a id="202" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>
<a id="217" class="Keyword">open</a> <a id="222" class="Keyword">import</a> <a id="229" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a>
<a id="243" class="Keyword">open</a> <a id="248" class="Keyword">import</a> <a id="255" href="Data.Maybe.html" class="Module">Data.Maybe</a>  <a id="267" class="Keyword">hiding</a> <a id="274" class="Symbol">(</a><a id="275" href="Data.Maybe.Base.html#2256" class="Function Operator">_&gt;&gt;=_</a><a id="280" class="Symbol">)</a>
<a id="282" class="Keyword">open</a> <a id="287" class="Keyword">import</a> <a id="294" href="Data.String.html" class="Module">Data.String</a> <a id="306" class="Keyword">hiding</a> <a id="313" class="Symbol">(</a><a id="314" href="Data.String.Base.html#2468" class="Function">length</a><a id="320" class="Symbol">)</a>

<a id="323" class="Comment">--library for simple model</a>
<a id="350" class="Keyword">open</a> <a id="355" class="Keyword">import</a> <a id="362" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html" class="Module">Simple-Model.library-simple-model.basicDataStructureWithSimpleModel</a>

<a id="431" class="Comment">-- main library</a>
<a id="447" class="Keyword">open</a> <a id="452" class="Keyword">import</a> <a id="459" href="libraries.natCompare.html" class="Module">libraries.natCompare</a>




<a id="484" class="Keyword">mutual</a>


<a id="493" class="Comment">-- smart contract-comands:</a>
  <a id="522" class="Keyword">data</a> <a id="CCommands"></a><a id="527" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#527" class="Datatype">CCommands</a> <a id="537" class="Symbol">:</a> <a id="539" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="543" class="Keyword">where</a>
    <a id="CCommands.transferc"></a><a id="553" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#553" class="InductiveConstructor">transferc</a>  <a id="564" class="Symbol">:</a>  <a id="567" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#510" class="Function">Amount</a> <a id="574" class="Symbol">→</a> <a id="576" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a> <a id="584" class="Symbol">→</a> <a id="586" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#527" class="Datatype">CCommands</a>
    <a id="CCommands.callc"></a><a id="600" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#600" class="InductiveConstructor">callc</a>      <a id="611" class="Symbol">:</a>  <a id="614" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a> <a id="622" class="Symbol">→</a> <a id="624" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#254" class="Function">FunctionName</a> <a id="637" class="Symbol">→</a> <a id="639" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a> <a id="643" class="Symbol">→</a> <a id="645" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#527" class="Datatype">CCommands</a>
    <a id="CCommands.updatec"></a><a id="659" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#659" class="InductiveConstructor">updatec</a>    <a id="670" class="Symbol">:</a>  <a id="673" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#254" class="Function">FunctionName</a> <a id="686" class="Symbol">→</a> <a id="688" class="Symbol">(</a><a id="689" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a> <a id="693" class="Symbol">→</a> <a id="695" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1274" class="Datatype">SmartContract</a> <a id="709" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a><a id="712" class="Symbol">)</a> <a id="714" class="Symbol">→</a> <a id="716" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#527" class="Datatype">CCommands</a>
    <a id="CCommands.currentAddrLookupc"></a><a id="730" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#730" class="InductiveConstructor">currentAddrLookupc</a>  <a id="750" class="Symbol">:</a> <a id="752" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#527" class="Datatype">CCommands</a>
    <a id="CCommands.callAddrLookupc"></a><a id="766" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#766" class="InductiveConstructor">callAddrLookupc</a>     <a id="786" class="Symbol">:</a> <a id="788" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#527" class="Datatype">CCommands</a>
    <a id="CCommands.getAmountc"></a><a id="802" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#802" class="InductiveConstructor">getAmountc</a>          <a id="822" class="Symbol">:</a> <a id="824" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a> <a id="832" class="Symbol">→</a> <a id="834" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#527" class="Datatype">CCommands</a>


<a id="846" class="Comment">-- smart contract response</a>
  <a id="CResponse"></a><a id="875" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#875" class="Function">CResponse</a> <a id="885" class="Symbol">:</a> <a id="887" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#527" class="Datatype">CCommands</a> <a id="897" class="Symbol">→</a> <a id="899" href="Agda.Primitive.html#388" class="Primitive">Set</a>
  <a id="905" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#875" class="Function">CResponse</a> <a id="915" class="Symbol">(</a><a id="916" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#553" class="InductiveConstructor">transferc</a> <a id="926" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#926" class="Bound">amount</a> <a id="933" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#933" class="Bound">addr</a><a id="937" class="Symbol">)</a>  <a id="940" class="Symbol">=</a>  <a id="943" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="947" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#875" class="Function">CResponse</a> <a id="957" class="Symbol">(</a><a id="958" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#600" class="InductiveConstructor">callc</a> <a id="964" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#964" class="Bound">addr</a> <a id="969" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#969" class="Bound">fname</a> <a id="975" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#975" class="Bound">msg</a><a id="978" class="Symbol">)</a>   <a id="982" class="Symbol">=</a>  <a id="985" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a>
  <a id="991" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#875" class="Function">CResponse</a> <a id="1001" class="Symbol">(</a><a id="1002" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#659" class="InductiveConstructor">updatec</a> <a id="1010" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1010" class="Bound">fname</a> <a id="1016" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1016" class="Bound">fdef</a><a id="1020" class="Symbol">)</a>     <a id="1026" class="Symbol">=</a>  <a id="1029" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
  <a id="1033" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#875" class="Function">CResponse</a> <a id="1043" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#730" class="InductiveConstructor">currentAddrLookupc</a>       <a id="1068" class="Symbol">=</a> <a id="1070" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>
  <a id="1080" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#875" class="Function">CResponse</a> <a id="1090" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#766" class="InductiveConstructor">callAddrLookupc</a>          <a id="1115" class="Symbol">=</a> <a id="1117" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>
  <a id="1127" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#875" class="Function">CResponse</a> <a id="1137" class="Symbol">(</a><a id="1138" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#802" class="InductiveConstructor">getAmountc</a> <a id="1149" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1149" class="Bound">addr</a><a id="1153" class="Symbol">)</a>        <a id="1162" class="Symbol">=</a> <a id="1164" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#510" class="Function">Amount</a>



<a id="1174" class="Comment">--SmartContractExec is datatype of what happens when a function is applied to its arguments.</a>
  <a id="1269" class="Keyword">data</a> <a id="SmartContract"></a><a id="1274" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1274" class="Datatype">SmartContract</a> <a id="1288" class="Symbol">(</a><a id="1289" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1289" class="Bound">A</a> <a id="1291" class="Symbol">:</a> <a id="1293" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="1296" class="Symbol">)</a> <a id="1298" class="Symbol">:</a> <a id="1300" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1304" class="Keyword">where</a>
    <a id="SmartContract.return"></a><a id="1314" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1314" class="InductiveConstructor">return</a>  <a id="1322" class="Symbol">:</a>  <a id="1325" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1289" class="Bound">A</a> <a id="1327" class="Symbol">→</a> <a id="1329" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1274" class="Datatype">SmartContract</a> <a id="1343" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1289" class="Bound">A</a>
    <a id="SmartContract.error"></a><a id="1349" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1349" class="InductiveConstructor">error</a>   <a id="1357" class="Symbol">:</a>  <a id="1360" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#572" class="Datatype">ErrorMsg</a> <a id="1369" class="Symbol">→</a> <a id="1371" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1274" class="Datatype">SmartContract</a> <a id="1385" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1289" class="Bound">A</a>
    <a id="SmartContract.exec"></a><a id="1391" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1391" class="InductiveConstructor">exec</a>    <a id="1399" class="Symbol">:</a>  <a id="1402" class="Symbol">(</a><a id="1403" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1403" class="Bound">c</a> <a id="1405" class="Symbol">:</a> <a id="1407" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#527" class="Datatype">CCommands</a><a id="1416" class="Symbol">)</a> <a id="1418" class="Symbol">→</a> <a id="1420" class="Symbol">(</a><a id="1421" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#875" class="Function">CResponse</a> <a id="1431" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1403" class="Bound">c</a> <a id="1433" class="Symbol">→</a> <a id="1435" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1274" class="Datatype">SmartContract</a> <a id="1449" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1289" class="Bound">A</a><a id="1450" class="Symbol">)</a>
            <a id="1464" class="Symbol">→</a> <a id="1466" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1274" class="Datatype">SmartContract</a> <a id="1480" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1289" class="Bound">A</a>


<a id="_&gt;&gt;==_"></a><a id="1484" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1484" class="Function Operator">_&gt;&gt;==_</a> <a id="1491" class="Symbol">:</a> <a id="1493" class="Symbol">{</a><a id="1494" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1494" class="Bound">A</a> <a id="1496" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1496" class="Bound">B</a> <a id="1498" class="Symbol">:</a> <a id="1500" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="1503" class="Symbol">}</a> <a id="1505" class="Symbol">→</a> <a id="1507" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1274" class="Datatype">SmartContract</a> <a id="1521" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1494" class="Bound">A</a> <a id="1523" class="Symbol">→</a> <a id="1525" class="Symbol">(</a><a id="1526" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1494" class="Bound">A</a> <a id="1528" class="Symbol">→</a> <a id="1530" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1274" class="Datatype">SmartContract</a> <a id="1544" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1496" class="Bound">B</a><a id="1545" class="Symbol">)</a> <a id="1547" class="Symbol">→</a> <a id="1549" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1274" class="Datatype">SmartContract</a> <a id="1563" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1496" class="Bound">B</a>
<a id="1565" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1314" class="InductiveConstructor">return</a> <a id="1572" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1572" class="Bound">x</a> <a id="1574" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1484" class="Function Operator">&gt;&gt;==</a> <a id="1579" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1579" class="Bound">q</a> <a id="1581" class="Symbol">=</a> <a id="1583" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1579" class="Bound">q</a> <a id="1585" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1572" class="Bound">x</a>
<a id="1587" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1349" class="InductiveConstructor">error</a> <a id="1593" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1593" class="Bound">x</a> <a id="1595" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1484" class="Function Operator">&gt;&gt;==</a> <a id="1600" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1600" class="Bound">q</a> <a id="1602" class="Symbol">=</a> <a id="1604" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1349" class="InductiveConstructor">error</a> <a id="1610" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1593" class="Bound">x</a>
<a id="1612" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1391" class="InductiveConstructor">exec</a> <a id="1617" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1617" class="Bound">c</a> <a id="1619" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1619" class="Bound">x</a> <a id="1621" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1484" class="Function Operator">&gt;&gt;==</a> <a id="1626" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1626" class="Bound">q</a> <a id="1628" class="Symbol">=</a> <a id="1630" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1391" class="InductiveConstructor">exec</a> <a id="1635" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1617" class="Bound">c</a> <a id="1637" class="Symbol">(λ</a> <a id="1640" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1640" class="Bound">r</a> <a id="1642" class="Symbol">→</a> <a id="1644" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1619" class="Bound">x</a> <a id="1646" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1640" class="Bound">r</a> <a id="1648" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1484" class="Function Operator">&gt;&gt;==</a> <a id="1653" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1626" class="Bound">q</a><a id="1654" class="Symbol">)</a>


<a id="_&gt;&gt;_"></a><a id="1658" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1658" class="Function Operator">_&gt;&gt;_</a> <a id="1663" class="Symbol">:</a> <a id="1665" class="Symbol">{</a><a id="1666" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1666" class="Bound">A</a> <a id="1668" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1668" class="Bound">B</a> <a id="1670" class="Symbol">:</a> <a id="1672" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="1675" class="Symbol">}</a> <a id="1677" class="Symbol">→</a> <a id="1679" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1274" class="Datatype">SmartContract</a> <a id="1693" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1666" class="Bound">A</a> <a id="1695" class="Symbol">→</a> <a id="1697" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1274" class="Datatype">SmartContract</a> <a id="1711" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1668" class="Bound">B</a> <a id="1713" class="Symbol">→</a> <a id="1715" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1274" class="Datatype">SmartContract</a> <a id="1729" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1668" class="Bound">B</a>
<a id="1731" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1314" class="InductiveConstructor">return</a> <a id="1738" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1738" class="Bound">x</a> <a id="1740" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1658" class="Function Operator">&gt;&gt;</a> <a id="1743" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1743" class="Bound">q</a> <a id="1745" class="Symbol">=</a> <a id="1747" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1743" class="Bound">q</a>
<a id="1749" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1349" class="InductiveConstructor">error</a> <a id="1755" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1755" class="Bound">x</a> <a id="1757" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1658" class="Function Operator">&gt;&gt;</a> <a id="1760" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1760" class="Bound">q</a> <a id="1762" class="Symbol">=</a> <a id="1764" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1349" class="InductiveConstructor">error</a> <a id="1770" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1755" class="Bound">x</a>
<a id="1772" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1391" class="InductiveConstructor">exec</a> <a id="1777" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1777" class="Bound">c</a> <a id="1779" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1779" class="Bound">x</a> <a id="1781" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1658" class="Function Operator">&gt;&gt;</a> <a id="1784" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1784" class="Bound">q</a> <a id="1786" class="Symbol">=</a> <a id="1788" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1391" class="InductiveConstructor">exec</a> <a id="1793" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1777" class="Bound">c</a> <a id="1795" class="Symbol">(λ</a> <a id="1798" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1798" class="Bound">r</a> <a id="1800" class="Symbol">→</a> <a id="1802" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1779" class="Bound">x</a> <a id="1804" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1798" class="Bound">r</a> <a id="1806" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1658" class="Function Operator">&gt;&gt;</a> <a id="1809" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1784" class="Bound">q</a><a id="1810" class="Symbol">)</a>



<a id="1815" class="Comment">-- Definition of simple contract</a>
<a id="1848" class="Keyword">record</a> <a id="Contract"></a><a id="1855" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1855" class="Record">Contract</a> <a id="1864" class="Symbol">:</a> <a id="1866" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1870" class="Keyword">where</a>
  <a id="1878" class="Keyword">constructor</a> <a id="contract"></a><a id="1890" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1890" class="InductiveConstructor">contract</a>
  <a id="1901" class="Keyword">field</a>
    <a id="Contract.amount"></a><a id="1911" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1911" class="Field">amount</a>  <a id="1919" class="Symbol">:</a>  <a id="1922" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#510" class="Function">Amount</a>
    <a id="Contract.fun"></a><a id="1933" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1933" class="Field">fun</a>     <a id="1941" class="Symbol">:</a>  <a id="1944" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#254" class="Function">FunctionName</a> <a id="1957" class="Symbol">→</a> <a id="1959" class="Symbol">(</a><a id="1960" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a> <a id="1964" class="Symbol">→</a> <a id="1966" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1274" class="Datatype">SmartContract</a> <a id="1980" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a><a id="1983" class="Symbol">)</a>
<a id="1985" class="Keyword">open</a> <a id="1990" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1855" class="Module">Contract</a> <a id="1999" class="Keyword">public</a>



<a id="2009" class="Comment">-- ledger</a>
<a id="Ledger"></a><a id="2019" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2019" class="Function">Ledger</a> <a id="2026" class="Symbol">:</a> <a id="2028" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="2032" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2019" class="Function">Ledger</a> <a id="2039" class="Symbol">=</a> <a id="2041" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>  <a id="2050" class="Symbol">→</a> <a id="2052" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1855" class="Record">Contract</a>


<a id="2063" class="Comment">--- theses functions below we use them with do notation</a>
<a id="call"></a><a id="2119" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2119" class="Function">call</a> <a id="2124" class="Symbol">:</a> <a id="2126" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>  <a id="2135" class="Symbol">→</a> <a id="2137" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#254" class="Function">FunctionName</a> <a id="2150" class="Symbol">→</a> <a id="2152" class="Symbol">(</a><a id="2153" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a> <a id="2157" class="Symbol">→</a> <a id="2159" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1274" class="Datatype">SmartContract</a> <a id="2173" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a><a id="2176" class="Symbol">)</a>
<a id="2178" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2119" class="Function">call</a> <a id="2183" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2183" class="Bound">addr</a> <a id="2188" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2188" class="Bound">fname</a> <a id="2194" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2194" class="Bound">msg</a> <a id="2198" class="Symbol">=</a> <a id="2200" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1391" class="InductiveConstructor">exec</a> <a id="2205" class="Symbol">(</a><a id="2206" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#600" class="InductiveConstructor">callc</a> <a id="2212" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2183" class="Bound">addr</a> <a id="2217" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2188" class="Bound">fname</a> <a id="2223" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2194" class="Bound">msg</a><a id="2226" class="Symbol">)</a> <a id="2228" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1314" class="InductiveConstructor">return</a>

<a id="update"></a><a id="2236" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2236" class="Function">update</a> <a id="2243" class="Symbol">:</a> <a id="2245" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#254" class="Function">FunctionName</a> <a id="2258" class="Symbol">→</a> <a id="2260" class="Symbol">(</a><a id="2261" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a> <a id="2265" class="Symbol">→</a> <a id="2267" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1274" class="Datatype">SmartContract</a> <a id="2281" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a><a id="2284" class="Symbol">)</a> <a id="2286" class="Symbol">→</a> <a id="2288" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1274" class="Datatype">SmartContract</a> <a id="2302" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="2304" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2236" class="Function">update</a> <a id="2311" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2311" class="Bound">fname</a> <a id="2317" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2317" class="Bound">fdef</a> <a id="2322" class="Symbol">=</a> <a id="2324" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1391" class="InductiveConstructor">exec</a> <a id="2329" class="Symbol">(</a><a id="2330" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#659" class="InductiveConstructor">updatec</a> <a id="2338" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2311" class="Bound">fname</a> <a id="2344" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2317" class="Bound">fdef</a><a id="2348" class="Symbol">)</a> <a id="2350" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1314" class="InductiveConstructor">return</a>

<a id="currentAddrLookup"></a><a id="2358" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2358" class="Function">currentAddrLookup</a> <a id="2376" class="Symbol">:</a> <a id="2378" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1274" class="Datatype">SmartContract</a> <a id="2392" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>
<a id="2400" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2358" class="Function">currentAddrLookup</a> <a id="2418" class="Symbol">=</a> <a id="2420" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1391" class="InductiveConstructor">exec</a> <a id="2425" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#730" class="InductiveConstructor">currentAddrLookupc</a> <a id="2444" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1314" class="InductiveConstructor">return</a>

<a id="callAddrLookup"></a><a id="2452" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2452" class="Function">callAddrLookup</a> <a id="2467" class="Symbol">:</a> <a id="2469" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1274" class="Datatype">SmartContract</a> <a id="2483" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>
<a id="2491" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2452" class="Function">callAddrLookup</a> <a id="2506" class="Symbol">=</a> <a id="2508" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1391" class="InductiveConstructor">exec</a> <a id="2513" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#766" class="InductiveConstructor">callAddrLookupc</a> <a id="2529" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1314" class="InductiveConstructor">return</a>

<a id="transfer"></a><a id="2537" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2537" class="Function">transfer</a> <a id="2546" class="Symbol">:</a> <a id="2548" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#510" class="Function">Amount</a> <a id="2555" class="Symbol">→</a> <a id="2557" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a> <a id="2565" class="Symbol">→</a> <a id="2567" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1274" class="Datatype">SmartContract</a> <a id="2581" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="2583" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2537" class="Function">transfer</a> <a id="2592" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2592" class="Bound">amount</a> <a id="2599" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2599" class="Bound">addr</a> <a id="2604" class="Symbol">=</a>  <a id="2607" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1391" class="InductiveConstructor">exec</a> <a id="2612" class="Symbol">(</a><a id="2613" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#553" class="InductiveConstructor">transferc</a> <a id="2623" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2592" class="Bound">amount</a> <a id="2630" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2599" class="Bound">addr</a><a id="2634" class="Symbol">)</a> <a id="2636" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1314" class="InductiveConstructor">return</a>



<a id="2646" class="Comment">-- the definition of execution stack elements</a>
<a id="2692" class="Keyword">record</a> <a id="ExecStackEl"></a><a id="2699" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2699" class="Record">ExecStackEl</a> <a id="2711" class="Symbol">:</a> <a id="2713" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="2717" class="Keyword">where</a>
  <a id="2725" class="Keyword">constructor</a> <a id="execStackEl"></a><a id="2737" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2737" class="InductiveConstructor">execStackEl</a>
  <a id="2751" class="Keyword">field</a>
    <a id="ExecStackEl.lastCallAddress"></a><a id="2761" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2761" class="Field">lastCallAddress</a>  <a id="2778" class="Symbol">:</a>  <a id="2781" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>
    <a id="ExecStackEl.calledAddress"></a><a id="2793" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2793" class="Field">calledAddress</a>    <a id="2810" class="Symbol">:</a>  <a id="2813" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>
    <a id="ExecStackEl.continuation"></a><a id="2825" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2825" class="Field">continuation</a>     <a id="2842" class="Symbol">:</a>  <a id="2845" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a> <a id="2849" class="Symbol">→</a> <a id="2851" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1274" class="Datatype">SmartContract</a> <a id="2865" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a>
<a id="2869" class="Keyword">open</a> <a id="2874" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2699" class="Module">ExecStackEl</a> <a id="2886" class="Keyword">public</a>


<a id="2895" class="Comment">-- the definition of the execution stack function function</a>
<a id="ExecutionStack"></a><a id="2954" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2954" class="Function">ExecutionStack</a> <a id="2969" class="Symbol">:</a> <a id="2971" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="2975" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2954" class="Function">ExecutionStack</a> <a id="2990" class="Symbol">=</a> <a id="2992" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2997" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2699" class="Record">ExecStackEl</a>



<a id="3012" class="Comment">{- StateExecFun is an intermediate state when we are evaluating a function call
   in a contract
   it consists of
        - the ledger  (which might changed because of updates)
        - executionStack  contains partially evaluated calls to other contracts together with their addresses
        - the current address
        - and the currently partially evaluated function we are evaluating
-}</a>
<a id="3408" class="Keyword">record</a> <a id="StateExecFun"></a><a id="3415" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3415" class="Record">StateExecFun</a> <a id="3428" class="Symbol">:</a> <a id="3430" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="3434" class="Keyword">where</a>
  <a id="3442" class="Keyword">constructor</a> <a id="stateEF"></a><a id="3454" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3454" class="InductiveConstructor">stateEF</a>
  <a id="3464" class="Keyword">field</a>
    <a id="StateExecFun.ledger"></a><a id="3474" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3474" class="Field">ledger</a>           <a id="3491" class="Symbol">:</a>  <a id="3494" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2019" class="Function">Ledger</a>
    <a id="StateExecFun.executionStack"></a><a id="3505" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3505" class="Field">executionStack</a>   <a id="3522" class="Symbol">:</a>  <a id="3525" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2954" class="Function">ExecutionStack</a>
    <a id="StateExecFun.lastCallAddress"></a><a id="3544" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3544" class="Field">lastCallAddress</a>  <a id="3561" class="Symbol">:</a>  <a id="3564" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>
    <a id="StateExecFun.currentAddress"></a><a id="3576" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3576" class="Field">currentAddress</a>   <a id="3593" class="Symbol">:</a>  <a id="3596" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>
    <a id="StateExecFun.nextstep"></a><a id="3608" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3608" class="Field">nextstep</a>         <a id="3625" class="Symbol">:</a>  <a id="3628" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1274" class="Datatype">SmartContract</a> <a id="3642" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a>
<a id="3646" class="Keyword">open</a> <a id="3651" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3415" class="Module">StateExecFun</a> <a id="3664" class="Keyword">public</a>



<a id="3674" class="Comment">--update ledger</a>
<a id="updateLedger"></a><a id="3690" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3690" class="Function">updateLedger</a> <a id="3703" class="Symbol">:</a> <a id="3705" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2019" class="Function">Ledger</a> <a id="3712" class="Symbol">→</a>  <a id="3715" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a> <a id="3723" class="Symbol">→</a> <a id="3725" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#254" class="Function">FunctionName</a> <a id="3738" class="Symbol">→</a> <a id="3740" class="Symbol">(</a><a id="3741" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a> <a id="3745" class="Symbol">→</a> <a id="3747" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1274" class="Datatype">SmartContract</a> <a id="3761" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a><a id="3764" class="Symbol">)</a> <a id="3766" class="Symbol">→</a> <a id="3768" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2019" class="Function">Ledger</a>
<a id="3775" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3690" class="Function">updateLedger</a> <a id="3788" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3788" class="Bound">ledger</a> <a id="3795" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3795" class="Bound">changedAddr</a> <a id="3807" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3807" class="Bound">changedFname</a> <a id="3820" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3820" class="Bound">f</a> <a id="3822" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3822" class="Bound">a</a> <a id="3824" class="Symbol">.</a><a id="3825" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1911" class="Field">amount</a>    <a id="3835" class="Symbol">=</a> <a id="3837" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3788" class="Bound">ledger</a> <a id="3844" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3822" class="Bound">a</a> <a id="3846" class="Symbol">.</a><a id="3847" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1911" class="Field">amount</a>
<a id="3854" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3690" class="Function">updateLedger</a> <a id="3867" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3867" class="Bound">ledger</a> <a id="3874" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3874" class="Bound">changedAddr</a> <a id="3886" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3886" class="Bound">changedFname</a> <a id="3899" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3899" class="Bound">f</a> <a id="3901" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3901" class="Bound">a</a> <a id="3903" class="Symbol">.</a><a id="3904" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1933" class="Field">fun</a> <a id="3908" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3908" class="Bound">fname</a> <a id="3914" class="Symbol">=</a> <a id="3916" href="Data.Bool.Base.html#1505" class="Function Operator">if</a> <a id="3919" class="Symbol">(</a><a id="3920" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3901" class="Bound">a</a> <a id="3922" href="Data.Nat.Base.html#1283" class="Primitive Operator">≡ᵇ</a> <a id="3925" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3874" class="Bound">changedAddr</a><a id="3936" class="Symbol">)</a> <a id="3938" href="Data.Bool.Base.html#995" class="Function Operator">∧</a> <a id="3940" class="Symbol">(</a><a id="3941" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3908" class="Bound">fname</a> <a id="3947" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#297" class="Function Operator">≡fun</a> <a id="3952" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3886" class="Bound">changedFname</a><a id="3964" class="Symbol">)</a>
                                                              <a id="4028" href="Data.Bool.Base.html#1505" class="Function Operator">then</a> <a id="4033" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3899" class="Bound">f</a> <a id="4035" href="Data.Bool.Base.html#1505" class="Function Operator">else</a> <a id="4040" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3867" class="Bound">ledger</a> <a id="4047" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3901" class="Bound">a</a> <a id="4049" class="Symbol">.</a><a id="4050" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1933" class="Field">fun</a> <a id="4054" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3908" class="Bound">fname</a>


<a id="4062" class="Comment">--update ledger amount</a>
<a id="updateLedgerAmount"></a><a id="4085" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4085" class="Function">updateLedgerAmount</a> <a id="4104" class="Symbol">:</a> <a id="4106" class="Symbol">(</a><a id="4107" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4107" class="Bound">ledger</a> <a id="4114" class="Symbol">:</a> <a id="4116" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2019" class="Function">Ledger</a><a id="4122" class="Symbol">)</a>
                     <a id="4145" class="Symbol">→</a> <a id="4147" class="Symbol">(</a><a id="4148" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4148" class="Bound">currentAddr</a> <a id="4160" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4160" class="Bound">destinationAddr</a> <a id="4176" class="Symbol">:</a> <a id="4178" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a><a id="4185" class="Symbol">)</a> <a id="4187" class="Symbol">(</a><a id="4188" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4188" class="Bound">amount&#39;</a> <a id="4196" class="Symbol">:</a> <a id="4198" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#510" class="Function">Amount</a><a id="4204" class="Symbol">)</a>
                     <a id="4227" class="Symbol">→</a> <a id="4229" class="Symbol">(</a><a id="4230" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4230" class="Bound">correctAmount</a> <a id="4244" class="Symbol">:</a> <a id="4246" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4188" class="Bound">amount&#39;</a> <a id="4254" href="libraries.natCompare.html#508" class="Function Operator">≦r</a>  <a id="4258" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4107" class="Bound">ledger</a> <a id="4265" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4148" class="Bound">currentAddr</a> <a id="4277" class="Symbol">.</a><a id="4278" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1911" class="Field">amount</a><a id="4284" class="Symbol">)</a>
                     <a id="4307" class="Symbol">→</a> <a id="4309" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2019" class="Function">Ledger</a>
<a id="4316" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4085" class="Function">updateLedgerAmount</a> <a id="4335" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4335" class="Bound">ledger</a> <a id="4342" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4342" class="Bound">currentAddr</a> <a id="4354" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4354" class="Bound">destinationAddr</a> <a id="4370" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4370" class="Bound">amount&#39;</a> <a id="4378" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4378" class="Bound">correctAmount</a> <a id="4392" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4392" class="Bound">addr</a> <a id="4397" class="Symbol">.</a><a id="4398" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1911" class="Field">amount</a>
     <a id="4410" class="Symbol">=</a> <a id="4412" href="Data.Bool.Base.html#1505" class="Function Operator">if</a> <a id="4415" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4392" class="Bound">addr</a> <a id="4420" href="Data.Nat.Base.html#1283" class="Primitive Operator">≡ᵇ</a> <a id="4423" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4342" class="Bound">currentAddr</a>
     <a id="4440" href="Data.Bool.Base.html#1505" class="Function Operator">then</a> <a id="4445" href="libraries.natCompare.html#1529" class="Function">subtract</a> <a id="4454" class="Symbol">(</a><a id="4455" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4335" class="Bound">ledger</a> <a id="4462" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4342" class="Bound">currentAddr</a> <a id="4474" class="Symbol">.</a><a id="4475" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1911" class="Field">amount</a><a id="4481" class="Symbol">)</a> <a id="4483" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4370" class="Bound">amount&#39;</a> <a id="4491" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4378" class="Bound">correctAmount</a>
     <a id="4510" href="Data.Bool.Base.html#1505" class="Function Operator">else</a> <a id="4515" class="Symbol">(</a><a id="4516" href="Data.Bool.Base.html#1505" class="Function Operator">if</a> <a id="4519" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4392" class="Bound">addr</a> <a id="4524" href="Data.Nat.Base.html#1283" class="Primitive Operator">≡ᵇ</a> <a id="4527" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4354" class="Bound">destinationAddr</a>
     <a id="4548" href="Data.Bool.Base.html#1505" class="Function Operator">then</a> <a id="4553" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4335" class="Bound">ledger</a> <a id="4560" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4354" class="Bound">destinationAddr</a> <a id="4576" class="Symbol">.</a><a id="4577" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1911" class="Field">amount</a> <a id="4584" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">+</a> <a id="4586" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4370" class="Bound">amount&#39;</a>
     <a id="4599" href="Data.Bool.Base.html#1505" class="Function Operator">else</a> <a id="4604" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4335" class="Bound">ledger</a> <a id="4611" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4392" class="Bound">addr</a> <a id="4616" class="Symbol">.</a><a id="4617" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1911" class="Field">amount</a><a id="4623" class="Symbol">)</a>
<a id="4625" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4085" class="Function">updateLedgerAmount</a> <a id="4644" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4644" class="Bound">ledger</a> <a id="4651" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4651" class="Bound">currentAddr</a> <a id="4663" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4663" class="Bound">newAddr</a> <a id="4671" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4671" class="Bound">amount&#39;</a> <a id="4679" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4679" class="Bound">correctAmount</a> <a id="4693" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4693" class="Bound">addr</a> <a id="4698" class="Symbol">.</a><a id="4699" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1933" class="Field">fun</a>
     <a id="4708" class="Symbol">=</a> <a id="4710" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4644" class="Bound">ledger</a> <a id="4717" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4693" class="Bound">addr</a> <a id="4722" class="Symbol">.</a><a id="4723" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1933" class="Field">fun</a>


<a id="4729" class="Comment">-- execute transfer auxiliary</a>
<a id="executeTransferAux"></a><a id="4759" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4759" class="Function">executeTransferAux</a> <a id="4778" class="Symbol">:</a> <a id="4780" class="Symbol">(</a><a id="4781" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4781" class="Bound">oldLedger</a> <a id="4791" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4791" class="Bound">currentLedger</a> <a id="4805" class="Symbol">:</a> <a id="4807" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2019" class="Function">Ledger</a><a id="4813" class="Symbol">)</a>
                  <a id="4833" class="Symbol">→</a> <a id="4835" class="Symbol">(</a><a id="4836" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4836" class="Bound">executionStack</a> <a id="4851" class="Symbol">:</a> <a id="4853" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2954" class="Function">ExecutionStack</a><a id="4867" class="Symbol">)</a>
                  <a id="4887" class="Symbol">→</a> <a id="4889" class="Symbol">(</a><a id="4890" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4890" class="Bound">callAddr</a> <a id="4899" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4899" class="Bound">currentAddr</a> <a id="4911" class="Symbol">:</a> <a id="4913" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a><a id="4920" class="Symbol">)</a>
                  <a id="4940" class="Symbol">→</a> <a id="4942" class="Symbol">(</a><a id="4943" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4943" class="Bound">amount&#39;</a> <a id="4951" class="Symbol">:</a> <a id="4953" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#510" class="Function">Amount</a><a id="4959" class="Symbol">)</a>
                  <a id="4979" class="Symbol">→</a> <a id="4981" class="Symbol">(</a><a id="4982" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4982" class="Bound">destinationAddr</a> <a id="4998" class="Symbol">:</a> <a id="5000" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a><a id="5007" class="Symbol">)</a>
                  <a id="5027" class="Symbol">→</a> <a id="5029" class="Symbol">(</a><a id="5030" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5030" class="Bound">cont</a> <a id="5035" class="Symbol">:</a> <a id="5037" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1274" class="Datatype">SmartContract</a> <a id="5051" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a><a id="5054" class="Symbol">)</a>
                  <a id="5074" class="Symbol">→</a> <a id="5076" class="Symbol">(</a><a id="5077" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5077" class="Bound">cp</a>  <a id="5081" class="Symbol">:</a> <a id="5083" href="libraries.natCompare.html#679" class="Datatype">OrderingLeq</a> <a id="5095" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4943" class="Bound">amount&#39;</a> <a id="5103" class="Symbol">(</a><a id="5104" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4791" class="Bound">currentLedger</a> <a id="5118" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4899" class="Bound">currentAddr</a> <a id="5130" class="Symbol">.</a><a id="5131" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1911" class="Field">amount</a>  <a id="5139" class="Symbol">))</a>
                  <a id="5160" class="Symbol">→</a> <a id="5162" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3415" class="Record">StateExecFun</a>
<a id="5175" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4759" class="Function">executeTransferAux</a> <a id="5194" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5194" class="Bound">oldLedger</a> <a id="5204" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5204" class="Bound">currentLedger</a> <a id="5218" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5218" class="Bound">executionStack</a> <a id="5233" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5233" class="Bound">callAddr</a> <a id="5242" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5242" class="Bound">currentAddr</a> <a id="5254" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5254" class="Bound">amount&#39;</a> <a id="5262" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5262" class="Bound">destinationAddr</a> <a id="5278" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5278" class="Bound">cont</a> <a id="5283" class="Symbol">(</a><a id="5284" href="libraries.natCompare.html#717" class="InductiveConstructor">leq</a> <a id="5288" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5288" class="Bound">x</a><a id="5289" class="Symbol">)</a> <a id="5291" class="Symbol">=</a>
          <a id="5303" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3454" class="InductiveConstructor">stateEF</a> <a id="5311" class="Symbol">(</a><a id="5312" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4085" class="Function">updateLedgerAmount</a> <a id="5331" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5204" class="Bound">currentLedger</a> <a id="5345" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5242" class="Bound">currentAddr</a> <a id="5357" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5262" class="Bound">destinationAddr</a> <a id="5373" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5254" class="Bound">amount&#39;</a> <a id="5381" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5288" class="Bound">x</a><a id="5382" class="Symbol">)</a>
             <a id="5397" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5218" class="Bound">executionStack</a> <a id="5412" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5233" class="Bound">callAddr</a> <a id="5421" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5242" class="Bound">currentAddr</a> <a id="5433" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5278" class="Bound">cont</a>

<a id="5439" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4759" class="Function">executeTransferAux</a> <a id="5458" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5458" class="Bound">oldLedger</a> <a id="5468" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5468" class="Bound">currentLedger</a> <a id="5482" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5482" class="Bound">executionStack</a> <a id="5497" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5497" class="Bound">callAddr</a> <a id="5506" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5506" class="Bound">currentAddr</a> <a id="5518" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5518" class="Bound">amount</a> <a id="5525" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5525" class="Bound">destinationAddr</a> <a id="5541" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5541" class="Bound">cont</a> <a id="5546" class="Symbol">(</a><a id="5547" href="libraries.natCompare.html#755" class="InductiveConstructor">greater</a> <a id="5555" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5555" class="Bound">x</a><a id="5556" class="Symbol">)</a> <a id="5558" class="Symbol">=</a>
         <a id="5569" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3454" class="InductiveConstructor">stateEF</a> <a id="5577" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5458" class="Bound">oldLedger</a> <a id="5587" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5482" class="Bound">executionStack</a> <a id="5602" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5497" class="Bound">callAddr</a> <a id="5611" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5506" class="Bound">currentAddr</a>
             <a id="5636" class="Symbol">(</a><a id="5637" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1349" class="InductiveConstructor">error</a> <a id="5643" class="Symbol">(</a><a id="5644" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#595" class="InductiveConstructor">strErr</a> <a id="5651" class="String">&quot;not enough money&quot;</a><a id="5669" class="Symbol">))</a>

<a id="5673" class="Comment">-- -- execute transfer</a>
<a id="executeTransfer"></a><a id="5696" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5696" class="Function">executeTransfer</a> <a id="5712" class="Symbol">:</a> <a id="5714" class="Symbol">(</a><a id="5715" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5715" class="Bound">oldLedger</a> <a id="5725" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5725" class="Bound">currentLedger</a> <a id="5739" class="Symbol">:</a> <a id="5741" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2019" class="Function">Ledger</a><a id="5747" class="Symbol">)</a>
                  <a id="5767" class="Symbol">→</a> <a id="5769" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2954" class="Function">ExecutionStack</a>
                  <a id="5802" class="Symbol">→</a> <a id="5804" class="Symbol">(</a><a id="5805" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5805" class="Bound">callAddr</a> <a id="5814" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5814" class="Bound">currentAddr</a> <a id="5826" class="Symbol">:</a> <a id="5828" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a><a id="5835" class="Symbol">)</a>
                  <a id="5855" class="Symbol">→</a> <a id="5857" class="Symbol">(</a><a id="5858" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5858" class="Bound">amount&#39;</a> <a id="5866" class="Symbol">:</a> <a id="5868" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#510" class="Function">Amount</a><a id="5874" class="Symbol">)</a>
                  <a id="5894" class="Symbol">→</a> <a id="5896" class="Symbol">(</a><a id="5897" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5897" class="Bound">destinationAddr</a> <a id="5913" class="Symbol">:</a> <a id="5915" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a><a id="5922" class="Symbol">)</a>
                  <a id="5942" class="Symbol">→</a> <a id="5944" class="Symbol">(</a><a id="5945" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5945" class="Bound">cont</a> <a id="5950" class="Symbol">:</a> <a id="5952" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1274" class="Datatype">SmartContract</a> <a id="5966" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a><a id="5969" class="Symbol">)</a>
                  <a id="5989" class="Symbol">→</a> <a id="5991" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3415" class="Record">StateExecFun</a>
<a id="6004" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5696" class="Function">executeTransfer</a> <a id="6020" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6020" class="Bound">oldLedger</a> <a id="6030" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6030" class="Bound">currentLedger</a> <a id="6044" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6044" class="Bound">exexecutionStack</a> <a id="6061" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6061" class="Bound">callAddr</a> <a id="6070" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6070" class="Bound">currentAddr</a> <a id="6082" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6082" class="Bound">amount&#39;</a> <a id="6090" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6090" class="Bound">destinationAddr</a> <a id="6106" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6106" class="Bound">cont</a>
                <a id="6127" class="Symbol">=</a> <a id="6129" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#4759" class="Function">executeTransferAux</a> <a id="6148" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6020" class="Bound">oldLedger</a> <a id="6158" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6030" class="Bound">currentLedger</a> <a id="6172" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6044" class="Bound">exexecutionStack</a> <a id="6189" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6061" class="Bound">callAddr</a> <a id="6198" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6070" class="Bound">currentAddr</a> <a id="6210" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6082" class="Bound">amount&#39;</a>
                   <a id="6237" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6090" class="Bound">destinationAddr</a> <a id="6253" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6106" class="Bound">cont</a>  <a id="6259" class="Symbol">(</a><a id="6260" href="libraries.natCompare.html#936" class="Function">compareLeq</a> <a id="6271" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6082" class="Bound">amount&#39;</a> <a id="6279" class="Symbol">(</a><a id="6280" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6030" class="Bound">currentLedger</a> <a id="6294" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6070" class="Bound">currentAddr</a> <a id="6306" class="Symbol">.</a><a id="6307" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1911" class="Field">amount</a>  <a id="6315" class="Symbol">))</a>

<a id="6319" class="Comment">-- definition of stepEF</a>
<a id="stepEF"></a><a id="6343" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6343" class="Function">stepEF</a> <a id="6350" class="Symbol">:</a> <a id="6352" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2019" class="Function">Ledger</a> <a id="6359" class="Symbol">→</a> <a id="6361" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3415" class="Record">StateExecFun</a> <a id="6374" class="Symbol">→</a> <a id="6376" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3415" class="Record">StateExecFun</a>
<a id="6389" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6343" class="Function">stepEF</a> <a id="6396" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6396" class="Bound">oldLedger</a> <a id="6406" class="Symbol">(</a><a id="6407" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3454" class="InductiveConstructor">stateEF</a> <a id="6415" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6415" class="Bound">currentLedger</a> <a id="6429" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="6432" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6432" class="Bound">callAddr</a> <a id="6441" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6441" class="Bound">currentAddr</a> <a id="6453" class="Symbol">(</a><a id="6454" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1314" class="InductiveConstructor">return</a> <a id="6461" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6461" class="Bound">result</a><a id="6467" class="Symbol">))</a>
       <a id="6477" class="Symbol">=</a> <a id="6479" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3454" class="InductiveConstructor">stateEF</a> <a id="6487" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6415" class="Bound">currentLedger</a>  <a id="6502" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="6505" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6432" class="Bound">callAddr</a> <a id="6514" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6441" class="Bound">currentAddr</a> <a id="6526" class="Symbol">(</a><a id="6527" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1314" class="InductiveConstructor">return</a> <a id="6534" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6461" class="Bound">result</a><a id="6540" class="Symbol">)</a>
<a id="6542" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6343" class="Function">stepEF</a> <a id="6549" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6549" class="Bound">oldLedger</a> <a id="6559" class="Symbol">(</a><a id="6560" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3454" class="InductiveConstructor">stateEF</a> <a id="6568" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6568" class="Bound">currentLedger</a> <a id="6582" class="Symbol">(</a><a id="6583" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6583" class="Bound">execSEl</a> <a id="6591" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="6593" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6593" class="Bound">executionStack</a><a id="6607" class="Symbol">)</a> <a id="6609" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6609" class="Bound">callAddr</a> <a id="6618" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6618" class="Bound">currentAddr</a> <a id="6630" class="Symbol">(</a><a id="6631" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1314" class="InductiveConstructor">return</a> <a id="6638" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6638" class="Bound">result</a><a id="6644" class="Symbol">))</a>
       <a id="6654" class="Symbol">=</a> <a id="6656" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3454" class="InductiveConstructor">stateEF</a> <a id="6664" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6568" class="Bound">currentLedger</a> <a id="6678" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6593" class="Bound">executionStack</a> <a id="6693" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6609" class="Bound">callAddr</a>  <a id="6703" class="Symbol">(</a><a id="6704" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6583" class="Bound">execSEl</a> <a id="6712" class="Symbol">.</a><a id="6713" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2793" class="Field">calledAddress</a><a id="6726" class="Symbol">)</a> <a id="6728" class="Symbol">(</a><a id="6729" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6583" class="Bound">execSEl</a> <a id="6737" class="Symbol">.</a><a id="6738" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2825" class="Field">continuation</a> <a id="6751" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6638" class="Bound">result</a><a id="6757" class="Symbol">)</a>
<a id="6759" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6343" class="CatchallClause Function">stepEF</a><a id="6765" class="CatchallClause"> </a><a id="6766" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6766" class="CatchallClause Bound">oldLedger</a><a id="6775" class="CatchallClause"> </a><a id="6776" class="CatchallClause Symbol">(</a><a id="6777" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3454" class="CatchallClause InductiveConstructor">stateEF</a><a id="6784" class="CatchallClause"> </a><a id="6785" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6785" class="CatchallClause Bound">currentLedger</a><a id="6798" class="CatchallClause"> </a><a id="6799" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6799" class="CatchallClause Bound">executionStack</a><a id="6813" class="CatchallClause"> </a><a id="6814" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6814" class="CatchallClause Bound">callAddr</a><a id="6822" class="CatchallClause"> </a><a id="6823" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6823" class="CatchallClause Bound">currentAddr</a><a id="6834" class="CatchallClause"> </a><a id="6835" class="CatchallClause Symbol">(</a><a id="6836" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1391" class="CatchallClause InductiveConstructor">exec</a><a id="6840" class="CatchallClause"> </a><a id="6841" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#730" class="CatchallClause InductiveConstructor">currentAddrLookupc</a><a id="6859" class="CatchallClause"> </a><a id="6860" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6860" class="CatchallClause Bound">cont</a><a id="6864" class="CatchallClause Symbol">))</a>
       <a id="6874" class="Symbol">=</a> <a id="6876" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3454" class="InductiveConstructor">stateEF</a> <a id="6884" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6785" class="Bound">currentLedger</a> <a id="6898" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6799" class="Bound">executionStack</a> <a id="6913" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6814" class="Bound">callAddr</a> <a id="6922" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6823" class="Bound">currentAddr</a> <a id="6934" class="Symbol">(</a><a id="6935" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6860" class="Bound">cont</a> <a id="6940" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6823" class="Bound">currentAddr</a><a id="6951" class="Symbol">)</a>
<a id="6953" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6343" class="CatchallClause Function">stepEF</a><a id="6959" class="CatchallClause"> </a><a id="6960" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6960" class="CatchallClause Bound">oldLedger</a><a id="6969" class="CatchallClause"> </a><a id="6970" class="CatchallClause Symbol">(</a><a id="6971" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3454" class="CatchallClause InductiveConstructor">stateEF</a><a id="6978" class="CatchallClause"> </a><a id="6979" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6979" class="CatchallClause Bound">currentLedger</a><a id="6992" class="CatchallClause"> </a><a id="6993" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6993" class="CatchallClause Bound">executionStack</a><a id="7007" class="CatchallClause"> </a><a id="7008" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7008" class="CatchallClause Bound">callAddr</a><a id="7016" class="CatchallClause"> </a><a id="7017" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7017" class="CatchallClause Bound">currentAddr</a><a id="7028" class="CatchallClause"> </a><a id="7029" class="CatchallClause Symbol">(</a><a id="7030" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1391" class="CatchallClause InductiveConstructor">exec</a><a id="7034" class="CatchallClause"> </a><a id="7035" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#766" class="CatchallClause InductiveConstructor">callAddrLookupc</a><a id="7050" class="CatchallClause"> </a><a id="7051" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7051" class="CatchallClause Bound">cont</a><a id="7055" class="CatchallClause Symbol">))</a>
       <a id="7065" class="Symbol">=</a> <a id="7067" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3454" class="InductiveConstructor">stateEF</a> <a id="7075" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6979" class="Bound">currentLedger</a> <a id="7089" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6993" class="Bound">executionStack</a> <a id="7104" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7008" class="Bound">callAddr</a> <a id="7113" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7017" class="Bound">currentAddr</a> <a id="7125" class="Symbol">(</a><a id="7126" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7051" class="Bound">cont</a> <a id="7131" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7008" class="Bound">callAddr</a><a id="7139" class="Symbol">)</a>
<a id="7141" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6343" class="CatchallClause Function">stepEF</a><a id="7147" class="CatchallClause"> </a><a id="7148" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7148" class="CatchallClause Bound">oldLedger</a><a id="7157" class="CatchallClause"> </a><a id="7158" class="CatchallClause Symbol">(</a><a id="7159" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3454" class="CatchallClause InductiveConstructor">stateEF</a><a id="7166" class="CatchallClause"> </a><a id="7167" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7167" class="CatchallClause Bound">currentLedger</a><a id="7180" class="CatchallClause"> </a><a id="7181" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7181" class="CatchallClause Bound">executionStack</a><a id="7195" class="CatchallClause"> </a><a id="7196" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7196" class="CatchallClause Bound">callAddr</a><a id="7204" class="CatchallClause"> </a><a id="7205" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7205" class="CatchallClause Bound">currentAddr</a>
                            <a id="7245" class="CatchallClause Symbol">(</a><a id="7246" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1391" class="CatchallClause InductiveConstructor">exec</a><a id="7250" class="CatchallClause"> </a><a id="7251" class="CatchallClause Symbol">(</a><a id="7252" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#659" class="CatchallClause InductiveConstructor">updatec</a><a id="7259" class="CatchallClause"> </a><a id="7260" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7260" class="CatchallClause Bound">changedFname</a><a id="7272" class="CatchallClause"> </a><a id="7273" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7273" class="CatchallClause Bound">changedFdef</a><a id="7284" class="CatchallClause Symbol">)</a><a id="7285" class="CatchallClause"> </a><a id="7286" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7286" class="CatchallClause Bound">cont</a><a id="7290" class="CatchallClause Symbol">))</a>
       <a id="7300" class="Symbol">=</a> <a id="7302" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3454" class="InductiveConstructor">stateEF</a> <a id="7310" class="Symbol">(</a><a id="7311" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3690" class="Function">updateLedger</a> <a id="7324" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7167" class="Bound">currentLedger</a> <a id="7338" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7205" class="Bound">currentAddr</a> <a id="7350" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7260" class="Bound">changedFname</a> <a id="7363" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7273" class="Bound">changedFdef</a><a id="7374" class="Symbol">)</a>
                   <a id="7395" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7181" class="Bound">executionStack</a> <a id="7410" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7196" class="Bound">callAddr</a> <a id="7419" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7205" class="Bound">currentAddr</a> <a id="7431" class="Symbol">(</a><a id="7432" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7286" class="Bound">cont</a> <a id="7437" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a><a id="7439" class="Symbol">)</a>
<a id="7441" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6343" class="CatchallClause Function">stepEF</a><a id="7447" class="CatchallClause"> </a><a id="7448" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7448" class="CatchallClause Bound">oldLedger</a><a id="7457" class="CatchallClause"> </a><a id="7458" class="CatchallClause Symbol">(</a><a id="7459" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3454" class="CatchallClause InductiveConstructor">stateEF</a><a id="7466" class="CatchallClause"> </a><a id="7467" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7467" class="CatchallClause Bound">currentLedger</a><a id="7480" class="CatchallClause"> </a><a id="7481" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7481" class="CatchallClause Bound">executionStack</a><a id="7495" class="CatchallClause"> </a><a id="7496" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7496" class="CatchallClause Bound">oldCalladdr</a><a id="7507" class="CatchallClause"> </a><a id="7508" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7508" class="CatchallClause Bound">oldCurrentAddr</a><a id="7522" class="CatchallClause"> </a><a id="7523" class="CatchallClause Symbol">(</a><a id="7524" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1391" class="CatchallClause InductiveConstructor">exec</a><a id="7528" class="CatchallClause"> </a><a id="7529" class="CatchallClause Symbol">(</a><a id="7530" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#600" class="CatchallClause InductiveConstructor">callc</a><a id="7535" class="CatchallClause"> </a><a id="7536" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7536" class="CatchallClause Bound">newaddr</a><a id="7543" class="CatchallClause"> </a><a id="7544" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7544" class="CatchallClause Bound">fname</a><a id="7549" class="CatchallClause"> </a><a id="7550" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7550" class="CatchallClause Bound">msg</a><a id="7553" class="CatchallClause Symbol">)</a><a id="7554" class="CatchallClause"> </a><a id="7555" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7555" class="CatchallClause Bound">cont</a><a id="7559" class="CatchallClause Symbol">))</a>
       <a id="7569" class="Symbol">=</a> <a id="7571" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3454" class="InductiveConstructor">stateEF</a> <a id="7579" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7467" class="Bound">currentLedger</a> <a id="7593" class="Symbol">(</a><a id="7594" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2737" class="InductiveConstructor">execStackEl</a> <a id="7606" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7496" class="Bound">oldCalladdr</a> <a id="7618" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7508" class="Bound">oldCurrentAddr</a> <a id="7633" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7555" class="Bound">cont</a>  <a id="7639" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="7641" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7481" class="Bound">executionStack</a><a id="7655" class="Symbol">)</a>  <a id="7658" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7508" class="Bound">oldCurrentAddr</a> <a id="7673" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7536" class="Bound">newaddr</a>
                   <a id="7700" class="Symbol">(</a><a id="7701" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7467" class="Bound">currentLedger</a> <a id="7715" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7536" class="Bound">newaddr</a> <a id="7723" class="Symbol">.</a><a id="7724" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1933" class="Field">fun</a> <a id="7728" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7544" class="Bound">fname</a> <a id="7734" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7550" class="Bound">msg</a><a id="7737" class="Symbol">)</a>

<a id="7740" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6343" class="CatchallClause Function">stepEF</a><a id="7746" class="CatchallClause"> </a><a id="7747" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7747" class="CatchallClause Bound">oldLedger</a><a id="7756" class="CatchallClause"> </a><a id="7757" class="CatchallClause Symbol">(</a><a id="7758" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3454" class="CatchallClause InductiveConstructor">stateEF</a><a id="7765" class="CatchallClause"> </a><a id="7766" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7766" class="CatchallClause Bound">currentLedger</a><a id="7779" class="CatchallClause"> </a><a id="7780" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7780" class="CatchallClause Bound">executionStack</a><a id="7794" class="CatchallClause"> </a><a id="7795" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7795" class="CatchallClause Bound">callAddr</a><a id="7803" class="CatchallClause"> </a><a id="7804" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7804" class="CatchallClause Bound">currentAddr</a><a id="7815" class="CatchallClause"> </a><a id="7816" class="CatchallClause Symbol">(</a><a id="7817" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1391" class="CatchallClause InductiveConstructor">exec</a><a id="7821" class="CatchallClause"> </a><a id="7822" class="CatchallClause Symbol">(</a><a id="7823" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#553" class="CatchallClause InductiveConstructor">transferc</a><a id="7832" class="CatchallClause"> </a><a id="7833" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7833" class="CatchallClause Bound">amount</a><a id="7839" class="CatchallClause"> </a><a id="7840" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7840" class="CatchallClause Bound">destinationAddr</a><a id="7855" class="CatchallClause"> </a><a id="7856" class="CatchallClause Symbol">)</a><a id="7857" class="CatchallClause"> </a><a id="7858" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7858" class="CatchallClause Bound">cont</a><a id="7862" class="CatchallClause Symbol">))</a>
       <a id="7872" class="Symbol">=</a> <a id="7874" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#5696" class="Function">executeTransfer</a> <a id="7890" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7747" class="Bound">oldLedger</a> <a id="7900" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7766" class="Bound">currentLedger</a> <a id="7914" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7780" class="Bound">executionStack</a> <a id="7929" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7795" class="Bound">callAddr</a> <a id="7938" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7804" class="Bound">currentAddr</a> <a id="7950" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7833" class="Bound">amount</a> <a id="7957" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7840" class="Bound">destinationAddr</a> <a id="7973" class="Symbol">(</a><a id="7974" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7858" class="Bound">cont</a> <a id="7979" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a><a id="7981" class="Symbol">)</a>
<a id="7983" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6343" class="CatchallClause Function">stepEF</a><a id="7989" class="CatchallClause"> </a><a id="7990" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#7990" class="CatchallClause Bound">oldLedger</a><a id="7999" class="CatchallClause"> </a><a id="8000" class="CatchallClause Symbol">(</a><a id="8001" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3454" class="CatchallClause InductiveConstructor">stateEF</a><a id="8008" class="CatchallClause"> </a><a id="8009" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8009" class="CatchallClause Bound">currentLedger</a><a id="8022" class="CatchallClause"> </a><a id="8023" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8023" class="CatchallClause Bound">executionStack</a><a id="8037" class="CatchallClause"> </a><a id="8038" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8038" class="CatchallClause Bound">callAddr</a><a id="8046" class="CatchallClause"> </a><a id="8047" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8047" class="CatchallClause Bound">currentAddr</a><a id="8058" class="CatchallClause"> </a><a id="8059" class="CatchallClause Symbol">(</a><a id="8060" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1391" class="CatchallClause InductiveConstructor">exec</a><a id="8064" class="CatchallClause"> </a><a id="8065" class="CatchallClause Symbol">(</a><a id="8066" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#802" class="CatchallClause InductiveConstructor">getAmountc</a><a id="8076" class="CatchallClause">  </a><a id="8078" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8078" class="CatchallClause Bound">addrLookedUp</a><a id="8090" class="CatchallClause Symbol">)</a><a id="8091" class="CatchallClause"> </a><a id="8092" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8092" class="CatchallClause Bound">cont</a><a id="8096" class="CatchallClause Symbol">))</a>
       <a id="8106" class="Symbol">=</a> <a id="8108" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3454" class="InductiveConstructor">stateEF</a> <a id="8116" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8009" class="Bound">currentLedger</a> <a id="8130" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8023" class="Bound">executionStack</a> <a id="8145" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8038" class="Bound">callAddr</a> <a id="8154" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8047" class="Bound">currentAddr</a> <a id="8166" class="Symbol">(</a><a id="8167" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8092" class="Bound">cont</a> <a id="8172" class="Symbol">(</a><a id="8173" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8009" class="Bound">currentLedger</a> <a id="8187" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8078" class="Bound">addrLookedUp</a> <a id="8200" class="Symbol">.</a><a id="8201" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1911" class="Field">amount</a><a id="8207" class="Symbol">))</a>
<a id="8210" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6343" class="CatchallClause Function">stepEF</a><a id="8216" class="CatchallClause"> </a><a id="8217" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8217" class="CatchallClause Bound">oldLedger</a><a id="8226" class="CatchallClause"> </a><a id="8227" class="CatchallClause Symbol">(</a><a id="8228" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3454" class="CatchallClause InductiveConstructor">stateEF</a><a id="8235" class="CatchallClause"> </a><a id="8236" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8236" class="CatchallClause Bound">currentLedger</a><a id="8249" class="CatchallClause"> </a><a id="8250" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8250" class="CatchallClause Bound">executionStack</a><a id="8264" class="CatchallClause"> </a><a id="8265" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8265" class="CatchallClause Bound">callAddr</a><a id="8273" class="CatchallClause"> </a><a id="8274" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8274" class="CatchallClause Bound">currentAddr</a><a id="8285" class="CatchallClause"> </a><a id="8286" class="CatchallClause Symbol">(</a><a id="8287" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1349" class="CatchallClause InductiveConstructor">error</a><a id="8292" class="CatchallClause"> </a><a id="8293" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8293" class="CatchallClause Bound">errorMsg</a><a id="8301" class="CatchallClause Symbol">))</a>
       <a id="8311" class="Symbol">=</a> <a id="8313" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3454" class="InductiveConstructor">stateEF</a> <a id="8321" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8217" class="Bound">oldLedger</a> <a id="8331" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8250" class="Bound">executionStack</a> <a id="8346" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8265" class="Bound">callAddr</a> <a id="8355" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8274" class="Bound">currentAddr</a> <a id="8367" class="Symbol">(</a><a id="8368" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1349" class="InductiveConstructor">error</a> <a id="8374" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8293" class="Bound">errorMsg</a><a id="8382" class="Symbol">)</a>


<a id="8386" class="Comment">-- definition of stepEFntimes</a>
<a id="stepEFntimes"></a><a id="8416" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8416" class="Function">stepEFntimes</a> <a id="8429" class="Symbol">:</a> <a id="8431" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2019" class="Function">Ledger</a> <a id="8438" class="Symbol">→</a> <a id="8440" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3415" class="Record">StateExecFun</a> <a id="8453" class="Symbol">→</a> <a id="8455" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="8457" class="Symbol">→</a> <a id="8459" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3415" class="Record">StateExecFun</a>
<a id="8472" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8416" class="Function">stepEFntimes</a> <a id="8485" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8485" class="Bound">oldLedger</a> <a id="8495" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8495" class="Bound">ledgerstateexecfun</a> <a id="8514" class="Number">0</a>
             <a id="8529" class="Symbol">=</a> <a id="8531" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8495" class="Bound">ledgerstateexecfun</a>
<a id="8550" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8416" class="Function">stepEFntimes</a> <a id="8563" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8563" class="Bound">oldLedger</a> <a id="8573" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8573" class="Bound">ledgerstateexecfun</a> <a id="8592" class="Symbol">(</a><a id="8593" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="8597" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8597" class="Bound">n</a><a id="8598" class="Symbol">)</a>
      <a id="8606" class="Symbol">=</a> <a id="8608" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6343" class="Function">stepEF</a> <a id="8615" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8563" class="Bound">oldLedger</a> <a id="8625" class="Symbol">(</a><a id="8626" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8416" class="Function">stepEFntimes</a> <a id="8639" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8563" class="Bound">oldLedger</a> <a id="8649" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8573" class="Bound">ledgerstateexecfun</a> <a id="8668" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8597" class="Bound">n</a><a id="8669" class="Symbol">)</a>


<a id="8673" class="Comment">--define stepledgern times</a>
<a id="stepLedgerFunntimes"></a><a id="8700" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8700" class="Function">stepLedgerFunntimes</a> <a id="8720" class="Symbol">:</a> <a id="8722" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2019" class="Function">Ledger</a> <a id="8729" class="Symbol">→</a> <a id="8731" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>
                    <a id="8759" class="Symbol">→</a> <a id="8761" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a> <a id="8769" class="Symbol">→</a> <a id="8771" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#254" class="Function">FunctionName</a>
                    <a id="8804" class="Symbol">→</a> <a id="8806" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a> <a id="8810" class="Symbol">→</a> <a id="8812" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="8814" class="Symbol">→</a> <a id="8816" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3415" class="Record">StateExecFun</a>
<a id="8829" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8700" class="Function">stepLedgerFunntimes</a> <a id="8849" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8849" class="Bound">ledger</a> <a id="8856" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8856" class="Bound">callAddr</a> <a id="8865" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8865" class="Bound">currentAddr</a> <a id="8877" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8877" class="Bound">funname</a> <a id="8885" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8885" class="Bound">msg</a> <a id="8889" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8889" class="Bound">n</a>
        <a id="8899" class="Symbol">=</a> <a id="8901" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8416" class="Function">stepEFntimes</a> <a id="8914" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8849" class="Bound">ledger</a> <a id="8921" class="Symbol">(</a><a id="8922" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3454" class="InductiveConstructor">stateEF</a> <a id="8930" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8849" class="Bound">ledger</a> <a id="8937" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="8940" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8856" class="Bound">callAddr</a> <a id="8949" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8865" class="Bound">currentAddr</a>
        <a id="8969" class="Symbol">(</a><a id="8970" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8849" class="Bound">ledger</a> <a id="8977" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8865" class="Bound">currentAddr</a> <a id="8989" class="Symbol">.</a><a id="8990" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1933" class="Field">fun</a> <a id="8994" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8877" class="Bound">funname</a> <a id="9002" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8885" class="Bound">msg</a><a id="9005" class="Symbol">))</a> <a id="9008" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8889" class="Bound">n</a>



<a id="stepLedgerFunntimesList"></a><a id="9013" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9013" class="Function">stepLedgerFunntimesList</a> <a id="9037" class="Symbol">:</a> <a id="9039" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2019" class="Function">Ledger</a> <a id="9046" class="Symbol">→</a> <a id="9048" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a>
                          <a id="9082" class="Symbol">→</a>  <a id="9085" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a> <a id="9093" class="Symbol">→</a> <a id="9095" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#254" class="Function">FunctionName</a>
                          <a id="9134" class="Symbol">→</a> <a id="9136" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a> <a id="9140" class="Symbol">→</a> <a id="9142" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="9144" class="Symbol">→</a> <a id="9146" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="9151" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3415" class="Record">StateExecFun</a>
<a id="9164" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9013" class="Function">stepLedgerFunntimesList</a> <a id="9188" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9188" class="Bound">ledger</a> <a id="9195" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9195" class="Bound">callAddr</a> <a id="9204" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9204" class="Bound">currentAddr</a> <a id="9216" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9216" class="Bound">funname</a> <a id="9224" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9224" class="Bound">msg</a> <a id="9228" class="Number">0</a> <a id="9230" class="Symbol">=</a> <a id="9232" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
<a id="9235" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9013" class="Function">stepLedgerFunntimesList</a> <a id="9259" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9259" class="Bound">ledger</a> <a id="9266" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9266" class="Bound">callAddr</a> <a id="9275" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9275" class="Bound">currentAddr</a> <a id="9287" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9287" class="Bound">funname</a> <a id="9295" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9295" class="Bound">msg</a> <a id="9299" class="Symbol">(</a><a id="9300" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="9304" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9304" class="Bound">n</a><a id="9305" class="Symbol">)</a>
        <a id="9315" class="Symbol">=</a> <a id="9317" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#8700" class="Function">stepLedgerFunntimes</a> <a id="9337" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9259" class="Bound">ledger</a> <a id="9344" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9266" class="Bound">callAddr</a> <a id="9353" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9275" class="Bound">currentAddr</a> <a id="9365" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9287" class="Bound">funname</a> <a id="9373" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9295" class="Bound">msg</a> <a id="9377" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9304" class="Bound">n</a> <a id="9379" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a>
          <a id="9391" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9013" class="Function">stepLedgerFunntimesList</a> <a id="9415" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9259" class="Bound">ledger</a> <a id="9422" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9266" class="Bound">callAddr</a> <a id="9431" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9275" class="Bound">currentAddr</a> <a id="9443" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9287" class="Bound">funname</a> <a id="9451" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9295" class="Bound">msg</a> <a id="9455" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9304" class="Bound">n</a>



<a id="9460" class="Keyword">record</a> <a id="MsgAndLedger"></a><a id="9467" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9467" class="Record">MsgAndLedger</a> <a id="9480" class="Symbol">:</a> <a id="9482" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="9486" class="Keyword">where</a>
  <a id="9494" class="Keyword">constructor</a> <a id="msgAndLedger"></a><a id="9506" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9506" class="InductiveConstructor">msgAndLedger</a>
  <a id="9521" class="Keyword">field</a>
    <a id="MsgAndLedger.theLedger"></a><a id="9531" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9531" class="Field">theLedger</a>  <a id="9542" class="Symbol">:</a> <a id="9544" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2019" class="Function">Ledger</a>
    <a id="MsgAndLedger.msgOrError"></a><a id="9555" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9555" class="Field">msgOrError</a> <a id="9566" class="Symbol">:</a> <a id="9568" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#907" class="Datatype">MsgOrError</a>

<a id="9580" class="Keyword">open</a> <a id="9585" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9467" class="Module">MsgAndLedger</a> <a id="9598" class="Keyword">public</a>


<a id="9607" class="Symbol">{-#</a> <a id="9611" class="Keyword">NON_TERMINATING</a> <a id="9627" class="Symbol">#-}</a>
<a id="evaluateNonTerminatingAuxWithLedger"></a><a id="9631" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9631" class="Function">evaluateNonTerminatingAuxWithLedger</a> <a id="9667" class="Symbol">:</a> <a id="9669" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2019" class="Function">Ledger</a> <a id="9676" class="Symbol">→</a> <a id="9678" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3415" class="Record">StateExecFun</a> <a id="9691" class="Symbol">→</a> <a id="9693" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9467" class="Record">MsgAndLedger</a>
<a id="9706" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9631" class="Function">evaluateNonTerminatingAuxWithLedger</a> <a id="9742" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9742" class="Bound">oldledger</a> <a id="9752" class="Symbol">(</a><a id="9753" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3454" class="InductiveConstructor">stateEF</a> <a id="9761" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9761" class="Bound">currentLedger</a> <a id="9775" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="9778" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9778" class="Bound">callAddr</a> <a id="9787" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9787" class="Bound">currentAddr</a> <a id="9799" class="Symbol">(</a><a id="9800" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1314" class="InductiveConstructor">return</a> <a id="9807" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9807" class="Bound">m</a><a id="9808" class="Symbol">))</a> <a id="9811" class="Symbol">=</a> <a id="9813" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9506" class="InductiveConstructor">msgAndLedger</a> <a id="9826" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9761" class="Bound">currentLedger</a> <a id="9840" class="Symbol">(</a><a id="9841" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#931" class="InductiveConstructor">theMsg</a> <a id="9848" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9807" class="Bound">m</a><a id="9849" class="Symbol">)</a> 
<a id="9852" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9631" class="CatchallClause Function">evaluateNonTerminatingAuxWithLedger</a><a id="9887" class="CatchallClause"> </a><a id="9888" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9888" class="CatchallClause Bound">oldledger</a><a id="9897" class="CatchallClause"> </a><a id="9898" class="CatchallClause Symbol">(</a><a id="9899" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3454" class="CatchallClause InductiveConstructor">stateEF</a><a id="9906" class="CatchallClause"> </a><a id="9907" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9907" class="CatchallClause Bound">currentLedger</a><a id="9920" class="CatchallClause"> </a><a id="9921" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9921" class="CatchallClause Bound">s</a><a id="9922" class="CatchallClause"> </a><a id="9923" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9923" class="CatchallClause Bound">callAddr</a><a id="9931" class="CatchallClause"> </a><a id="9932" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9932" class="CatchallClause Bound">currentAddr</a><a id="9943" class="CatchallClause"> </a><a id="9944" class="CatchallClause Symbol">(</a><a id="9945" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1349" class="CatchallClause InductiveConstructor">error</a><a id="9950" class="CatchallClause"> </a><a id="9951" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9951" class="CatchallClause Bound">e</a><a id="9952" class="CatchallClause Symbol">))</a> <a id="9955" class="Symbol">=</a> <a id="9957" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9506" class="InductiveConstructor">msgAndLedger</a> <a id="9970" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9888" class="Bound">oldledger</a> <a id="9980" class="Symbol">(</a><a id="9981" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#959" class="InductiveConstructor">err</a> <a id="9985" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9951" class="Bound">e</a><a id="9986" class="Symbol">)</a> 
<a id="9989" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9631" class="CatchallClause Function">evaluateNonTerminatingAuxWithLedger</a><a id="10024" class="CatchallClause"> </a><a id="10025" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10025" class="CatchallClause Bound">oldledger</a><a id="10034" class="CatchallClause"> </a><a id="10035" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10035" class="CatchallClause Bound">state</a> <a id="10041" class="Symbol">=</a> <a id="10043" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9631" class="Function">evaluateNonTerminatingAuxWithLedger</a> <a id="10079" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10025" class="Bound">oldledger</a> <a id="10089" class="Symbol">(</a><a id="10090" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#6343" class="Function">stepEF</a>  <a id="10098" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10025" class="Bound">oldledger</a> <a id="10108" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10035" class="Bound">state</a><a id="10113" class="Symbol">)</a>

<a id="evaluateNonTerminatingWithLedger"></a><a id="10116" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10116" class="Function">evaluateNonTerminatingWithLedger</a> <a id="10149" class="Symbol">:</a> <a id="10151" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2019" class="Function">Ledger</a> <a id="10158" class="Symbol">→</a> <a id="10160" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a> <a id="10168" class="Symbol">→</a>  <a id="10171" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#682" class="Function">Address</a> <a id="10179" class="Symbol">→</a> <a id="10181" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#254" class="Function">FunctionName</a> <a id="10194" class="Symbol">→</a> <a id="10196" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a> <a id="10200" class="Symbol">→</a> <a id="10202" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9467" class="Record">MsgAndLedger</a>
<a id="10215" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10116" class="Function">evaluateNonTerminatingWithLedger</a> <a id="10248" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10248" class="Bound">ledger</a> <a id="10255" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10255" class="Bound">callAddr</a> <a id="10264" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10264" class="Bound">currentAddr</a>  <a id="10277" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10277" class="Bound">funname</a> <a id="10285" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10285" class="Bound">msg</a>
                                        <a id="10329" class="Symbol">=</a>  <a id="10332" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#9631" class="Function">evaluateNonTerminatingAuxWithLedger</a> <a id="10368" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10248" class="Bound">ledger</a> <a id="10375" class="Symbol">(</a><a id="10376" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#3454" class="InductiveConstructor">stateEF</a> <a id="10384" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10248" class="Bound">ledger</a> <a id="10391" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="10394" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10255" class="Bound">callAddr</a> <a id="10403" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10264" class="Bound">currentAddr</a> <a id="10415" class="Symbol">(</a><a id="10416" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10248" class="Bound">ledger</a> <a id="10423" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10264" class="Bound">currentAddr</a> <a id="10435" class="Symbol">.</a><a id="10436" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1933" class="Field">fun</a> <a id="10440" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10277" class="Bound">funname</a> <a id="10448" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#10285" class="Bound">msg</a><a id="10451" class="Symbol">))</a>


</pre></body></html>