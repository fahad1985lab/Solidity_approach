<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Simple-Model.example.solidityToagdaInsimplemodel-counterexample</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html" class="Module">Simple-Model.example.solidityToagdaInsimplemodel-counterexample</a> <a id="72" class="Keyword">where</a>

<a id="79" class="Keyword">open</a> <a id="84" class="Keyword">import</a> <a id="91" href="Data.Nat.html" class="Module">Data.Nat</a>  <a id="101" class="Keyword">hiding</a> <a id="108" class="Symbol">(</a><a id="109" href="Data.Nat.Base.html#1801" class="Function Operator">_&lt;_</a><a id="112" class="Symbol">)</a>
<a id="114" class="Keyword">open</a> <a id="119" class="Keyword">import</a> <a id="126" href="Data.List.html" class="Module">Data.List</a>
<a id="136" class="Keyword">open</a> <a id="141" class="Keyword">import</a> <a id="148" href="Data.Bool.html" class="Module">Data.Bool</a> <a id="158" class="Keyword">hiding</a> <a id="165" class="Symbol">(</a><a id="166" href="Data.Bool.Base.html#760" class="Datatype Operator">_&lt;_</a><a id="169" class="Symbol">)</a> <a id="171" class="Comment">--hiding (_&lt;_)</a>
<a id="186" class="Keyword">open</a> <a id="191" class="Keyword">import</a> <a id="198" href="Data.Bool.Base.html" class="Module">Data.Bool.Base</a>   <a id="215" class="Keyword">hiding</a> <a id="222" class="Symbol">(</a><a id="223" href="Data.Bool.Base.html#760" class="Datatype Operator">_&lt;_</a><a id="226" class="Symbol">)</a>
<a id="228" class="Keyword">open</a> <a id="233" class="Keyword">import</a> <a id="240" href="Data.Nat.Base.html" class="Module">Data.Nat.Base</a> <a id="254" class="Keyword">hiding</a> <a id="261" class="Symbol">(</a><a id="262" href="Data.Nat.Base.html#1801" class="Function Operator">_&lt;_</a><a id="265" class="Symbol">)</a>
<a id="267" class="Keyword">open</a> <a id="272" class="Keyword">import</a> <a id="279" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="290" class="Keyword">hiding</a> <a id="297" class="Symbol">(</a><a id="298" href="Data.Maybe.Base.html#2256" class="Function Operator">_&gt;&gt;=_</a><a id="303" class="Symbol">)</a>
<a id="305" class="Keyword">open</a> <a id="310" class="Keyword">import</a> <a id="317" href="Data.String.html" class="Module">Data.String</a> <a id="329" class="Keyword">hiding</a> <a id="336" class="Symbol">(</a><a id="337" href="Data.String.Base.html#2468" class="Function">length</a><a id="343" class="Symbol">;</a> <a id="345" href="Data.String.Base.html#1605" class="Primitive">show</a><a id="349" class="Symbol">;</a> <a id="351" href="Data.String.Base.html#1849" class="Function Operator">_&lt;_</a><a id="354" class="Symbol">)</a>
<a id="356" class="Keyword">open</a> <a id="361" class="Keyword">import</a> <a id="368" href="Data.Nat.Show.html" class="Module">Data.Nat.Show</a>

<a id="383" class="Comment">--simple model</a>
<a id="398" class="Keyword">open</a> <a id="403" class="Keyword">import</a> <a id="410" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html" class="Module">Simple-Model.ledgerversion.Ledger-Simple-Model</a>
<a id="457" class="Keyword">open</a> <a id="462" class="Keyword">import</a> <a id="469" href="Simple-Model.IOledger.IOledger-counter.html" class="Module">Simple-Model.IOledger.IOledger-counter</a>
<a id="508" class="Keyword">open</a> <a id="513" class="Keyword">import</a> <a id="520" href="interface.ConsoleLib.html" class="Module">interface.ConsoleLib</a>
<a id="541" class="Comment">--library</a>
<a id="551" class="Keyword">open</a> <a id="556" class="Keyword">import</a> <a id="563" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html" class="Module">Simple-Model.library-simple-model.basicDataStructureWithSimpleModel</a>



<a id="634" class="Comment">--compare</a>
<a id="_&lt;_"></a><a id="644" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#644" class="Function Operator">_&lt;_</a> <a id="648" class="Symbol">:</a> <a id="650" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="652" class="Symbol">→</a> <a id="654" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="656" class="Symbol">→</a> <a id="658" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a>
<a id="663" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a> <a id="668" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#644" class="Function Operator">&lt;</a> <a id="670" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#670" class="Bound">m</a> <a id="672" class="Symbol">=</a> <a id="674" href="Agda.Builtin.Bool.html#198" class="InductiveConstructor">true</a>
<a id="679" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="683" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#683" class="Bound">n</a> <a id="685" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#644" class="Function Operator">&lt;</a> <a id="687" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a> <a id="692" class="Symbol">=</a> <a id="694" href="Agda.Builtin.Bool.html#192" class="InductiveConstructor">false</a>
<a id="700" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="704" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#704" class="Bound">n</a> <a id="706" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#644" class="Function Operator">&lt;</a> <a id="708" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="712" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#712" class="Bound">m</a> <a id="714" class="Symbol">=</a> <a id="716" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#704" class="Bound">n</a> <a id="718" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#644" class="Function Operator">&lt;</a> <a id="720" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#712" class="Bound">m</a>

<a id="723" class="Comment">--Example of a simple counter</a>

<a id="754" class="Comment">-- constant variable</a>
<a id="const"></a><a id="775" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#775" class="Function">const</a> <a id="781" class="Symbol">:</a> <a id="783" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="785" class="Symbol">→</a> <a id="787" class="Symbol">(</a><a id="788" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a> <a id="792" class="Symbol">→</a> <a id="794" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1274" class="Datatype">SmartContract</a> <a id="808" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#401" class="Datatype">Msg</a><a id="811" class="Symbol">)</a>
<a id="813" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#775" class="Function">const</a> <a id="819" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#819" class="Bound">n</a> <a id="821" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#821" class="Bound">msg</a> <a id="825" class="Symbol">=</a> <a id="827" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1314" class="InductiveConstructor">return</a> <a id="834" class="Symbol">(</a><a id="835" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#420" class="InductiveConstructor">nat</a> <a id="839" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#819" class="Bound">n</a><a id="840" class="Symbol">)</a>


<a id="844" class="Comment">-- define uint as in Solidity</a>
<a id="Max_Uint"></a><a id="874" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#874" class="Function Operator">Max_Uint</a> <a id="883" class="Symbol">:</a> <a id="885" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="887" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#874" class="Function Operator">Max_Uint</a> <a id="896" class="Symbol">=</a> <a id="898" class="Number">65535</a> 


<a id="907" class="Comment">-- test our ledger with our example</a>
<a id="testLedger"></a><a id="943" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#943" class="Function">testLedger</a> <a id="954" class="Symbol">:</a> <a id="956" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#2019" class="Function">Ledger</a>
<a id="963" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#943" class="Function">testLedger</a> <a id="974" class="Number">1</a> <a id="976" class="Symbol">.</a><a id="977" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1911" class="Field">amount</a>             <a id="996" class="Symbol">=</a> <a id="998" class="Number">40</a>
<a id="1001" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#943" class="Function">testLedger</a> <a id="1012" class="Number">1</a> <a id="1014" class="Symbol">.</a><a id="1015" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1933" class="Field">fun</a> <a id="1019" class="String">&quot;counter&quot;</a> <a id="1029" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#1029" class="Bound">m</a>    <a id="1034" class="Symbol">=</a> <a id="1036" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#775" class="Function">const</a> <a id="1042" class="Number">0</a> <a id="1044" class="Symbol">(</a><a id="1045" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#420" class="InductiveConstructor">nat</a> <a id="1049" class="Number">0</a><a id="1050" class="Symbol">)</a>
<a id="1052" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#943" class="Function">testLedger</a> <a id="1063" class="Number">1</a> <a id="1065" class="Symbol">.</a><a id="1066" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1933" class="Field">fun</a> <a id="1070" class="String">&quot;increment&quot;</a> <a id="1082" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#1082" class="Bound">m</a>  <a id="1085" class="Symbol">=</a>
                 <a id="1104" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1391" class="InductiveConstructor">exec</a> <a id="1109" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#730" class="InductiveConstructor">currentAddrLookupc</a>  <a id="1129" class="Symbol">λ</a> <a id="1131" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#1131" class="Bound">addr</a> <a id="1136" class="Symbol">→</a>
                 <a id="1155" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1391" class="InductiveConstructor">exec</a> <a id="1160" class="Symbol">(</a><a id="1161" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#600" class="InductiveConstructor">callc</a> <a id="1167" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#1131" class="Bound">addr</a> <a id="1172" class="String">&quot;counter&quot;</a> <a id="1182" class="Symbol">(</a><a id="1183" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#420" class="InductiveConstructor">nat</a> <a id="1187" class="Number">0</a><a id="1188" class="Symbol">))</a>
                 <a id="1208" class="Symbol">λ{(</a><a id="1211" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#420" class="InductiveConstructor">nat</a> <a id="1215" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#1215" class="Bound">oldcounter</a><a id="1225" class="Symbol">)</a> <a id="1227" class="Symbol">→</a>
                  <a id="1247" class="Symbol">(</a><a id="1248" href="Data.Bool.Base.html#1505" class="Function Operator">if</a> <a id="1251" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#1215" class="Bound">oldcounter</a> <a id="1262" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#644" class="Function Operator">&lt;</a> <a id="1264" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#874" class="Function Operator">Max_Uint</a>
                   <a id="1292" href="Data.Bool.Base.html#1505" class="Function Operator">then</a> <a id="1297" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1391" class="InductiveConstructor">exec</a> <a id="1302" class="Symbol">(</a><a id="1303" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#659" class="InductiveConstructor">updatec</a> <a id="1311" class="String">&quot;counter&quot;</a> <a id="1321" class="Symbol">(</a><a id="1322" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#775" class="Function">const</a> <a id="1328" class="Symbol">(</a><a id="1329" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="1333" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#1215" class="Bound">oldcounter</a><a id="1343" class="Symbol">)))</a>
                <a id="1363" class="Symbol">(λ</a> <a id="1366" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#1366" class="Bound">_</a> <a id="1368" class="Symbol">→</a> <a id="1370" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1314" class="InductiveConstructor">return</a> <a id="1377" class="Symbol">(</a><a id="1378" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#420" class="InductiveConstructor">nat</a> <a id="1382" class="Symbol">(</a><a id="1383" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="1387" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#1215" class="Bound">oldcounter</a><a id="1397" class="Symbol">)))</a>
                   <a id="1420" href="Data.Bool.Base.html#1505" class="Function Operator">else</a>
                  <a id="1443" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1349" class="InductiveConstructor">error</a> <a id="1449" class="Symbol">(</a><a id="1450" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#595" class="InductiveConstructor">strErr</a> <a id="1457" class="String">&quot;out of range error&quot;</a><a id="1477" class="Symbol">));</a>
                <a id="1497" class="CatchallClause Symbol">_</a> <a id="1499" class="Symbol">→</a> <a id="1501" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1349" class="InductiveConstructor">error</a> <a id="1507" class="Symbol">(</a><a id="1508" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#595" class="InductiveConstructor">strErr</a> <a id="1515" class="String">&quot;counter returns not a number&quot;</a><a id="1545" class="Symbol">)}</a>
  
<a id="1551" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#943" class="CatchallClause Function">testLedger</a><a id="1561" class="CatchallClause"> </a><a id="1562" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#1562" class="CatchallClause Bound">ow</a><a id="1564" class="CatchallClause"> </a><a id="1565" class="CatchallClause Symbol">.</a><a id="1566" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1911" class="CatchallClause Field">amount</a>       <a id="1579" class="Symbol">=</a> <a id="1581" class="Number">0</a>
<a id="1583" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#943" class="CatchallClause Function">testLedger</a><a id="1593" class="CatchallClause"> </a><a id="1594" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#1594" class="CatchallClause Bound">ow</a><a id="1596" class="CatchallClause"> </a><a id="1597" class="CatchallClause Symbol">.</a><a id="1598" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1933" class="CatchallClause Field">fun</a><a id="1601" class="CatchallClause"> </a><a id="1602" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#1602" class="CatchallClause Bound">ow&#39;</a><a id="1605" class="CatchallClause"> </a><a id="1606" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#1606" class="CatchallClause Bound">ow&#39;&#39;</a>
  <a id="1613" class="Symbol">=</a> <a id="1615" href="Simple-Model.ledgerversion.Ledger-Simple-Model.html#1349" class="InductiveConstructor">error</a> <a id="1621" class="Symbol">(</a><a id="1622" href="Simple-Model.library-simple-model.basicDataStructureWithSimpleModel.html#595" class="InductiveConstructor">strErr</a> <a id="1629" class="String">&quot;Undefined&quot;</a><a id="1640" class="Symbol">)</a>


<a id="1644" class="Comment">-- To run interface</a>
<a id="main1"></a><a id="1664" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#1664" class="Function">main1</a>  <a id="1671" class="Symbol">:</a>  <a id="1674" href="interface.ConsoleLib.html#904" class="Function">ConsoleProg</a>
<a id="1686" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#1664" class="Function">main1</a>  <a id="1693" class="Symbol">=</a>  <a id="1696" href="interface.ConsoleLib.html#224" class="Function">run</a>  <a id="1701" class="Symbol">(</a><a id="1702" href="Simple-Model.IOledger.IOledger-counter.html#5346" class="Function">mainBody</a> <a id="1711" href="Simple-Model.example.solidityToagdaInsimplemodel-counterexample.html#943" class="Function">testLedger</a> <a id="1722" class="Number">0</a><a id="1723" class="Symbol">)</a>
</pre></body></html>